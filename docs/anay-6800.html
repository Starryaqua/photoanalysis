<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 10 章 LI-6800 的数据分析 | 使用 R 语言分析 LI-6400 和 LI-6800 光合仪的数据</title>
  <meta name="description" content="使用 R 语言分析 LI-6400XT 与 LI-6800 数据" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="第 10 章 LI-6800 的数据分析 | 使用 R 语言分析 LI-6400 和 LI-6800 光合仪的数据" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/coverpage.png" />
  <meta property="og:description" content="使用 R 语言分析 LI-6400XT 与 LI-6800 数据" />
  <meta name="github-repo" content="zhujiedong/photoanalysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 10 章 LI-6800 的数据分析 | 使用 R 语言分析 LI-6400 和 LI-6800 光合仪的数据" />
  
  <meta name="twitter:description" content="使用 R 语言分析 LI-6400XT 与 LI-6800 数据" />
  <meta name="twitter:image" content="images/coverpage.png" />

<meta name="author" content="祝介东    北京力高泰科技有限公司" />


<meta name="date" content="2020-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="start-con.html"/>
<link rel="next" href="pca-anylysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R 软件与光合数据分析</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>欢迎</a></li>
<li class="chapter" data-level="" data-path="frontmatter.html"><a href="frontmatter.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>关于作者</a></li>
<li class="chapter" data-level="" data-path="copyright.html"><a href="copyright.html"><i class="fa fa-check"></i>版权</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R 软件与 Rstudio</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#rsoft"><i class="fa fa-check"></i><b>1.1</b> R 软件</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#rstudiosoft"><i class="fa fa-check"></i><b>1.2</b> Rstudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="batch-question.html"><a href="batch-question.html"><i class="fa fa-check"></i><b>2</b> 批量处理光合测定数据</a><ul>
<li class="chapter" data-level="2.1" data-path="batch-question.html"><a href="batch-question.html#install_readphoto"><i class="fa fa-check"></i><b>2.1</b> 安装</a></li>
<li class="chapter" data-level="2.2" data-path="batch-question.html"><a href="batch-question.html#batch64"><i class="fa fa-check"></i><b>2.2</b> 6400 数据整合</a></li>
<li class="chapter" data-level="2.3" data-path="batch-question.html"><a href="batch-question.html#batch68"><i class="fa fa-check"></i><b>2.3</b> LI-6800 数据整合</a></li>
<li class="chapter" data-level="2.4" data-path="batch-question.html"><a href="batch-question.html#recompute_raw"><i class="fa fa-check"></i><b>2.4</b> 重计算功能</a><ul>
<li class="chapter" data-level="2.4.1" data-path="batch-question.html"><a href="batch-question.html#recompute6400"><i class="fa fa-check"></i><b>2.4.1</b> LI-6400 数据重计算</a></li>
<li class="chapter" data-level="2.4.2" data-path="batch-question.html"><a href="batch-question.html#recompute6800"><i class="fa fa-check"></i><b>2.4.2</b> LI-6800 数据重计算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="response-fit.html"><a href="response-fit.html"><i class="fa fa-check"></i><b>3</b> CO<sub>2</sub> 响应曲线的拟合</a><ul>
<li class="chapter" data-level="3.1" data-path="response-fit.html"><a href="response-fit.html#fvcb_mod"><i class="fa fa-check"></i><b>3.1</b> FvCB 模型</a></li>
<li class="chapter" data-level="3.2" data-path="response-fit.html"><a href="response-fit.html#co2_note"><i class="fa fa-check"></i><b>3.2</b> CO<sub>2</sub> 响应曲线测量的注意事项</a><ul>
<li class="chapter" data-level="3.2.1" data-path="response-fit.html"><a href="response-fit.html#model_3"><i class="fa fa-check"></i><b>3.2.1</b> 分段性</a></li>
<li class="chapter" data-level="3.2.2" data-path="response-fit.html"><a href="response-fit.html#note_detail"><i class="fa fa-check"></i><b>3.2.2</b> 测量注意事项</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="response-fit.html"><a href="response-fit.html#plantecophys"><i class="fa fa-check"></i><b>3.3</b> <code>plantecophys</code> 软件包</a></li>
<li class="chapter" data-level="3.4" data-path="response-fit.html"><a href="response-fit.html#fit6400"><i class="fa fa-check"></i><b>3.4</b> LI-6400XT CO<sub>2</sub> 响应曲线的拟合</a><ul>
<li class="chapter" data-level="3.4.1" data-path="response-fit.html"><a href="response-fit.html#fitaci_intro"><i class="fa fa-check"></i><b>3.4.1</b> fitaci 函数介绍</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="response-fit.html"><a href="response-fit.html#plantecophy_use"><i class="fa fa-check"></i><b>3.5</b> 使用 <code>plantecophys</code> 拟合 LI-6400XT CO<sub>2</sub> 响应曲线数据</a><ul>
<li class="chapter" data-level="3.5.1" data-path="response-fit.html"><a href="response-fit.html#data6400"><i class="fa fa-check"></i><b>3.5.1</b> 数据的前处理</a></li>
<li class="chapter" data-level="3.5.2" data-path="response-fit.html"><a href="response-fit.html#fitaci-p"><i class="fa fa-check"></i><b>3.5.2</b> 使用示例</a></li>
<li class="chapter" data-level="3.5.3" data-path="response-fit.html"><a href="response-fit.html#onpoint_fit"><i class="fa fa-check"></i><b>3.5.3</b> 使用 ‘onepoint’ 单独计算 V<sub>cmax</sub> 和 J<sub>max</sub></a></li>
<li class="chapter" data-level="3.5.4" data-path="response-fit.html"><a href="response-fit.html#multi_curve"><i class="fa fa-check"></i><b>3.5.4</b> 多条 CO<sub>2</sub> 响应曲线的拟合</a></li>
<li class="chapter" data-level="3.5.5" data-path="response-fit.html"><a href="response-fit.html#transition"><i class="fa fa-check"></i><b>3.5.5</b> <code>findCiTransition</code> 函数</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="response-fit.html"><a href="response-fit.html#c4"><i class="fa fa-check"></i><b>3.6</b> C4 植物光合</a><ul>
<li class="chapter" data-level="3.6.1" data-path="response-fit.html"><a href="response-fit.html#c4_sim"><i class="fa fa-check"></i><b>3.6.1</b> C4 植物光合速率的计算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stomotal-sim.html"><a href="stomotal-sim.html"><i class="fa fa-check"></i><b>4</b> 气孔导度模型的拟合</a><ul>
<li class="chapter" data-level="4.1" data-path="stomotal-sim.html"><a href="stomotal-sim.html#ballberry"><i class="fa fa-check"></i><b>4.1</b> BallBerry 模型</a></li>
<li class="chapter" data-level="4.2" data-path="stomotal-sim.html"><a href="stomotal-sim.html#bbleuning"><i class="fa fa-check"></i><b>4.2</b> BBLeuning 模型</a></li>
<li class="chapter" data-level="4.3" data-path="stomotal-sim.html"><a href="stomotal-sim.html#bboptifull"><i class="fa fa-check"></i><b>4.3</b> BBOptiFull 模型</a></li>
<li class="chapter" data-level="4.4" data-path="stomotal-sim.html"><a href="stomotal-sim.html#fitbb-p"><i class="fa fa-check"></i><b>4.4</b> <code>fitBB</code> 函数</a></li>
<li class="chapter" data-level="4.5" data-path="stomotal-sim.html"><a href="stomotal-sim.html#fitbbs"><i class="fa fa-check"></i><b>4.5</b> <code>fitBBs</code> 函数</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stomotal-couple.html"><a href="stomotal-couple.html"><i class="fa fa-check"></i><b>5</b> 光合最优气孔导度耦合模型</a><ul>
<li class="chapter" data-level="5.1" data-path="stomotal-couple.html"><a href="stomotal-couple.html#farao"><i class="fa fa-check"></i><b>5.1</b> <code>FARAO</code> 函数</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="photo-stomo.html"><a href="photo-stomo.html"><i class="fa fa-check"></i><b>6</b> 光合气孔导度耦合模型</a><ul>
<li class="chapter" data-level="6.1" data-path="photo-stomo.html"><a href="photo-stomo.html#photosyn"><i class="fa fa-check"></i><b>6.1</b> <code>Photosyn</code> 函数</a><ul>
<li class="chapter" data-level="6.1.1" data-path="photo-stomo.html"><a href="photo-stomo.html#photo_exam"><i class="fa fa-check"></i><b>6.1.1</b> <code>Photosyn</code> 使用举例</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="photo-stomo.html"><a href="photo-stomo.html#photsyneb"><i class="fa fa-check"></i><b>6.2</b> <code>PhotosynEB</code> 函数</a></li>
<li class="chapter" data-level="6.3" data-path="photo-stomo.html"><a href="photo-stomo.html#photosyntuzet"><i class="fa fa-check"></i><b>6.3</b> <code>PhotosynTuzet</code> 函数</a><ul>
<li class="chapter" data-level="6.3.1" data-path="photo-stomo.html"><a href="photo-stomo.html#photosyntuzet_para"><i class="fa fa-check"></i><b>6.3.1</b> <code>PhotosynTuzet</code> 的参数</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rhtovpd.html"><a href="rhtovpd.html"><i class="fa fa-check"></i><b>7</b> RHtoVPD 函数</a></li>
<li class="chapter" data-level="8" data-path="lrc-fit.html"><a href="lrc-fit.html"><i class="fa fa-check"></i><b>8</b> 光响应曲线的拟合</a><ul>
<li class="chapter" data-level="8.1" data-path="lrc-fit.html"><a href="lrc-fit.html#rec_mod"><i class="fa fa-check"></i><b>8.1</b> 直角双曲线模型</a><ul>
<li class="chapter" data-level="8.1.1" data-path="lrc-fit.html"><a href="lrc-fit.html#rec_fit"><i class="fa fa-check"></i><b>8.1.1</b> 直角双曲线模型的实现</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="lrc-fit.html"><a href="lrc-fit.html#nonrec_mod"><i class="fa fa-check"></i><b>8.2</b> 非直角双曲线模型</a><ul>
<li class="chapter" data-level="8.2.1" data-path="lrc-fit.html"><a href="lrc-fit.html#nonrec_mode_exam"><i class="fa fa-check"></i><b>8.2.1</b> 非直角双曲线模型的实现</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lrc-fit.html"><a href="lrc-fit.html#lrc_exp"><i class="fa fa-check"></i><b>8.3</b> 指数模型</a><ul>
<li class="chapter" data-level="8.3.1" data-path="lrc-fit.html"><a href="lrc-fit.html#lrc_exp_exam"><i class="fa fa-check"></i><b>8.3.1</b> 指数模型的实现</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="lrc-fit.html"><a href="lrc-fit.html#rev_rec"><i class="fa fa-check"></i><b>8.4</b> 直角双曲线的修正模型</a><ul>
<li class="chapter" data-level="8.4.1" data-path="lrc-fit.html"><a href="lrc-fit.html#rev_rec_exam"><i class="fa fa-check"></i><b>8.4.1</b> 直角双曲线修正模型的实现</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="start-con.html"><a href="start-con.html"><i class="fa fa-check"></i><b>9</b> 关于非线性拟合的初始值</a><ul>
<li class="chapter" data-level="9.1" data-path="start-con.html"><a href="start-con.html#nlslm"><i class="fa fa-check"></i><b>9.1</b> nlsLM 解决方案</a></li>
<li class="chapter" data-level="9.2" data-path="start-con.html"><a href="start-con.html#plot_comp"><i class="fa fa-check"></i><b>9.2</b> 作图比对法</a><ul>
<li class="chapter" data-level="9.2.1" data-path="start-con.html"><a href="start-con.html#plot_exam"><i class="fa fa-check"></i><b>9.2.1</b> 实现过程</a></li>
<li class="chapter" data-level="9.2.2" data-path="start-con.html"><a href="start-con.html#show_demo"><i class="fa fa-check"></i><b>9.2.2</b> 直观展示</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="start-con.html"><a href="start-con.html#mult_try"><i class="fa fa-check"></i><b>9.3</b> 自动多次尝试法</a></li>
<li class="chapter" data-level="9.4" data-path="start-con.html"><a href="start-con.html#sum_start"><i class="fa fa-check"></i><b>9.4</b> 小结</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="anay-6800.html"><a href="anay-6800.html"><i class="fa fa-check"></i><b>10</b> LI-6800 的数据分析</a><ul>
<li class="chapter" data-level="10.1" data-path="anay-6800.html"><a href="anay-6800.html#data6800"><i class="fa fa-check"></i><b>10.1</b> 数据格式</a></li>
<li class="chapter" data-level="10.2" data-path="anay-6800.html"><a href="anay-6800.html#dif"><i class="fa fa-check"></i><b>10.2</b> LI-6800 与 LI-6400 使用时的差别</a></li>
<li class="chapter" data-level="10.3" data-path="anay-6800.html"><a href="anay-6800.html#notice"><i class="fa fa-check"></i><b>10.3</b> 光响应曲线注意事项</a></li>
<li class="chapter" data-level="10.4" data-path="anay-6800.html"><a href="anay-6800.html#racir68"><i class="fa fa-check"></i><b>10.4</b> LI-6800 RACiR的测量与拟合</a></li>
<li class="chapter" data-level="10.5" data-path="anay-6800.html"><a href="anay-6800.html#racir_pkg"><i class="fa fa-check"></i><b>10.5</b> racir 软件包实现 RACiR数据分析</a><ul>
<li class="chapter" data-level="10.5.1" data-path="anay-6800.html"><a href="anay-6800.html#racir_pkg_real"><i class="fa fa-check"></i><b>10.5.1</b> 实现过程</a></li>
<li class="chapter" data-level="10.5.2" data-path="anay-6800.html"><a href="anay-6800.html#racirbatch"><i class="fa fa-check"></i><b>10.5.2</b> 数据的批量处理</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="anay-6800.html"><a href="anay-6800.html#fitbatracir"><i class="fa fa-check"></i><b>10.6</b> 批量计算 <span class="math inline">\(V_{cmax}\)</span> 和 <span class="math inline">\(J_max\)</span></a></li>
<li class="chapter" data-level="10.7" data-path="anay-6800.html"><a href="anay-6800.html#racir-conifer"><i class="fa fa-check"></i><b>10.7</b> LI-6800 RACiR簇状叶的测量与拟合</a><ul>
<li class="chapter" data-level="10.7.1" data-path="anay-6800.html"><a href="anay-6800.html#conifer-fit-racir"><i class="fa fa-check"></i><b>10.7.1</b> 数据的拟合</a></li>
<li class="chapter" data-level="10.7.2" data-path="anay-6800.html"><a href="anay-6800.html#conifer-racir-fit"><i class="fa fa-check"></i><b>10.7.2</b> 拟合过程</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="anay-6800.html"><a href="anay-6800.html#racir68_exam"><i class="fa fa-check"></i><b>10.8</b> RACiR分析的手动实现</a></li>
<li class="chapter" data-level="10.9" data-path="anay-6800.html"><a href="anay-6800.html#multi1"><i class="fa fa-check"></i><b>10.9</b> 多个速率的 RACiR 曲线研究</a><ul>
<li class="chapter" data-level="10.9.1" data-path="anay-6800.html"><a href="anay-6800.html#multi2"><i class="fa fa-check"></i><b>10.9.1</b> 光呼吸滞后模型</a></li>
<li class="chapter" data-level="10.9.2" data-path="anay-6800.html"><a href="anay-6800.html#code-photoresp"><i class="fa fa-check"></i><b>10.9.2</b> 光呼吸滞后性代码</a></li>
<li class="chapter" data-level="10.9.3" data-path="anay-6800.html"><a href="anay-6800.html#multi4"><i class="fa fa-check"></i><b>10.9.3</b> 数据的构造</a></li>
<li class="chapter" data-level="10.9.4" data-path="anay-6800.html"><a href="anay-6800.html#multi5"><i class="fa fa-check"></i><b>10.9.4</b> 光呼吸滞后性作图</a></li>
<li class="chapter" data-level="10.9.5" data-path="anay-6800.html"><a href="anay-6800.html#multi6"><i class="fa fa-check"></i><b>10.9.5</b> 补偿点计算</a></li>
<li class="chapter" data-level="10.9.6" data-path="anay-6800.html"><a href="anay-6800.html#multi7"><i class="fa fa-check"></i><b>10.9.6</b> 无光呼吸酶失活模块</a></li>
<li class="chapter" data-level="10.9.7" data-path="anay-6800.html"><a href="anay-6800.html#multi9"><i class="fa fa-check"></i><b>10.9.7</b> 酶失活作图</a></li>
<li class="chapter" data-level="10.9.8" data-path="anay-6800.html"><a href="anay-6800.html#multi10"><i class="fa fa-check"></i><b>10.9.8</b> 不同失活程度下补偿点计算</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="anay-6800.html"><a href="anay-6800.html#multi11"><i class="fa fa-check"></i><b>10.10</b> 时间延迟的扩散限制</a><ul>
<li class="chapter" data-level="10.10.1" data-path="anay-6800.html"><a href="anay-6800.html#multi12"><i class="fa fa-check"></i><b>10.10.1</b> 扩散限制滞后性</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="anay-6800.html"><a href="anay-6800.html#multi13"><i class="fa fa-check"></i><b>10.11</b> 扩散限制作图</a><ul>
<li class="chapter" data-level="10.11.1" data-path="anay-6800.html"><a href="anay-6800.html#multi14"><i class="fa fa-check"></i><b>10.11.1</b> 补偿点的计算</a></li>
<li class="chapter" data-level="10.11.2" data-path="anay-6800.html"><a href="anay-6800.html#multi15"><i class="fa fa-check"></i><b>10.11.2</b> 所有图形代码</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="anay-6800.html"><a href="anay-6800.html#fluro68"><i class="fa fa-check"></i><b>10.12</b> LI-6800 荧光数据分析</a><ul>
<li class="chapter" data-level="10.12.1" data-path="anay-6800.html"><a href="anay-6800.html#jiptest"><i class="fa fa-check"></i><b>10.12.1</b> jip test 的实现</a></li>
<li class="chapter" data-level="10.12.2" data-path="anay-6800.html"><a href="anay-6800.html#jiptest_pack"><i class="fa fa-check"></i><b>10.12.2</b> <code>jiptest</code> 软件包安装</a></li>
<li class="chapter" data-level="10.12.3" data-path="anay-6800.html"><a href="anay-6800.html#readfluor"><i class="fa fa-check"></i><b>10.12.3</b> <code>read_files</code> 及 <code>read_dcfiles</code> 函数</a></li>
<li class="chapter" data-level="10.12.4" data-path="anay-6800.html"><a href="anay-6800.html#testfluor"><i class="fa fa-check"></i><b>10.12.4</b> <code>jip_test</code> 及 <code>jip_dctest</code> 函数</a></li>
<li class="chapter" data-level="10.12.5" data-path="anay-6800.html"><a href="anay-6800.html#plotfluor"><i class="fa fa-check"></i><b>10.12.5</b> <code>jip_plot</code> 及 <code>jip_dcplot</code> 函数</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pca-anylysis.html"><a href="pca-anylysis.html"><i class="fa fa-check"></i><b>11</b> 大话 PCA</a><ul>
<li class="chapter" data-level="11.1" data-path="pca-anylysis.html"><a href="pca-anylysis.html#geom-pca"><i class="fa fa-check"></i><b>11.1</b> 几何解释</a></li>
<li class="chapter" data-level="11.2" data-path="pca-anylysis.html"><a href="pca-anylysis.html#alge-pca"><i class="fa fa-check"></i><b>11.2</b> 线性代数解释</a><ul>
<li class="chapter" data-level="11.2.1" data-path="pca-anylysis.html"><a href="pca-anylysis.html#egi-pca"><i class="fa fa-check"></i><b>11.2.1</b> 特征向量与特征值</a></li>
<li class="chapter" data-level="11.2.2" data-path="pca-anylysis.html"><a href="pca-anylysis.html#man_pca"><i class="fa fa-check"></i><b>11.2.2</b> 手动实现过程</a></li>
<li class="chapter" data-level="11.2.3" data-path="pca-anylysis.html"><a href="pca-anylysis.html#prcom"><i class="fa fa-check"></i><b>11.2.3</b> <code>prcomp</code> 的实现</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i><b>12</b> 环境与配置</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">由 bookdown 驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">使用 R 语言分析 LI-6400 和 LI-6800 光合仪的数据</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anay_6800" class="section level1">
<h1><span class="header-section-number">第 10 章</span> LI-6800 的数据分析</h1>
<div id="data6800" class="section level2">
<h2><span class="header-section-number">10.1</span> 数据格式</h2>
<p>LI-6800 的数据前处理同 LI-6400 相同，如表 <a href="anay-6800.html#tab:head6800">10.1</a> 所示的样式。</p>
<table>
<caption><span id="tab:head6800">表 10.1: </span>推荐 LI-6800 整理后数据样式</caption>
<thead>
<tr class="header">
<th align="right">obs</th>
<th align="right">time</th>
<th align="right">elapsed</th>
<th align="left">date</th>
<th align="right">TIME</th>
<th align="right">E</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1471425750</td>
<td align="right">0.0</td>
<td align="left">20160817 17:22:30</td>
<td align="right">1471425726</td>
<td align="right">0.0007614</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1471425855</td>
<td align="right">104.5</td>
<td align="left">20160817 17:24:14</td>
<td align="right">1471425829</td>
<td align="right">0.0009221</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1471426153</td>
<td align="right">403.1</td>
<td align="left">20160817 17:29:13</td>
<td align="right">1471426144</td>
<td align="right">0.0009900</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1471426244</td>
<td align="right">494.0</td>
<td align="left">20160817 17:30:44</td>
<td align="right">1471426235</td>
<td align="right">0.0010249</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1471426335</td>
<td align="right">585.1</td>
<td align="left">20160817 17:32:15</td>
<td align="right">1471426326</td>
<td align="right">0.0010632</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1471426426</td>
<td align="right">676.0</td>
<td align="left">20160817 17:33:46</td>
<td align="right">1471426417</td>
<td align="right">0.0011190</td>
</tr>
</tbody>
</table>
</div>
<div id="dif" class="section level2">
<h2><span class="header-section-number">10.2</span> LI-6800 与 LI-6400 使用时的差别</h2>
<p><code>plantecophys</code> 使用时建立在 LI-6400XT 基础之上的软件包，因此在 LI-6800 代码中，需要改动的是 fitaci、fitacis 及 fitBB 中的 varnames 选项，也就是将 LI-6400XT 的表头改为 LI-6800 的表头。
以 fitaci 函数为例：</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"> <span class="kw">fitaci</span>(aci, <span class="dt">varnames =</span> </a>
<a class="sourceLine" id="cb146-2" title="2">        <span class="kw">list</span>(<span class="dt">ALEAF =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">Tleaf =</span> <span class="st">&quot;Tleaf&quot;</span>, <span class="dt">Ci =</span> <span class="st">&quot;Ci&quot;</span>, </a>
<a class="sourceLine" id="cb146-3" title="3">          <span class="dt">PPFD  =</span> <span class="st">&quot;Qin&quot;</span>, <span class="dt">Rd =</span> <span class="st">&quot;Rd&quot;</span>))</a></code></pre></div>
</div>
<div id="notice" class="section level2">
<h2><span class="header-section-number">10.3</span> 光响应曲线注意事项</h2>
<p>光响应曲线的拟合相对简单，仅需要光强和光合速率的值，其中需要修改的部分仅为光强的赋值部分，在文件名一致的前提下，修改如下代码即可：</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">lrc_Q &lt;-<span class="st"> </span>lrc<span class="op">$</span>Qin</a>
<a class="sourceLine" id="cb147-2" title="2">lrc_A &lt;-<span class="st"> </span>lrc<span class="op">$</span>A </a></code></pre></div>


</div>
<div id="racir68" class="section level2">
<h2><span class="header-section-number">10.4</span> LI-6800 RACiR的测量与拟合</h2>
<p>在评估作物性状时，V<span class="math inline">\(_{cmax}\)</span> 及 J<span class="math inline">\(_{max}\)</span>时非常有用，传统的 A–Ci 曲线测量要求植物叶片要在一定浓度 CO<span class="math inline">\(_{2}\)</span>
下适应几分钟后完成测量，这样的测量有几个缺点：</p>
<ul>
<li>测量时间长，一条曲线至少需要 20 – 30 min，样本量多，重复多时，这种方法几乎没有可行性。</li>
<li>整个测量过程中，时间长，酶的激活状态会有变化，叶绿体会移动，气孔的开度也会发生变化。</li>
</ul>
<p>而 LI-6800 独有的 auto control 功能在算法上允许用户自定义 CO<span class="math inline">\(_{2}\)</span> 的起始浓度和种植浓度、变化方式（线性或其他）、所花费的时间，再加上其
IRGAs 极快的响应频率，使得短时间内的 A–Ci 的测量成为现实，即快速 CO<span class="math inline">\(_{2}\)</span> 响应曲线 RACiR
测量实验，该功能使得 5 min 内测量 A–Ci 曲线成为可能。该方法的实现可参考 <span class="citation">Stinziano et al. (<a href="#ref-stinziano2017" role="doc-biblioref">2017</a>)</span>
的文章。</p>
<p><span class="citation">Stinziano et al. (<a href="#ref-stinziano2018" role="doc-biblioref">2018</a>)</span> 针对 RACiR技术的疑问做了解答并提出了准确测量的建议，概括如下：</p>
<ul>
<li>首先，采用 100 ppm/min 的变化速率是与标准方法重合度最高的测量。</li>
<li>其次，明确研究问题，目前已有研究表明Vcmax 与 Jmax 的计算结果与标准测量方法结果无显著差异。</li>
<li>任何条件的改变，都需要做空叶室校准，例如：流速，气体浓度变化方向、温度，斜率等。</li>
<li>空叶室校准与叶片测量采用严格的同一次校准，因为 IRGA 的漂移，需要再次匹配时，或者环境条件改变时，需要重新做空叶室校准。是否需要匹配，可通过不加叶片的最初状态查看，此时 A 值应接近为0，reference 和 sample 气体浓度读数接近相等。</li>
<li>IRGA 分析器使用 5 此多项式进行校准，推荐使用 1 次到 5 次多项式进行拟合，然后根据 BIC 指数来确定最合适的空叶室校准系数（即非参数拟合的模型选择的问题）。
确定最合适的浓度变化范围。通常需要去掉最初和最后 30 s的数据。</li>
<li>最小化校准和测量值之间的水分摩尔分数差异。甚至有可能需要控制 reference 或 sample 的水的摩尔分数而不是 Vpdleaf。
通过预实验来确定最合适的 <span class="math inline">\(CO_2\)</span> 变化范围和随时间的斜率。</li>
</ul>
</div>
<div id="racir_pkg" class="section level2">
<h2><span class="header-section-number">10.5</span> racir 软件包实现 RACiR数据分析</h2>
<p><strong>可能软件包作者没有更改叶面积的需求，他的软件包只支持原始数据的处理，但这对有更改需求的客户来讲没那么友好，而且这样导致了大量代码的重复，我根据作者原来的代码，结合我自己数据分析的习惯，重新制作了一份软件包，下面代码实现是基于我的软件包实现的，如有需求，也可使用作者原来的代码实现</strong></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;zhujiedong/racir&quot;</span>)</a>
<a class="sourceLine" id="cb148-2" title="2"><span class="kw">library</span>(racir)</a></code></pre></div>
<p>软件包的函数很多，但可以分为下面几类：</p>
<ul>
<li><p>首先使用 <code>find_cut</code> 来查看使用数据的范围（排除野点）。</p></li>
<li><p>使用 <code>racircheck</code> 来检查校正数据 (非必须，但建议进行数据质量检查)</p></li>
<li><p>使用 <code>racircal</code> 进行数据的校准</p></li>
</ul>
<div id="racir_pkg_real" class="section level3">
<h3><span class="header-section-number">10.5.1</span> 实现过程</h3>
<p>手上暂时没有原始数据格式的 racir 数据，因而现在使用以前的 csv 数据进行操作（空叶室测量数据和带叶片测量数据转为 csv 格式）。</p>
<p>首先检查空叶室校准：</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="kw">library</span>(racir)</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="co"># only check the empty chamber data here</span></a>
<a class="sourceLine" id="cb149-3" title="3">em1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/racirem/em-1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb149-4" title="4">le1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/racirle/le-1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb149-5" title="5"><span class="kw">find_cut</span>(em1)</a></code></pre></div>
<div class="figure"><span id="fig:racircheck"></span>
<img src="bookdown_files/figure-html/racircheck-1.png" alt="找出最合理的校准曲线数据范围" width="672" />
<p class="caption">
图 10.1: 找出最合理的校准曲线数据范围
</p>
</div>
<p>上述代码查看参比室 <span class="math inline">\(CO_2\)</span> 浓度在两者之间的数据，确定后面代码使用的 <code>mincut</code>, <code>maxcut</code> 范围。此处我选择的范围如下问代码：</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="kw">racircheck</span>(em1, <span class="dt">mincut =</span> <span class="dv">21</span> , <span class="dt">maxcut =</span> <span class="dv">463</span> )</a></code></pre></div>
<div class="figure"><span id="fig:racircorpkg"></span>
<img src="bookdown_files/figure-html/racircorpkg-1.png" alt="校准曲线查看" width="672" />
<p class="caption">
图 10.2: 校准曲线查看
</p>
</div>
<p>没有问题可直接进行校准</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">x &lt;-<span class="st"> </span><span class="kw">racircal</span>(em1, le1, <span class="dt">mincut =</span> <span class="dv">21</span>, <span class="dt">maxcut =</span> <span class="dv">463</span>)</a>
<a class="sourceLine" id="cb151-2" title="2"><span class="kw">plot</span>(x<span class="op">$</span>CO2_r, x<span class="op">$</span>A)</a></code></pre></div>
<div class="figure"><span id="fig:racircor"></span>
<img src="bookdown_files/figure-html/racircor-1.png" alt="校准后数据查看" width="672" />
<p class="caption">
图 10.3: 校准后数据查看
</p>
</div>
<p>前两个参数分别为空叶室数据，带叶片测量数据，后面的最大最小值为 <code>racircheck</code> 确定，剩余工作就是使用 <code>plantecophys</code> 进行分析，在此不再重复这个过程。</p>
<p><strong>注意：RACiR 的本意是表型研究中求 Vcmax 和 Jmax，因而，请忽略 Rd 等参数的计算结果</strong></p>
</div>
<div id="racirbatch" class="section level3">
<h3><span class="header-section-number">10.5.2</span> 数据的批量处理</h3>
<div id="imbyphoto" class="section level4">
<h4><span class="header-section-number">10.5.2.1</span> readphoto 导入</h4>
<p>如果数据的导入是使用 <code>readphoto</code> 批量处理，那么所在数据文件有 files 列，作为不同文件数据的区分，那么可以使用向量化处理方式实现数据的分析，参考如下代码：</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">library</span>(readphoto)</a>
<a class="sourceLine" id="cb152-2" title="2"><span class="co"># read all empty data set</span></a>
<a class="sourceLine" id="cb152-3" title="3">all_empty &lt;-<span class="st"> </span><span class="kw">read_bat_6800</span>(<span class="st">&quot;./empty_data&quot;</span>)</a>
<a class="sourceLine" id="cb152-4" title="4"><span class="co"># read all leaf data set</span></a>
<a class="sourceLine" id="cb152-5" title="5">all_leaf &lt;-<span class="st"> </span><span class="kw">read_bat_6800</span>(<span class="st">&quot;./leaf_data&quot;</span>)</a>
<a class="sourceLine" id="cb152-6" title="6">listem  &lt;-<span class="st">  </span><span class="kw">split</span>(all_empty, files)</a>
<a class="sourceLine" id="cb152-7" title="7">listle &lt;-<span class="st">  </span><span class="kw">split</span>(all_leaf, files)</a>
<a class="sourceLine" id="cb152-8" title="8">cordata &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map2</span>(listem, listle, racircal, <span class="dt">mincut =</span> <span class="dv">21</span>, <span class="dt">maxcut =</span> <span class="dv">463</span>)</a></code></pre></div>
<p>所有的数据均保存在 cordata 中，特别注意 <strong>此处要求 listem 与 listle 长度相同，因此，如果一个空叶室对多个带叶片测量数据，请将空叶室测量文件复制几份（注意对应顺序），使其每个带叶片测量的数据文件和空叶室测量数据文件数量相同，并且一一对应，例如 emtpy-1-1 数据文件对应 leaf-1-1</strong>，文件命名前即制定好命名规则，方便后续数据处理。</p>
</div>
<div id="imbycsv" class="section level4">
<h4><span class="header-section-number">10.5.2.2</span> 处理大量 csv 文件</h4>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"><span class="co"># suppose leaf and empty data in 2 files in disk D:</span></a>
<a class="sourceLine" id="cb153-2" title="2">le=<span class="kw">list.files</span>(<span class="st">&quot;d:/racirle/&quot;</span>)</a>
<a class="sourceLine" id="cb153-3" title="3">em=<span class="kw">list.files</span>(<span class="st">&quot;d:/racirem/&quot;</span>)</a>
<a class="sourceLine" id="cb153-4" title="4"></a>
<a class="sourceLine" id="cb153-5" title="5"><span class="co"># construct the path of these csv files</span></a>
<a class="sourceLine" id="cb153-6" title="6">pathle =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;d:/racirle/&quot;</span>, le)</a>
<a class="sourceLine" id="cb153-7" title="7">pathem =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;d:/racirem/&quot;</span>, em)</a>
<a class="sourceLine" id="cb153-8" title="8"></a>
<a class="sourceLine" id="cb153-9" title="9"><span class="co"># import all leaf data and empty data separately</span></a>
<a class="sourceLine" id="cb153-10" title="10">xx &lt;-<span class="st"> </span><span class="kw">lapply</span>(pathle, read.csv)</a>
<a class="sourceLine" id="cb153-11" title="11">yy &lt;-<span class="st"> </span><span class="kw">lapply</span>(pathem, read.csv)</a>
<a class="sourceLine" id="cb153-12" title="12"></a>
<a class="sourceLine" id="cb153-13" title="13"><span class="co"># correct all the data</span></a>
<a class="sourceLine" id="cb153-14" title="14">all_correc &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map2</span>(yy, xx, racircal, <span class="dt">mincut =</span> <span class="dv">21</span>, <span class="dt">maxcut=</span><span class="dv">463</span>)</a>
<a class="sourceLine" id="cb153-15" title="15"></a>
<a class="sourceLine" id="cb153-16" title="16"><span class="co">#  export all data to csv files, these file have the same name with leaf data</span></a>
<a class="sourceLine" id="cb153-17" title="17">dirc &lt;-<span class="st"> </span><span class="kw">dir.create</span>(<span class="st">&quot;d:/data/&quot;</span>)</a>
<a class="sourceLine" id="cb153-18" title="18">finame &lt;-<span class="st"> &quot;d:/data/&quot;</span></a>
<a class="sourceLine" id="cb153-19" title="19">finame &lt;-<span class="st"> </span><span class="kw">paste0</span>(finame, le)</a>
<a class="sourceLine" id="cb153-20" title="20">purrr<span class="op">::</span><span class="kw">walk2</span>(all_correc,  finame, write.csv)</a></code></pre></div>
<p>以上代码仅供参考，主要是实现批量导入并校正，在批量将校正后数据导出为 csv 文件，为方便，将导出的文件名字命名为同原来带叶片测量数据相同的文件名，。</p>
</div>
</div>
</div>
<div id="fitbatracir" class="section level2">
<h2><span class="header-section-number">10.6</span> 批量计算 <span class="math inline">\(V_{cmax}\)</span> 和 <span class="math inline">\(J_max\)</span></h2>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="co">#use csv data above</span></a>
<a class="sourceLine" id="cb154-2" title="2">csvdata &lt;-<span class="st"> </span><span class="kw">lapply</span>(all_correc, plantecophys<span class="op">::</span>fitaci, </a>
<a class="sourceLine" id="cb154-3" title="3">    <span class="dt">varnames =</span> <span class="kw">list</span>(<span class="dt">ALEAF =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">Tleaf =</span> <span class="st">&quot;Tleaf&quot;</span>,</a>
<a class="sourceLine" id="cb154-4" title="4">    <span class="dt">Ci =</span> <span class="st">&quot;Ci&quot;</span>, <span class="dt">PPFD=</span> <span class="st">&quot;Q&quot;</span>, <span class="dt">Rd =</span> <span class="st">&quot;Rd&quot;</span>), <span class="dt">fitmethod =</span><span class="st">&quot;bilinear&quot;</span>)</a>
<a class="sourceLine" id="cb154-5" title="5"></a>
<a class="sourceLine" id="cb154-6" title="6"><span class="co"># use readphoto data above</span></a>
<a class="sourceLine" id="cb154-7" title="7">photodata &lt;-<span class="st"> </span><span class="kw">lapply</span>(cordata, plantecophys<span class="op">::</span>fitaci, </a>
<a class="sourceLine" id="cb154-8" title="8">    <span class="dt">varnames =</span> <span class="kw">list</span>(<span class="dt">ALEAF =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">Tleaf =</span> <span class="st">&quot;Tleaf&quot;</span>,</a>
<a class="sourceLine" id="cb154-9" title="9">    <span class="dt">Ci =</span> <span class="st">&quot;Ci&quot;</span>, <span class="dt">PPFD=</span> <span class="st">&quot;Q&quot;</span>, <span class="dt">Rd =</span> <span class="st">&quot;Rd&quot;</span>), <span class="dt">fitmethod =</span><span class="st">&quot;bilinear&quot;</span>)</a></code></pre></div>
<p>批量分析同样使用向量化来进行，避免了循环，效率比较高，也可以将拟合结果 <code>coef</code> 中的 <span class="math inline">\(V_{cmax}\)</span> 和 <span class="math inline">\(J_max\)</span> 结果批量导入文件，参考 @(imbycsv) 部分的代码。</p>


</div>
<div id="racir-conifer" class="section level2">
<h2><span class="header-section-number">10.7</span> LI-6800 RACiR簇状叶的测量与拟合</h2>
<p><span class="citation">Coursolle et al. (<a href="#ref-Coursolle12019" role="doc-biblioref">2019</a>)</span> 测量了簇状叶黑云杉和香脂冷杉两种簇状叶植物的 RACiR，其中的试验方法和结论值得在测量时借鉴，测量方法上：</p>
<ul>
<li><p>簇状叶室体积远大于荧光叶室和其他叶室，使用的 <span class="math inline">\(CO_2\)</span> 的变化为： 15 min 内从 20 ppm 到 1520 ppm 的变化，即变化的速率为 <span class="math inline">\(100 ppm \cdot min^{-1}\)</span>。但也测试了 200 - 800 ppm的部分曲线。</p></li>
<li><p>拟合使用了测量的 Rd，测量方法为：控制 reference 气路在 420 ppm 的 <span class="math inline">\(CO_2\)</span> 和 22 <span class="math inline">\(mmol \cdot mol^{-1}\)</span> 的 H<sub>2</sub>O 浓度，控制温度为 25 C，诱导后测量 Rd。</p></li>
</ul>
<p>得到了一些有帮助的结论：</p>
<ul>
<li><p>使用更大的叶室测量 RACiR 是可行的（36 <span class="math inline">\(cm^2\)</span>），叶室环境的控制需要通过预实验来确定。</p></li>
<li><p>该实验使用的 ACi 曲线测量时间在 30 到 36 min，而 RACiR 使用的<strong>完整的二氧化碳的浓度范围</strong>时，曲线耗时最大的时间接近 22 min。但使用 200 - 800 ppm 范围的变化，则时间可以下降 50%，<strong>这些部分范围的测量则可以应用于植物胁迫和表型平台的研究</strong>。</p></li>
<li><p>实验结果证明只要 match 的调整值保持不变即无需进行空叶室校准（也就是无需匹配的意思，实际的时间间隔取决于仪器的状态），但最新的 range match 功能可有效的增加空叶室校准的时间间隔（新功能，作者试验时尚未推出该功能）。</p></li>
<li><p>作者建议最好测量暗呼吸的速率，以获得最佳的 Vcmax 和 Jmax 计算结果。如果有第二台光合仪来测量则可有效的缩短测量时间。</p></li>
</ul>
<div id="conifer-fit-racir" class="section level3">
<h3><span class="header-section-number">10.7.1</span> 数据的拟合</h3>
<div id="name-files" class="section level4">
<h4><span class="header-section-number">10.7.1.1</span> 数据文件的命名</h4>
<p>因为作者读取数据和修正数据都依赖于正则表达式，因此，所有文件的命名规则必须满足以下的要求：</p>
<ul>
<li><p>空叶室校准的文件必须以 “mpty” 起始</p></li>
<li><p>RACiR 的文件必须以 “fast” 起始</p></li>
<li><p>常规 ACi 测量必须以 “slow” 起始</p></li>
<li><p>Rd 测量数据文件必须以 “dark” 起始</p></li>
</ul>
<p>例如作者示例数据分别命名为：</p>
<p>Empty_2.xlsx，Fast.xlsx， Slow.xlsx， Dark.xksx，实际使用的正则表达式为:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">pattern_empty       =<span class="st"> &quot;^(mpty)+.xls&quot;</span>,      </a>
<a class="sourceLine" id="cb155-2" title="2">pattern_rapidACi    =<span class="st"> &quot;^(fast)+.xls&quot;</span>,      </a>
<a class="sourceLine" id="cb155-3" title="3">pattern_standardACi =<span class="st"> &quot;^(slow)+.xls&quot;</span>,      </a>
<a class="sourceLine" id="cb155-4" title="4">pattern_dark        =<span class="st"> &quot;^(dark)+.xls&quot;</span>,</a></code></pre></div>
<p>如不满足要求，自然会出现错乱。准备好命名的数据文件之后，那么可以把他们放在一个文件夹内。</p>
</div>
<div id="match-time" class="section level4">
<h4><span class="header-section-number">10.7.1.2</span> 匹配的问题</h4>
<p>若进行了匹配，要重新开始空叶室校准，RapidACi 软件包采用的规则是，使用 Match 分组下的 time来区分，首先使用该时间和空叶室一致的 RACiR 数据配对校准，若无一致的数据，则选择该时间和 RACiR 测量相差最短的空叶室数据来校准 RACiR 数据。</p>
</div>
</div>
<div id="conifer-racir-fit" class="section level3">
<h3><span class="header-section-number">10.7.2</span> 拟合过程</h3>
<p>作何给出了详细的代码和数据，此处不再重复和演示，请参考：</p>
<p><a href="https://github.com/ManuelLamothe/RapidACi">github 演示</a></p>
<p><a href="https://www.frontiersin.org/articles/10.3389/fpls.2019.01276/full#supplementary-material">发表文章的附加材料</a></p>
<p><strong>注：今天测试了他附加材料的代码，有可能遇到问题，或者有一些注意事项，请参考下面的代码（本地已经有数据了，因此并未执行下载的代码，改为本地读取）。</strong></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co">#安装及加载大量的依赖</span></a>
<a class="sourceLine" id="cb156-2" title="2">remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ManuelLamothe/RapidACi&quot;</span>)</a>
<a class="sourceLine" id="cb156-3" title="3"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(tidyverse))</a>
<a class="sourceLine" id="cb156-4" title="4">  <span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb156-5" title="5"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(readxl))</a>
<a class="sourceLine" id="cb156-6" title="6">  <span class="kw">install.packages</span>(<span class="st">&quot;readxl&quot;</span>)</a>
<a class="sourceLine" id="cb156-7" title="7"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(XLConnect))</a>
<a class="sourceLine" id="cb156-8" title="8">  <span class="kw">install.packages</span>(<span class="st">&quot;XLConnect&quot;</span>)</a>
<a class="sourceLine" id="cb156-9" title="9"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(plantecophys))</a>
<a class="sourceLine" id="cb156-10" title="10">  <span class="kw">install.packages</span>(<span class="st">&quot;plantecophys&quot;</span>)</a>
<a class="sourceLine" id="cb156-11" title="11"></a>
<a class="sourceLine" id="cb156-12" title="12"><span class="kw">library</span>(RapidACi)</a>
<a class="sourceLine" id="cb156-13" title="13"><span class="kw">library</span>(XLConnect)</a>
<a class="sourceLine" id="cb156-14" title="14"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb156-15" title="15"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb156-16" title="16"><span class="kw">library</span>(plantecophys)</a>
<a class="sourceLine" id="cb156-17" title="17"></a>
<a class="sourceLine" id="cb156-18" title="18"></a>
<a class="sourceLine" id="cb156-19" title="19"></a>
<a class="sourceLine" id="cb156-20" title="20"></a>
<a class="sourceLine" id="cb156-21" title="21"><span class="co">#build_list:</span></a>
<a class="sourceLine" id="cb156-22" title="22"><span class="co">#测量最好直接存放 “data”文件夹下</span></a>
<a class="sourceLine" id="cb156-23" title="23"><span class="co">#然后建立了4个匹配规则，分别是：</span></a>
<a class="sourceLine" id="cb156-24" title="24"><span class="co">#pattern_empty = &quot;(mpty).*\\.xls&quot;,</span></a>
<a class="sourceLine" id="cb156-25" title="25"><span class="co">#pattern_rapidACi = &quot;(fast).*\\.xls&quot;,</span></a>
<a class="sourceLine" id="cb156-26" title="26"><span class="co">#pattern_standardACi = &quot;(slow).*\\.xls&quot;,</span></a>
<a class="sourceLine" id="cb156-27" title="27"><span class="co">#pattern_dark = &quot;(dark).*\\.xls&quot;,</span></a>
<a class="sourceLine" id="cb156-28" title="28"></a>
<a class="sourceLine" id="cb156-29" title="29"><span class="co">#如果后面需要修改叶面积，那么需要提供额外的dataframe，其中必须有两列：</span></a>
<a class="sourceLine" id="cb156-30" title="30"><span class="co"># sample_ID, 以及其中的一列必须命名为 LeafArea_mm2</span></a>
<a class="sourceLine" id="cb156-31" title="31"></a>
<a class="sourceLine" id="cb156-32" title="32"><span class="co"># 默认 match 的 time 列为 BN，若有其他用户自定义选项，请修改默认参数</span></a>
<a class="sourceLine" id="cb156-33" title="33"><span class="co"># 空叶室校准的选择原则为：默认选择距离racir测量时间最近的空叶室（empty开头的）测量</span></a>
<a class="sourceLine" id="cb156-34" title="34"><span class="co"># 进行校准</span></a>
<a class="sourceLine" id="cb156-35" title="35"></a>
<a class="sourceLine" id="cb156-36" title="36"></a>
<a class="sourceLine" id="cb156-37" title="37">list_files &lt;-<span class="st"> </span><span class="kw">build_list</span>()</a>
<a class="sourceLine" id="cb156-38" title="38">list_files<span class="op">$</span>sample_ID[<span class="dv">1</span>] &lt;-<span class="st"> &quot;fastdemo&quot;</span></a>
<a class="sourceLine" id="cb156-39" title="39"></a>
<a class="sourceLine" id="cb156-40" title="40"><span class="co"># 了解一下 build_list 的作用</span></a>
<a class="sourceLine" id="cb156-41" title="41">list_files</a>
<a class="sourceLine" id="cb156-42" title="42"></a>
<a class="sourceLine" id="cb156-43" title="43">results &lt;-<span class="st"> </span><span class="kw">Rapid_aci_correction</span>(list_files)</a>
<a class="sourceLine" id="cb156-44" title="44">results</a>
<a class="sourceLine" id="cb156-45" title="45"></a>
<a class="sourceLine" id="cb156-46" title="46"><span class="co"># 诊断校准的结果</span></a>
<a class="sourceLine" id="cb156-47" title="47"><span class="co"># 如果报错：unable to start png() device</span></a>
<a class="sourceLine" id="cb156-48" title="48"><span class="co"># 那么可能是权限的原因无法建立 figure 文件夹</span></a>
<a class="sourceLine" id="cb156-49" title="49"><span class="kw">dir.create</span>(<span class="st">&quot;./figure/&quot;</span>, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb156-50" title="50"></a>
<a class="sourceLine" id="cb156-51" title="51"><span class="kw">diagnose_sample</span>(results, <span class="dt">sample_name =</span> <span class="st">&quot;fastdemo&quot;</span>)</a>
<a class="sourceLine" id="cb156-52" title="52"></a>
<a class="sourceLine" id="cb156-53" title="53"><span class="co"># 添加 racir </span></a>
<a class="sourceLine" id="cb156-54" title="54">Raci &lt;-<span class="st"> </span>results[[<span class="st">&quot;fastdemo&quot;</span>]]<span class="op">$</span>Raci</a>
<a class="sourceLine" id="cb156-55" title="55"></a>
<a class="sourceLine" id="cb156-56" title="56"><span class="co"># range sheet measurements 绝对引用 I17</span></a>
<a class="sourceLine" id="cb156-57" title="57">Dark &lt;-</a>
<a class="sourceLine" id="cb156-58" title="58"><span class="st">  </span><span class="kw">read_excel</span>(</a>
<a class="sourceLine" id="cb156-59" title="59">    <span class="st">&quot;./ds/Dark.xlsx&quot;</span>,</a>
<a class="sourceLine" id="cb156-60" title="60">    <span class="dt">range =</span> <span class="st">&quot;Measurements!I17&quot;</span>,</a>
<a class="sourceLine" id="cb156-61" title="61">    <span class="dt">col_types =</span> <span class="st">&quot;numeric&quot;</span>,</a>
<a class="sourceLine" id="cb156-62" title="62">    <span class="dt">col_names =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb156-63" title="63">  )</a>
<a class="sourceLine" id="cb156-64" title="64"></a>
<a class="sourceLine" id="cb156-65" title="65">Raci<span class="op">$</span>Rd &lt;-<span class="st"> </span><span class="kw">pull</span>(Dark) </a>
<a class="sourceLine" id="cb156-66" title="66"></a>
<a class="sourceLine" id="cb156-67" title="67">fRaci &lt;-<span class="st"> </span><span class="kw">fitaci</span>(Raci, <span class="dt">useRd=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb156-68" title="68"><span class="kw">par</span>(<span class="dt">mgp=</span><span class="kw">c</span>(<span class="fl">2.5</span>,<span class="dv">1</span>,<span class="dv">0</span>), <span class="dt">family=</span><span class="st">&quot;serif&quot;</span>, <span class="dt">ps=</span><span class="dv">14</span>) </a>
<a class="sourceLine" id="cb156-69" title="69"><span class="kw">plot</span>(fRaci, <span class="dt">las=</span><span class="dv">1</span>,<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1200</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>)) </a></code></pre></div>


</div>
</div>
<div id="racir68_exam" class="section level2">
<h2><span class="header-section-number">10.8</span> RACiR分析的手动实现</h2>
<p>以下内容是我之前写的内容，部分代码的实现和上述软件包相似，仅供参考，尤其是当您使用 <code>racir</code> 软件包报错时，可以参考下文代码手动实现 RACiR 数据的分析。</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="co"># 加载需要的软件包  ---------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb157-2" title="2"></a>
<a class="sourceLine" id="cb157-3" title="3"><span class="kw">library</span>(<span class="st">&quot;plantecophys&quot;</span>)</a>
<a class="sourceLine" id="cb157-4" title="4"></a>
<a class="sourceLine" id="cb157-5" title="5"><span class="co">#准备数据 ------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb157-6" title="6">empty_uc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/racir-csv/uncorr_emp500.csv&quot;</span>)</a>
<a class="sourceLine" id="cb157-7" title="7">leaf_uc &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/racir-csv/uncorr_leaf500.csv&quot;</span>)</a>
<a class="sourceLine" id="cb157-8" title="8">aci &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/racir-csv/aci_ex.csv&quot;</span>)</a>
<a class="sourceLine" id="cb157-9" title="9"></a>
<a class="sourceLine" id="cb157-10" title="10"><span class="co"># 防止读入空白行</span></a>
<a class="sourceLine" id="cb157-11" title="11">empty_uc &lt;-<span class="st"> </span><span class="kw">subset</span>(empty_uc, obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb157-12" title="12">leaf_uc &lt;-<span class="st"> </span><span class="kw">subset</span>(leaf_uc , obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb157-13" title="13">aci &lt;-<span class="st"> </span><span class="kw">subset</span>(aci, obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb157-14" title="14"></a>
<a class="sourceLine" id="cb157-15" title="15"><span class="co"># 空叶室校准的系数计算 --------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb157-16" title="16"></a>
<a class="sourceLine" id="cb157-17" title="17"><span class="co"># 观察空叶室未校准数据reference对A的图形</span></a>
<a class="sourceLine" id="cb157-18" title="18"><span class="kw">plot</span>(empty_uc<span class="op">$</span>CO2_r, empty_uc<span class="op">$</span>A)</a>
<a class="sourceLine" id="cb157-19" title="19"><span class="co"># 选取线性部分用于校准</span></a>
<a class="sourceLine" id="cb157-20" title="20"><span class="kw">locator</span>()</a>
<a class="sourceLine" id="cb157-21" title="21"></a>
<a class="sourceLine" id="cb157-22" title="22"><span class="co"># 执行locator命令后，在上图中的目标位置选点，</span></a>
<a class="sourceLine" id="cb157-23" title="23"><span class="co"># 选好后按 esc 可以返回所选点的坐标（选点即为在</span></a>
<a class="sourceLine" id="cb157-24" title="24"><span class="co"># 预期位置鼠标单击）</span></a>
<a class="sourceLine" id="cb157-25" title="25"><span class="co"># 根据上面的点，利用二氧化碳的值过滤掉不需要的数据</span></a>
<a class="sourceLine" id="cb157-26" title="26"><span class="co"># 只要在线性范围内选点，拟合结果相差很小</span></a>
<a class="sourceLine" id="cb157-27" title="27"></a>
<a class="sourceLine" id="cb157-28" title="28">empty_ct &lt;-<span class="st"> </span>empty_uc[<span class="kw">which</span>(empty_uc<span class="op">$</span>CO2_r <span class="op">&gt;</span></a>
<a class="sourceLine" id="cb157-29" title="29"><span class="st">  </span><span class="fl">45.28</span> <span class="op">&amp;</span><span class="st"> </span>empty_uc<span class="op">$</span>CO2_r <span class="op">&lt;</span><span class="st"> </span><span class="fl">459.12</span>), ]</a>
<a class="sourceLine" id="cb157-30" title="30"><span class="kw">plot</span>(empty_ct<span class="op">$</span>CO2_r, empty_ct<span class="op">$</span>A)</a>
<a class="sourceLine" id="cb157-31" title="31"></a>
<a class="sourceLine" id="cb157-32" title="32"><span class="co"># 采用 1~5 次多项式分别拟合</span></a>
<a class="sourceLine" id="cb157-33" title="33">cal1st &lt;-<span class="st"> </span><span class="kw">lm</span>(A <span class="op">~</span><span class="st"> </span>CO2_r, <span class="dt">data =</span> empty_ct)</a>
<a class="sourceLine" id="cb157-34" title="34">cal2nd &lt;-<span class="st"> </span><span class="kw">lm</span>(A <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(CO2_r, <span class="dv">2</span>), <span class="dt">data =</span> empty_ct)</a>
<a class="sourceLine" id="cb157-35" title="35">cal3rd &lt;-<span class="st"> </span><span class="kw">lm</span>(A <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(CO2_r, <span class="dv">3</span>), <span class="dt">data =</span> empty_ct)</a>
<a class="sourceLine" id="cb157-36" title="36">cal4th &lt;-<span class="st"> </span><span class="kw">lm</span>(A <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(CO2_r, <span class="dv">4</span>), <span class="dt">data =</span> empty_ct)</a>
<a class="sourceLine" id="cb157-37" title="37">cal5th &lt;-<span class="st"> </span><span class="kw">lm</span>(A <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(CO2_r, <span class="dv">5</span>), <span class="dt">data =</span> empty_ct)</a>
<a class="sourceLine" id="cb157-38" title="38"><span class="co"># 利用 BIC 找出最合理的校准方程</span></a>
<a class="sourceLine" id="cb157-39" title="39">bics &lt;-<span class="st"> </span><span class="kw">BIC</span>(cal1st, cal2nd, cal3rd, cal4th, cal5th)</a>
<a class="sourceLine" id="cb157-40" title="40"><span class="co"># noquote也就是没引号，成为名字</span></a>
<a class="sourceLine" id="cb157-41" title="41">best &lt;-<span class="st"> </span><span class="kw">noquote</span>(<span class="kw">rownames</span>(bics)[bics<span class="op">$</span>BIC <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(bics<span class="op">$</span>BIC)])</a>
<a class="sourceLine" id="cb157-42" title="42">best</a>
<a class="sourceLine" id="cb157-43" title="43"></a>
<a class="sourceLine" id="cb157-44" title="44"></a>
<a class="sourceLine" id="cb157-45" title="45"><span class="co"># 校准带叶片测量的数据 --------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb157-46" title="46"></a>
<a class="sourceLine" id="cb157-47" title="47">leaf_uc<span class="op">$</span>A &lt;-<span class="st"> </span>leaf_uc<span class="op">$</span>A <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(cal4th, leaf_uc)</a>
<a class="sourceLine" id="cb157-48" title="48">leaf_uc<span class="op">$</span>Ci &lt;-<span class="st"> </span>((leaf_uc<span class="op">$</span>gtc <span class="op">-</span><span class="st"> </span>leaf_uc<span class="op">$</span>E <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>leaf_uc<span class="op">$</span>CO2_s <span class="op">-</span></a>
<a class="sourceLine" id="cb157-49" title="49"><span class="st">                 </span>leaf_uc<span class="op">$</span>A) <span class="op">/</span><span class="st"> </span>(leaf_uc<span class="op">$</span>gtc <span class="op">+</span><span class="st"> </span>leaf_uc<span class="op">$</span>E <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb157-50" title="50"></a>
<a class="sourceLine" id="cb157-51" title="51"><span class="co"># 对校准后的数据进行作图，查看校准效果</span></a>
<a class="sourceLine" id="cb157-52" title="52"><span class="kw">plot</span>(leaf_uc<span class="op">$</span>CO2_r,</a>
<a class="sourceLine" id="cb157-53" title="53">     leaf_uc<span class="op">$</span>A,</a>
<a class="sourceLine" id="cb157-54" title="54">     <span class="dt">pch =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb157-55" title="55">     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>, <span class="dv">40</span>))</a>
<a class="sourceLine" id="cb157-56" title="56"></a>
<a class="sourceLine" id="cb157-57" title="57"><span class="co"># 选取带叶片测量的有效数据的范围</span></a>
<a class="sourceLine" id="cb157-58" title="58"><span class="kw">locator</span>()</a>
<a class="sourceLine" id="cb157-59" title="59"></a>
<a class="sourceLine" id="cb157-60" title="60">leaf_ct &lt;-<span class="st"> </span>leaf_uc[<span class="kw">which</span>(leaf_uc<span class="op">$</span>CO2_r <span class="op">&gt;</span><span class="st"> </span><span class="fl">13.6</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb157-61" title="61"><span class="st">   </span>leaf_uc<span class="op">$</span>CO2_r <span class="op">&lt;</span><span class="st"> </span><span class="dv">471</span>), ]</a>
<a class="sourceLine" id="cb157-62" title="62"><span class="kw">plot</span>(leaf_uc<span class="op">$</span>CO2_r, leaf_uc<span class="op">$</span>A)</a>
<a class="sourceLine" id="cb157-63" title="63"></a>
<a class="sourceLine" id="cb157-64" title="64"></a>
<a class="sourceLine" id="cb157-65" title="65"><span class="co"># 拟合 ----------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb157-66" title="66">racir &lt;-<span class="st"> </span><span class="kw">fitaci</span>(</a>
<a class="sourceLine" id="cb157-67" title="67">  leaf_ct,</a>
<a class="sourceLine" id="cb157-68" title="68">  <span class="dt">varnames =</span></a>
<a class="sourceLine" id="cb157-69" title="69">    <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb157-70" title="70">      <span class="dt">ALEAF =</span> <span class="st">&quot;A&quot;</span>,</a>
<a class="sourceLine" id="cb157-71" title="71">      <span class="dt">Tleaf =</span> <span class="st">&quot;Tleaf&quot;</span>,</a>
<a class="sourceLine" id="cb157-72" title="72">      <span class="dt">Ci =</span> <span class="st">&quot;Ci&quot;</span>,</a>
<a class="sourceLine" id="cb157-73" title="73">      <span class="dt">PPFD  =</span> <span class="st">&quot;Qin&quot;</span>,</a>
<a class="sourceLine" id="cb157-74" title="74">      <span class="dt">Rd =</span> <span class="st">&quot;Rd&quot;</span></a>
<a class="sourceLine" id="cb157-75" title="75">    ),</a>
<a class="sourceLine" id="cb157-76" title="76">  <span class="dt">Patm =</span> <span class="fl">84.09</span></a>
<a class="sourceLine" id="cb157-77" title="77">)</a>
<a class="sourceLine" id="cb157-78" title="78"></a>
<a class="sourceLine" id="cb157-79" title="79">slow &lt;-<span class="st"> </span><span class="kw">fitaci</span>(</a>
<a class="sourceLine" id="cb157-80" title="80">  aci,</a>
<a class="sourceLine" id="cb157-81" title="81">  <span class="dt">varnames =</span></a>
<a class="sourceLine" id="cb157-82" title="82">    <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb157-83" title="83">      <span class="dt">ALEAF =</span> <span class="st">&quot;A&quot;</span>,</a>
<a class="sourceLine" id="cb157-84" title="84">      <span class="dt">Tleaf =</span> <span class="st">&quot;Tleaf&quot;</span>,</a>
<a class="sourceLine" id="cb157-85" title="85">      <span class="dt">Ci =</span> <span class="st">&quot;Ci&quot;</span>,</a>
<a class="sourceLine" id="cb157-86" title="86">      <span class="dt">PPFD  =</span> <span class="st">&quot;Qin&quot;</span>,</a>
<a class="sourceLine" id="cb157-87" title="87">      <span class="dt">Rd =</span> <span class="st">&quot;Rd&quot;</span></a>
<a class="sourceLine" id="cb157-88" title="88">    ),</a>
<a class="sourceLine" id="cb157-89" title="89">  <span class="dt">Patm =</span> <span class="fl">84.09</span></a>
<a class="sourceLine" id="cb157-90" title="90">)</a>
<a class="sourceLine" id="cb157-91" title="91"></a>
<a class="sourceLine" id="cb157-92" title="92"><span class="co"># 查看拟合数据</span></a>
<a class="sourceLine" id="cb157-93" title="93">racir<span class="op">$</span>pars</a>
<a class="sourceLine" id="cb157-94" title="94">slow<span class="op">$</span>pars</a>
<a class="sourceLine" id="cb157-95" title="95"></a>
<a class="sourceLine" id="cb157-96" title="96"><span class="co"># 对快速曲线作图拟合结果进行查看</span></a>
<a class="sourceLine" id="cb157-97" title="97"><span class="kw">plot</span>(racir, <span class="dt">linecols =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))</a></code></pre></div>
<p>注意，注意数据表头的大小写，此处代码中，为处理数据的方便，我更改了大小写，分析自己的数据时需要注意。</p>


</div>
<div id="multi1" class="section level2">
<h2><span class="header-section-number">10.9</span> 多个速率的 RACiR 曲线研究</h2>
<p>自 RACiR 技术诞生以来，极大的缩短了 Vcmax 以及 Jmax 的测量时间(<span class="citation">Stinziano et al. (<a href="#ref-stinziano2017" role="doc-biblioref">2017</a>)</span>)，但也引起了一系列争议，作者也对业内的质疑进行了一一的解答 (<span class="citation">Stinziano et al. (<a href="#ref-stinziano2018" role="doc-biblioref">2018</a>)</span>)，但除了因为时间长短导致酶活性，叶绿体位置等差异外，RACiR 还能说明哪些问题呢？<span class="citation">Joseph R., Rachael K., and David T. (<a href="#ref-stinziano2019" role="doc-biblioref">2019</a>)</span> 最新的研究给出一系列结论：</p>
<ul>
<li><p>扩散限制（<span class="math inline">\(CO_2\)</span> 总导度） 和光呼吸导致了表观上的标准 ACi 曲线和 RACiR 测量之间的偏差，表明他们的差异是由<strong>生物因子引起，而非仪器导致的人为误差</strong>。</p></li>
<li><p>上述原因导致的二者之间的偏差，如果不进行修正，那么将显著的低估 <span class="math inline">\(\Gamma^*\)</span>, 除非使用多个速率的 RACiR 来修正。</p></li>
<li><p>较高速率的 RACiR 曲线会增大其与标准曲线之间的偏差，但这个差距在无光呼吸的条件下会减小。</p></li>
<li><p>因为光呼吸和气体扩散限制与物种相关，结合以上结论，可以使用多个速率的 RACiR 来估算对 <span class="math inline">\(CO_2\)</span> 的总导度以及相对量的光呼吸速率。</p></li>
</ul>
<p>一些可能的方向：</p>
<ul>
<li><p>扩散限制影响 Cc 速率的变化，说明对具有较高总阻力与 <span class="math inline">\(CO_2\)</span> 比值的物种，例如针叶物种，C4 植物，较高的阻力导致 RACiR 与 标准 ACi 测量斜率更大的差异，或者测量的前提假设被破坏。</p></li>
<li><p>RACiR 可检测到代谢中 <span class="math inline">\(CO_2\)</span> 的滞后性，各种滞后性的检测对标准 ACi 测量也具有指示性。</p></li>
</ul>
<p>文中利用 R 实现了光呼吸之后模型和气体扩散限制模型，本文内容主要对文献中附录材料的源码进行解释：</p>
<div id="multi2" class="section level3">
<h3><span class="header-section-number">10.9.1</span> 光呼吸滞后模型</h3>
<p>为测试光呼吸的滞后性，作者使用一系列预先设定的参数，模拟了一条 ACc曲线，假定 Rubisco 激活状态为 100%，并且在整个测量过程中气孔导度是不变的。然后使用这些参数来模拟 RACiRs 曲线，并且假定光呼吸分别需要 0, 15, 30, 60, 120 或 300 s 来对变化的 <span class="math inline">\(CO_2\)</span> 进行响应，在实际效果上，这意味着 Cc 在最初的 0, 15, 30, 60, 120 或 300 内是不变的，最后我们对 <span class="math inline">\(\Gamma^*\)</span> 和 Ci 使用线性回归进行计算。</p>
<div id="multi3" class="section level4">
<h4><span class="header-section-number">10.9.1.1</span> 构造基础数据</h4>
<p>模型第一步，则是对需要使用的参数，根据文献和实际情况进行赋值，具体内容参考代码注释。</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="kw">library</span>(plyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb161-2" title="2"></a>
<a class="sourceLine" id="cb161-3" title="3"><span class="co"># 对图例使用自定义颜色</span></a>
<a class="sourceLine" id="cb161-4" title="4">gg_color_hue &lt;-<span class="st"> </span><span class="cf">function</span>(n) {</a>
<a class="sourceLine" id="cb161-5" title="5">  hues =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">15</span>, <span class="dv">375</span>, <span class="dt">length =</span> n <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb161-6" title="6">  <span class="kw">hcl</span>(<span class="dt">h =</span> hues, <span class="dt">l =</span> <span class="dv">65</span>, <span class="dt">c =</span> <span class="dv">100</span>)[<span class="dv">1</span><span class="op">:</span>n]</a>
<a class="sourceLine" id="cb161-7" title="7">}</a>
<a class="sourceLine" id="cb161-8" title="8"></a>
<a class="sourceLine" id="cb161-9" title="9"><span class="co">#Maximum Rubisco carboxylation rate in umol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-10" title="10">Vcmax &lt;-<span class="st"> </span><span class="dv">110</span></a>
<a class="sourceLine" id="cb161-11" title="11"></a>
<a class="sourceLine" id="cb161-12" title="12"><span class="co">#Maximum Rubisco oxygenation rate in umol m-2 s-1;</span></a>
<a class="sourceLine" id="cb161-13" title="13"><span class="co">#Ratio from Bernacchi et al. 2001. PCE 24:253-259</span></a>
<a class="sourceLine" id="cb161-14" title="14">Vomax &lt;-<span class="st"> </span><span class="fl">0.29</span> <span class="op">*</span><span class="st"> </span>Vcmax</a>
<a class="sourceLine" id="cb161-15" title="15"><span class="co">#Dark respiration in umol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-16" title="16">R &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb161-17" title="17"><span class="co">#Michaelis-Menten constant for Rubisco carboxylation in umol mol-1</span></a>
<a class="sourceLine" id="cb161-18" title="18">Kc &lt;-<span class="st"> </span><span class="fl">404.9</span></a>
<a class="sourceLine" id="cb161-19" title="19"><span class="co">#Michaelis-Menten constant for Rubisco oxygenation in mmol mol-1</span></a>
<a class="sourceLine" id="cb161-20" title="20">Ko &lt;-<span class="st"> </span><span class="fl">278.4</span></a>
<a class="sourceLine" id="cb161-21" title="21"><span class="co">#oxygen concentration in mmol mol-1</span></a>
<a class="sourceLine" id="cb161-22" title="22">O2 &lt;-<span class="st"> </span><span class="dv">210</span></a>
<a class="sourceLine" id="cb161-23" title="23">Kco &lt;-<span class="st"> </span>Kc <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>Ko)</a>
<a class="sourceLine" id="cb161-24" title="24"><span class="co">#Boundary layer conductance in mol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-25" title="25">BLC &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb161-26" title="26"><span class="co">#stomatal conductance in mol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-27" title="27">gsw &lt;-<span class="st"> </span><span class="fl">0.4</span></a>
<a class="sourceLine" id="cb161-28" title="28"><span class="co">#mesophyll conductance in mol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-29" title="29">gm &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb161-30" title="30"><span class="co">#Chloroplastic CO2 in umol mol-1</span></a>
<a class="sourceLine" id="cb161-31" title="31">Cc &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">25</span><span class="op">:</span><span class="dv">400</span>))</a>
<a class="sourceLine" id="cb161-32" title="32"><span class="co">#oxygenation rate in umol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-33" title="33">vo &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb161-34" title="34"><span class="co">#carboxylation rate in umol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-35" title="35">vc &lt;-<span class="st"> </span>Vcmax <span class="op">*</span><span class="st"> </span>(Cc) <span class="op">/</span><span class="st"> </span>(Cc <span class="op">+</span><span class="st"> </span>Kco)</a>
<a class="sourceLine" id="cb161-36" title="36"><span class="co">#Net CO2 assimilation in umol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-37" title="37">A &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb161-38" title="38"><span class="co">#Apparent CO2 assimilation rate in umol m-2 s-1</span></a>
<a class="sourceLine" id="cb161-39" title="39">Aapparent &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo</a>
<a class="sourceLine" id="cb161-40" title="40"><span class="co">#Intercellular CO2 in umol mol-1</span></a>
<a class="sourceLine" id="cb161-41" title="41">Ci &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc</a>
<a class="sourceLine" id="cb161-42" title="42"><span class="co">#Boundary layer CO2 in umol mol-1</span></a>
<a class="sourceLine" id="cb161-43" title="43">Cb &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci</a>
<a class="sourceLine" id="cb161-44" title="44"><span class="co">#Reference CO2 in umol mol-1</span></a>
<a class="sourceLine" id="cb161-45" title="45">Cr &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb</a>
<a class="sourceLine" id="cb161-46" title="46"></a>
<a class="sourceLine" id="cb161-47" title="47"><span class="co">#根据Cc浓度的个数，构造向量</span></a>
<a class="sourceLine" id="cb161-48" title="48">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb161-49" title="49"><span class="co">#也就是以秒计算的cr与时间的模型</span></a>
<a class="sourceLine" id="cb161-50" title="50">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb161-51" title="51"><span class="co">#转化为分钟的cr的斜率</span></a>
<a class="sourceLine" id="cb161-52" title="52">RateCr &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb161-53" title="53"></a>
<a class="sourceLine" id="cb161-54" title="54"><span class="co">#转换为分钟的边界层导度斜率</span></a>
<a class="sourceLine" id="cb161-55" title="55">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb161-56" title="56">RateCb &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb161-57" title="57"></a>
<a class="sourceLine" id="cb161-58" title="58"><span class="co">#转换为分钟的ci的斜率</span></a>
<a class="sourceLine" id="cb161-59" title="59">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb161-60" title="60">RateCi &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb161-61" title="61"></a>
<a class="sourceLine" id="cb161-62" title="62"><span class="co">#转换为分钟的Cc的斜率</span></a>
<a class="sourceLine" id="cb161-63" title="63">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb161-64" title="64">RateCc &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> </a></code></pre></div>
</div>
</div>
<div id="code-photoresp" class="section level3">
<h3><span class="header-section-number">10.9.2</span> 光呼吸滞后性代码</h3>
<p>下面代码的目的是为得到 ACi 响应曲线受光呼吸延迟的影响，尤其是在临近补偿点时。</p>
<p><strong>延迟模块</strong></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="co">#假定有15s延迟时的数据，即相比上面构造的Cc数据减少15个点</span></a>
<a class="sourceLine" id="cb162-2" title="2">Cc15 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>((<span class="kw">min</span>(Cc) <span class="op">+</span><span class="st"> </span><span class="dv">15</span>)<span class="op">:</span><span class="kw">max</span>(Cc), <span class="kw">rep</span>(<span class="kw">max</span>(Cc), <span class="dv">15</span>)))</a>
<a class="sourceLine" id="cb162-3" title="3">vo15 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc15 <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb162-4" title="4">A15 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo15 <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb162-5" title="5">Aapparent15 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo15</a>
<a class="sourceLine" id="cb162-6" title="6"></a>
<a class="sourceLine" id="cb162-7" title="7"><span class="co">#30 s 延迟数据</span></a>
<a class="sourceLine" id="cb162-8" title="8">Cc30 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>((<span class="kw">min</span>(Cc) <span class="op">+</span><span class="st"> </span><span class="dv">30</span>)<span class="op">:</span><span class="kw">max</span>(Cc), <span class="kw">rep</span>(<span class="kw">max</span>(Cc), <span class="dv">30</span>)))</a>
<a class="sourceLine" id="cb162-9" title="9">vo30 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc30 <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb162-10" title="10">A30 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo30 <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb162-11" title="11">Aapparent30 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo30</a>
<a class="sourceLine" id="cb162-12" title="12"></a>
<a class="sourceLine" id="cb162-13" title="13"><span class="co">#60s 延迟数据</span></a>
<a class="sourceLine" id="cb162-14" title="14">Cc60 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>((<span class="kw">min</span>(Cc) <span class="op">+</span><span class="st"> </span><span class="dv">60</span>)<span class="op">:</span><span class="kw">max</span>(Cc), <span class="kw">rep</span>(<span class="kw">max</span>(Cc), <span class="dv">60</span>)))</a>
<a class="sourceLine" id="cb162-15" title="15">vo60 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc60 <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb162-16" title="16">A60 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo60 <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb162-17" title="17">Aapparent60 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo60</a>
<a class="sourceLine" id="cb162-18" title="18"></a>
<a class="sourceLine" id="cb162-19" title="19"><span class="co">#120s延迟数据</span></a>
<a class="sourceLine" id="cb162-20" title="20">Cc120 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>((<span class="kw">min</span>(Cc) <span class="op">+</span><span class="st"> </span><span class="dv">120</span>)<span class="op">:</span><span class="kw">max</span>(Cc), <span class="kw">rep</span>(<span class="kw">max</span>(Cc), <span class="dv">120</span>)))</a>
<a class="sourceLine" id="cb162-21" title="21">vo120 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc120 <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb162-22" title="22">A120 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo120 <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb162-23" title="23">Aapparent120 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo120</a>
<a class="sourceLine" id="cb162-24" title="24"></a>
<a class="sourceLine" id="cb162-25" title="25"><span class="co">#300s延迟数据</span></a>
<a class="sourceLine" id="cb162-26" title="26">Cc300 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>((<span class="kw">min</span>(Cc) <span class="op">+</span><span class="st"> </span><span class="dv">300</span>)<span class="op">:</span><span class="kw">max</span>(Cc), <span class="kw">rep</span>(<span class="kw">max</span>(Cc), <span class="dv">300</span>)))</a>
<a class="sourceLine" id="cb162-27" title="27">vo300 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc300 <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb162-28" title="28">A300 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo120 <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb162-29" title="29">Aapparent300 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo300 </a></code></pre></div>
</div>
<div id="multi4" class="section level3">
<h3><span class="header-section-number">10.9.3</span> 数据的构造</h3>
<p>下面的代码主要是将上文最终计算的数据构造数据集，并导出。</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">Anet &lt;-<span class="st"> </span><span class="kw">c</span>(A, A15, A30, A60, A120, A300)</a>
<a class="sourceLine" id="cb163-2" title="2">Aapp &lt;-</a>
<a class="sourceLine" id="cb163-3" title="3"><span class="st">  </span><span class="kw">c</span>(Aapparent,</a>
<a class="sourceLine" id="cb163-4" title="4">    Aapparent15,</a>
<a class="sourceLine" id="cb163-5" title="5">    Aapparent30,</a>
<a class="sourceLine" id="cb163-6" title="6">    Aapparent60,</a>
<a class="sourceLine" id="cb163-7" title="7">    Aapparent120,</a>
<a class="sourceLine" id="cb163-8" title="8">    Aapparent300)</a>
<a class="sourceLine" id="cb163-9" title="9">Ccfull &lt;-<span class="st"> </span><span class="kw">rep</span>(Cc, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb163-10" title="10">Cifull &lt;-<span class="st"> </span><span class="kw">rep</span>(Ci, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb163-11" title="11">Delay &lt;-</a>
<a class="sourceLine" id="cb163-12" title="12"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb163-13" title="13">    <span class="kw">rep</span>(<span class="st">&quot;0&quot;</span>, <span class="kw">length</span>(A)),</a>
<a class="sourceLine" id="cb163-14" title="14">    <span class="kw">rep</span>(<span class="st">&quot;15&quot;</span>, <span class="kw">length</span>(A15)),</a>
<a class="sourceLine" id="cb163-15" title="15">    <span class="kw">rep</span>(<span class="st">&quot;30&quot;</span>, <span class="kw">length</span>(A30)),</a>
<a class="sourceLine" id="cb163-16" title="16">    <span class="kw">rep</span>(<span class="st">&quot;60&quot;</span>, <span class="kw">length</span>(A60)),</a>
<a class="sourceLine" id="cb163-17" title="17">    <span class="kw">rep</span>(<span class="st">&quot;120&quot;</span>, <span class="kw">length</span>(A120)),</a>
<a class="sourceLine" id="cb163-18" title="18">    <span class="kw">rep</span>(<span class="st">&quot;300&quot;</span>, <span class="kw">length</span>(A300))</a>
<a class="sourceLine" id="cb163-19" title="19">  )</a>
<a class="sourceLine" id="cb163-20" title="20">PRdata &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Anet, Aapp, Ccfull, Cifull, Delay))</a>
<a class="sourceLine" id="cb163-21" title="21"><span class="kw">write.csv</span>(PRdata, <span class="st">&quot;./data/PRdata.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="multi5" class="section level3">
<h3><span class="header-section-number">10.9.4</span> 光呼吸滞后性作图</h3>
<p>下面的代码是将光呼吸的数据进行作图。</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/PRdata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb164-2" title="2">data<span class="op">$</span>Ccfull &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb164-3" title="3">data<span class="op">$</span>Delay &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>Delay)</a>
<a class="sourceLine" id="cb164-4" title="4"></a>
<a class="sourceLine" id="cb164-5" title="5"><span class="co"># 净光合速率与Cc作图</span></a>
<a class="sourceLine" id="cb164-6" title="6">AnetCc &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Ccfull, <span class="dt">y =</span> Anet, <span class="dt">colour =</span> Delay)) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb164-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[c] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb164-9" title="9">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb164-10" title="10">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb164-11" title="11">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb164-12" title="12">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb164-13" title="13">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb164-14" title="14">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb164-15" title="15">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Delay (s)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-17" title="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb164-18" title="18">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-19" title="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-20" title="20"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-21" title="21"><span class="st">  </span><span class="co">#补偿点的参考线</span></a>
<a class="sourceLine" id="cb164-22" title="22"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb164-23" title="23"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb164-24" title="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb164-25" title="25">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb164-26" title="26">AnetCc</a></code></pre></div>
<div class="figure"><span id="fig:anetcc"></span>
<img src="bookdown_files/figure-html/anetcc-1.png" alt="Anet VS. Cc" width="672" />
<p class="caption">
图 10.4: Anet VS. Cc
</p>
</div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="co">#净光合速率与Ci作图</span></a>
<a class="sourceLine" id="cb165-2" title="2">AnetCi &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Cifull, <span class="dt">y =</span> Anet, <span class="dt">colour =</span> Delay)) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb165-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb165-5" title="5">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb165-6" title="6">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb165-7" title="7">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb165-8" title="8">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb165-9" title="9">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb165-10" title="10">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb165-11" title="11">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Delay (s)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb165-14" title="14">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-15" title="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-16" title="16"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-17" title="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb165-18" title="18"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb165-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb165-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb165-21" title="21">AnetCi</a></code></pre></div>
<div class="figure"><span id="fig:anetci"></span>
<img src="bookdown_files/figure-html/anetci-1.png" alt="Anet VS. Ci" width="672" />
<p class="caption">
图 10.5: Anet VS. Ci
</p>
</div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="co">#表观光合与Cc作图</span></a>
<a class="sourceLine" id="cb166-2" title="2">AappCc &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Ccfull, <span class="dt">y =</span> Aapp, <span class="dt">colour =</span> Delay)) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb166-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[c] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb166-5" title="5">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb166-6" title="6">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb166-7" title="7">  <span class="dt">y =</span> <span class="kw">expression</span>(A[apparent] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb166-8" title="8">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb166-9" title="9">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb166-10" title="10">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb166-11" title="11">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Delay (s)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">75</span>),</a>
<a class="sourceLine" id="cb166-14" title="14">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-15" title="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-16" title="16"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-17" title="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb166-18" title="18"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb166-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb166-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb166-21" title="21">AappCc</a></code></pre></div>
<div class="figure"><span id="fig:aappcc"></span>
<img src="bookdown_files/figure-html/aappcc-1.png" alt="Aapparent VS. Cc" width="672" />
<p class="caption">
图 10.6: Aapparent VS. Cc
</p>
</div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="co">#表观与Ci作图</span></a>
<a class="sourceLine" id="cb167-2" title="2">AappCi &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Cifull, <span class="dt">y =</span> Aapp, <span class="dt">colour =</span> Delay)) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb167-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb167-5" title="5">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb167-6" title="6">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb167-7" title="7">  <span class="dt">y =</span> <span class="kw">expression</span>(A[apparent] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb167-8" title="8">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb167-9" title="9">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb167-10" title="10">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb167-11" title="11">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Delay (s)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">75</span>),</a>
<a class="sourceLine" id="cb167-14" title="14">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-15" title="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-16" title="16"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-17" title="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb167-18" title="18"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb167-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb167-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb167-21" title="21">AappCi</a></code></pre></div>
<div class="figure"><span id="fig:aappci"></span>
<img src="bookdown_files/figure-html/aappci-1.png" alt="Aapparent VS. Ci" width="672" />
<p class="caption">
图 10.7: Aapparent VS. Ci
</p>
</div>
</div>
<div id="multi6" class="section level3">
<h3><span class="header-section-number">10.9.5</span> 补偿点计算</h3>
<p>计算不同的光呼吸时间延迟下的补偿点（基于Ci）：</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="co">#对于基于Ci的数据，仅采用ci&lt;100时的数据</span></a>
<a class="sourceLine" id="cb168-2" title="2">dataCi &lt;-<span class="st"> </span>data[data<span class="op">$</span>Cifull <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>,]</a>
<a class="sourceLine" id="cb168-3" title="3">dataCi0 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;0&quot;</span>,]</a>
<a class="sourceLine" id="cb168-4" title="4">dataCi15 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;15&quot;</span>,]</a>
<a class="sourceLine" id="cb168-5" title="5">dataCi30 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;30&quot;</span>,]</a>
<a class="sourceLine" id="cb168-6" title="6">dataCi60 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;60&quot;</span>,]</a>
<a class="sourceLine" id="cb168-7" title="7">dataCi120 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;120&quot;</span>,]</a>
<a class="sourceLine" id="cb168-8" title="8">dataCi300 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;300&quot;</span>,]</a>
<a class="sourceLine" id="cb168-9" title="9"></a>
<a class="sourceLine" id="cb168-10" title="10"><span class="co">#光呼吸无延迟时的计算，线性拟合</span></a>
<a class="sourceLine" id="cb168-11" title="11">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi0<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCi0<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb168-12" title="12"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi0$Anet ~ dataCi0$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13165 -0.04518  0.01711  0.05408  0.06699 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -7.2248105  0.0199353  -362.4   &lt;2e-16 ***
## dataCi0$Cifull  0.1228632  0.0003089   397.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06081 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.582e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="co">#补偿点为截距比斜率（纵坐标为零）</span></a>
<a class="sourceLine" id="cb170-2" title="2">Gamma0 &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb170-3" title="3"></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="co">#光呼吸延时15s</span></a>
<a class="sourceLine" id="cb170-5" title="5">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi15<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCi15<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb170-6" title="6"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi15$Anet ~ dataCi15$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13119 -0.04502  0.01705  0.05389  0.06676 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -7.0873326  0.0198665  -356.7   &lt;2e-16 ***
## dataCi15$Cifull  0.1225900  0.0003078   398.3   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0606 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.586e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1">Gamma15 &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb172-2" title="2"></a>
<a class="sourceLine" id="cb172-3" title="3"><span class="co">#光呼吸延时30s</span></a>
<a class="sourceLine" id="cb172-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi30<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCi30<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb172-5" title="5"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi30$Anet ~ dataCi30$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13076 -0.04488  0.01699  0.05372  0.06654 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -6.9553180  0.0198028  -351.2   &lt;2e-16 ***
## dataCi30$Cifull  0.1223321  0.0003068   398.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0604 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.59e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1">Gamma30 &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb174-2" title="2"></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="co">#光呼吸延时60s</span></a>
<a class="sourceLine" id="cb174-4" title="4">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi60<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCi60<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb174-5" title="5"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi60$Anet ~ dataCi60$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13001 -0.04462  0.01690  0.05341  0.06616 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -6.706429   0.019689  -340.6   &lt;2e-16 ***
## dataCi60$Cifull  0.121858   0.000305   399.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06006 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.596e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1">Gamma60 &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb176-2" title="2"></a>
<a class="sourceLine" id="cb176-3" title="3"><span class="co">#光呼吸延时120s</span></a>
<a class="sourceLine" id="cb176-4" title="4">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi120<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCi120<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb176-5" title="5"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi120$Anet ~ dataCi120$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.12879 -0.04421  0.01673  0.05292  0.06555 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -6.2616980  0.0195062  -321.0   &lt;2e-16 ***
## dataCi120$Cifull  0.1210486  0.0003022   400.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0595 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.604e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1">Gamma120 &lt;-<span class="st"> </span><span class="op">-</span>m5<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m5<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb178-2" title="2"></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="co">#光呼吸延时300s</span></a>
<a class="sourceLine" id="cb178-4" title="4">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi300<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCi300<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb178-5" title="5"><span class="kw">summary</span>(m6)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi300$Anet ~ dataCi300$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.12879 -0.04421  0.01673  0.05292  0.06555 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -6.2616980  0.0195062  -321.0   &lt;2e-16 ***
## dataCi300$Cifull  0.1210486  0.0003022   400.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0595 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.604e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1">Gamma300 &lt;-<span class="st"> </span><span class="op">-</span>m6<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m6<span class="op">$</span>coefficients[<span class="dv">2</span>]</a></code></pre></div>
<p>构造数据并作图</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">GammaCi &lt;-<span class="st"> </span><span class="kw">c</span>(Gamma0, Gamma15, Gamma30, Gamma60, Gamma120, Gamma300)</a>
<a class="sourceLine" id="cb181-2" title="2"></a>
<a class="sourceLine" id="cb181-3" title="3">ints &lt;-</a>
<a class="sourceLine" id="cb181-4" title="4"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb181-5" title="5">    m1<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb181-6" title="6">    m2<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb181-7" title="7">    m3<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb181-8" title="8">    m4<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb181-9" title="9">    m5<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb181-10" title="10">    m6<span class="op">$</span>coefficients[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb181-11" title="11">  )</a>
<a class="sourceLine" id="cb181-12" title="12">slps &lt;-</a>
<a class="sourceLine" id="cb181-13" title="13"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb181-14" title="14">    <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb181-15" title="15">    m2<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb181-16" title="16">    m3<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb181-17" title="17">    m4<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb181-18" title="18">    m5<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb181-19" title="19">    m6<span class="op">$</span>coefficients[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb181-20" title="20">  )</a>
<a class="sourceLine" id="cb181-21" title="21">dels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb181-22" title="22"><span class="kw">summary</span>(<span class="kw">lm</span>(ints <span class="op">~</span><span class="st"> </span>dels))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ints ~ dels)
## 
## Residuals:
##   (Intercept) (Intercept).1 (Intercept).2 (Intercept).3 (Intercept).4 
##      -0.20351      -0.11262      -0.02719       0.12853       0.38691 
## (Intercept).5 
##      -0.17212 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -7.0213001  0.1343090 -52.277 8.01e-07 ***
## dels         0.0031057  0.0009959   3.119   0.0356 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2503 on 4 degrees of freedom
## Multiple R-squared:  0.7086, Adjusted R-squared:  0.6357 
## F-statistic: 9.725 on 1 and 4 DF,  p-value: 0.03558</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1"><span class="kw">plot</span>(ints <span class="op">~</span><span class="st"> </span>dels)</a></code></pre></div>
<div class="figure"><span id="fig:intdelay"></span>
<img src="bookdown_files/figure-html/intdelay-1.png" alt="基于 Ci 的不同延时下的截距" width="672" />
<p class="caption">
图 10.8: 基于 Ci 的不同延时下的截距
</p>
</div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1"><span class="kw">plot</span>(slps <span class="op">~</span><span class="st"> </span>dels)</a></code></pre></div>
<div class="figure"><span id="fig:intslps"></span>
<img src="bookdown_files/figure-html/intslps-1.png" alt="基于 Ci 的不同延时下的斜率变化" width="672" />
<p class="caption">
图 10.9: 基于 Ci 的不同延时下的斜率变化
</p>
</div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(slps <span class="op">~</span><span class="st"> </span>dels <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = slps ~ dels - 1)
## 
## Residuals:
##                   dataCi15$Cifull  dataCi30$Cifull  dataCi60$Cifull 
##       -2.711e-19       -1.574e-04       -2.995e-04       -5.424e-04 
## dataCi120$Cifull dataCi300$Cifull 
##       -8.881e-04        5.015e-04 
## 
## Coefficients:
##       Estimate Std. Error t value Pr(&gt;|t|)   
## dels -7.72e-06   1.63e-06  -4.738  0.00516 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0005383 on 5 degrees of freedom
## Multiple R-squared:  0.8178, Adjusted R-squared:  0.7814 
## F-statistic: 22.44 on 1 and 5 DF,  p-value: 0.005161</code></pre>
<p>基于 Cc 的补偿点计算结果:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1"><span class="co"># 仅使用 Cc &lt; 75的数据点拟合，过程同ci</span></a>
<a class="sourceLine" id="cb187-2" title="2">dataCc &lt;-<span class="st"> </span>data[data<span class="op">$</span>Ccfull <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span>, ]</a>
<a class="sourceLine" id="cb187-3" title="3">dataCc0 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;0&quot;</span>, ]</a>
<a class="sourceLine" id="cb187-4" title="4">dataCc15 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;15&quot;</span>, ]</a>
<a class="sourceLine" id="cb187-5" title="5">dataCc30 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;30&quot;</span>, ]</a>
<a class="sourceLine" id="cb187-6" title="6">dataCc60 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;60&quot;</span>, ]</a>
<a class="sourceLine" id="cb187-7" title="7">dataCc120 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;120&quot;</span>, ]</a>
<a class="sourceLine" id="cb187-8" title="8">dataCc300 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;300&quot;</span>, ]</a>
<a class="sourceLine" id="cb187-9" title="9"></a>
<a class="sourceLine" id="cb187-10" title="10"><span class="co"># 无延迟数据</span></a>
<a class="sourceLine" id="cb187-11" title="11">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc0<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCc0<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb187-12" title="12"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc0$Anet ~ dataCc0$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075648 -0.025444  0.009857  0.031706  0.039431 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -8.4062011  0.0181852  -462.3   &lt;2e-16 ***
## dataCc0$Ccfull  0.1438710  0.0003527   407.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03599 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.664e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1">Gamma0 &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb189-2" title="2"></a>
<a class="sourceLine" id="cb189-3" title="3"><span class="co">#延时15s数据</span></a>
<a class="sourceLine" id="cb189-4" title="4">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc15<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCc15<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb189-5" title="5"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc15$Anet ~ dataCc15$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075393 -0.025359  0.009824  0.031599  0.039299 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -8.2659145  0.0181243  -456.1   &lt;2e-16 ***
## dataCc15$Ccfull  0.1435470  0.0003515   408.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03587 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.668e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1">Gamma15 &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb191-2" title="2"></a>
<a class="sourceLine" id="cb191-3" title="3"><span class="co">#延时30s数据</span></a>
<a class="sourceLine" id="cb191-4" title="4">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc30<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCc30<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb191-5" title="5"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc30$Anet ~ dataCc30$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075158 -0.025280  0.009794  0.031501  0.039177 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -8.1312578  0.0180681  -450.0   &lt;2e-16 ***
## dataCc30$Ccfull  0.1432414  0.0003504   408.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03576 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.671e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1">Gamma30 &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb193-2" title="2"></a>
<a class="sourceLine" id="cb193-3" title="3"><span class="co">#延时60s数据</span></a>
<a class="sourceLine" id="cb193-4" title="4">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc60<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCc60<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb193-5" title="5"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc60$Anet ~ dataCc60$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.074737 -0.025139  0.009739  0.031325  0.038959 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -7.8775340  0.0179675  -438.4   &lt;2e-16 ***
## dataCc60$Ccfull  0.1426797  0.0003485   409.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03556 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.676e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1">Gamma60 &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb195-2" title="2"></a>
<a class="sourceLine" id="cb195-3" title="3"><span class="co">#延时120s数据</span></a>
<a class="sourceLine" id="cb195-4" title="4">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc120<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCc120<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb195-5" title="5"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc120$Anet ~ dataCc120$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.074060 -0.024912  0.009651  0.031042  0.038607 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -7.4246412  0.0178052  -417.0   &lt;2e-16 ***
## dataCc120$Ccfull  0.1417238  0.0003453   410.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03524 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.684e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">Gamma120 &lt;-<span class="st"> </span><span class="op">-</span>m5<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m5<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb197-2" title="2"></a>
<a class="sourceLine" id="cb197-3" title="3"><span class="co">#延时300s数据</span></a>
<a class="sourceLine" id="cb197-4" title="4">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc300<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCc300<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb197-5" title="5"><span class="kw">summary</span>(m6)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc300$Anet ~ dataCc300$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.074060 -0.024912  0.009651  0.031042  0.038607 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -7.4246412  0.0178052  -417.0   &lt;2e-16 ***
## dataCc300$Ccfull  0.1417238  0.0003453   410.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03524 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.684e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1">Gamma300 &lt;-<span class="st"> </span><span class="op">-</span>m6<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m6<span class="op">$</span>coefficients[<span class="dv">2</span>]</a></code></pre></div>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1">GammaCc &lt;-<span class="st"> </span><span class="kw">c</span>(Gamma0, Gamma15, Gamma30, Gamma60, Gamma120, Gamma300)</a>
<a class="sourceLine" id="cb200-2" title="2"></a>
<a class="sourceLine" id="cb200-3" title="3">ints &lt;-</a>
<a class="sourceLine" id="cb200-4" title="4"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb200-5" title="5">    m1<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb200-6" title="6">    m2<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb200-7" title="7">    m3<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb200-8" title="8">    m4<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb200-9" title="9">    m5<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb200-10" title="10">    m6<span class="op">$</span>coefficients[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb200-11" title="11">  )</a>
<a class="sourceLine" id="cb200-12" title="12">dels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb200-13" title="13"><span class="kw">plot</span>(ints <span class="op">~</span><span class="st"> </span>dels)</a></code></pre></div>
<div class="figure"><span id="fig:intdelaycc"></span>
<img src="bookdown_files/figure-html/intdelaycc-1.png" alt="基于 Cc 的不同延时下的时间" width="672" />
<p class="caption">
图 10.10: 基于 Cc 的不同延时下的时间
</p>
</div>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(ints <span class="op">~</span><span class="st"> </span>dels))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ints ~ dels)
## 
## Residuals:
##   (Intercept) (Intercept).1 (Intercept).2 (Intercept).3 (Intercept).4 
##      -0.20760      -0.11478      -0.02759       0.13119       0.39421 
## (Intercept).5 
##      -0.17542 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -8.198602   0.136891 -59.891 4.65e-07 ***
## dels         0.003165   0.001015   3.118   0.0356 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2552 on 4 degrees of freedom
## Multiple R-squared:  0.7085, Adjusted R-squared:  0.6356 
## F-statistic:  9.72 on 1 and 4 DF,  p-value: 0.03561</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="co">#GammaStar</span></a>
<a class="sourceLine" id="cb203-2" title="2"><span class="co"># For Ci-based estimates, only use Ci &lt; 100</span></a>
<a class="sourceLine" id="cb203-3" title="3">dataCi &lt;-<span class="st"> </span>data[data<span class="op">$</span>Cifull <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>,]</a>
<a class="sourceLine" id="cb203-4" title="4">dataCi0 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;0&quot;</span>,]</a>
<a class="sourceLine" id="cb203-5" title="5">dataCi15 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;15&quot;</span>,]</a>
<a class="sourceLine" id="cb203-6" title="6">dataCi30 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;30&quot;</span>,]</a>
<a class="sourceLine" id="cb203-7" title="7">dataCi60 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;60&quot;</span>,]</a>
<a class="sourceLine" id="cb203-8" title="8">dataCi120 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;120&quot;</span>,]</a>
<a class="sourceLine" id="cb203-9" title="9">dataCi300 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;300&quot;</span>,]</a>
<a class="sourceLine" id="cb203-10" title="10">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi0<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCi0<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb203-11" title="11"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi0$Aapp ~ dataCi0$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13165 -0.04518  0.01711  0.05408  0.06699 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -5.2248105  0.0199353  -262.1   &lt;2e-16 ***
## dataCi0$Cifull  0.1228632  0.0003089   397.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06081 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.582e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1">Gamma0 &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb205-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi15<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCi15<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb205-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi15$Aapp ~ dataCi15$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13119 -0.04502  0.01705  0.05389  0.06676 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -5.0873326  0.0198665  -256.1   &lt;2e-16 ***
## dataCi15$Cifull  0.1225900  0.0003078   398.3   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0606 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.586e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">Gamma15 &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb207-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi30<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCi30<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb207-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi30$Aapp ~ dataCi30$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13076 -0.04488  0.01699  0.05372  0.06654 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -4.9553180  0.0198028  -250.2   &lt;2e-16 ***
## dataCi30$Cifull  0.1223321  0.0003068   398.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0604 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.59e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">Gamma30 &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb209-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi60<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCi60<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb209-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi60$Aapp ~ dataCi60$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13001 -0.04462  0.01690  0.05341  0.06616 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -4.706429   0.019689  -239.0   &lt;2e-16 ***
## dataCi60$Cifull  0.121858   0.000305   399.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06006 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.596e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">Gamma60 &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb211-2" title="2">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi120<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCi120<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb211-3" title="3"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi120$Aapp ~ dataCi120$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.12879 -0.04421  0.01673  0.05292  0.06555 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -4.2616980  0.0195062  -218.5   &lt;2e-16 ***
## dataCi120$Cifull  0.1210486  0.0003022   400.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0595 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.604e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">Gamma120 &lt;-<span class="st"> </span><span class="op">-</span>m5<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m5<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb213-2" title="2">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi300<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCi300<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb213-3" title="3"><span class="kw">summary</span>(m6)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi300$Aapp ~ dataCi300$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.12662 -0.04346  0.01645  0.05202  0.06444 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -3.2402030  0.0191773  -169.0   &lt;2e-16 ***
## dataCi300$Cifull  0.1193852  0.0002971   401.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.05849 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.615e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1">Gamma300 &lt;-<span class="st"> </span><span class="op">-</span>m6<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m6<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb215-2" title="2"></a>
<a class="sourceLine" id="cb215-3" title="3">GammastarCi &lt;-</a>
<a class="sourceLine" id="cb215-4" title="4"><span class="st">  </span><span class="kw">c</span>(Gamma0, Gamma15, Gamma30, Gamma60, Gamma120, Gamma300)</a>
<a class="sourceLine" id="cb215-5" title="5"></a>
<a class="sourceLine" id="cb215-6" title="6"><span class="co"># For Cc-based estimates, only use Cc &lt; 75</span></a>
<a class="sourceLine" id="cb215-7" title="7">dataCc &lt;-<span class="st"> </span>data[data<span class="op">$</span>Ccfull <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span>,]</a>
<a class="sourceLine" id="cb215-8" title="8">dataCc0 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;0&quot;</span>,]</a>
<a class="sourceLine" id="cb215-9" title="9">dataCc15 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;15&quot;</span>,]</a>
<a class="sourceLine" id="cb215-10" title="10">dataCc30 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;30&quot;</span>,]</a>
<a class="sourceLine" id="cb215-11" title="11">dataCc60 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;60&quot;</span>,]</a>
<a class="sourceLine" id="cb215-12" title="12">dataCc120 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;120&quot;</span>,]</a>
<a class="sourceLine" id="cb215-13" title="13">dataCc300 &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Delay <span class="op">==</span><span class="st"> &quot;300&quot;</span>,]</a>
<a class="sourceLine" id="cb215-14" title="14">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc0<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCc0<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb215-15" title="15"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc0$Aapp ~ dataCc0$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075648 -0.025444  0.009857  0.031706  0.039431 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -6.4062011  0.0181852  -352.3   &lt;2e-16 ***
## dataCc0$Ccfull  0.1438710  0.0003527   407.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03599 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.664e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">Gamma0 &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb217-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc15<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCc15<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb217-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc15$Aapp ~ dataCc15$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075393 -0.025359  0.009824  0.031599  0.039299 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -6.2659145  0.0181243  -345.7   &lt;2e-16 ***
## dataCc15$Ccfull  0.1435470  0.0003515   408.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03587 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.668e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1">Gamma15 &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb219-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc30<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCc30<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb219-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc30$Aapp ~ dataCc30$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075158 -0.025280  0.009794  0.031501  0.039177 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -6.1312578  0.0180681  -339.3   &lt;2e-16 ***
## dataCc30$Ccfull  0.1432414  0.0003504   408.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03576 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.671e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">Gamma30 &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb221-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc60<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCc60<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb221-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc60$Aapp ~ dataCc60$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.074737 -0.025139  0.009739  0.031325  0.038959 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -5.8775340  0.0179675  -327.1   &lt;2e-16 ***
## dataCc60$Ccfull  0.1426797  0.0003485   409.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03556 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.676e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1">Gamma60 &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb223-2" title="2">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc120<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCc120<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb223-3" title="3"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc120$Aapp ~ dataCc120$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.074060 -0.024912  0.009651  0.031042  0.038607 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -5.4246412  0.0178052  -304.7   &lt;2e-16 ***
## dataCc120$Ccfull  0.1417238  0.0003453   410.4   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03524 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.684e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1">Gamma120 &lt;-<span class="st"> </span><span class="op">-</span>m5<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m5<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb225-2" title="2">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCc300<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCc300<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb225-3" title="3"><span class="kw">summary</span>(m6)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCc300$Aapp ~ dataCc300$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.072835 -0.024500  0.009492  0.030529  0.037969 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -4.3867121  0.0175110  -250.5   &lt;2e-16 ***
## dataCc300$Ccfull  0.1397661  0.0003396   411.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03466 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.694e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" title="1">Gamma300 &lt;-<span class="st"> </span><span class="op">-</span>m6<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m6<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb227-2" title="2"></a>
<a class="sourceLine" id="cb227-3" title="3">GammastarCc &lt;-</a>
<a class="sourceLine" id="cb227-4" title="4"><span class="st">  </span><span class="kw">c</span>(Gamma0, Gamma15, Gamma30, Gamma60, Gamma120, Gamma300)</a>
<a class="sourceLine" id="cb227-5" title="5"></a>
<a class="sourceLine" id="cb227-6" title="6">Delay2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;120&quot;</span>, <span class="st">&quot;300&quot;</span>)</a>
<a class="sourceLine" id="cb227-7" title="7">PRcomps &lt;-</a>
<a class="sourceLine" id="cb227-8" title="8"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Delay2, GammaCc, GammaCi, GammastarCc, GammastarCi))</a>
<a class="sourceLine" id="cb227-9" title="9"><span class="kw">write.csv</span>(PRcomps, <span class="st">&quot;./data/PRcomps.csv&quot;</span>)</a>
<a class="sourceLine" id="cb227-10" title="10"></a>
<a class="sourceLine" id="cb227-11" title="11">ints &lt;-</a>
<a class="sourceLine" id="cb227-12" title="12"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb227-13" title="13">    m1<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb227-14" title="14">    m2<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb227-15" title="15">    m3<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb227-16" title="16">    m4<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb227-17" title="17">    m5<span class="op">$</span>coefficients[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb227-18" title="18">    m6<span class="op">$</span>coefficients[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb227-19" title="19">  )</a>
<a class="sourceLine" id="cb227-20" title="20">dels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">120</span>, <span class="dv">300</span>)</a>
<a class="sourceLine" id="cb227-21" title="21"><span class="kw">summary</span>(<span class="kw">lm</span>(ints <span class="op">~</span><span class="st"> </span>dels))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = ints ~ dels)
## 
## Residuals:
##   (Intercept) (Intercept).1 (Intercept).2 (Intercept).3 (Intercept).4 
##    -0.0751633    -0.0347043     0.0001247     0.0541933     0.1077758 
## (Intercept).5 
##    -0.0522262 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -6.331038   0.041673 -151.92 1.13e-08 ***
## dels         0.006655   0.000309   21.54 2.75e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07768 on 4 degrees of freedom
## Multiple R-squared:  0.9915, Adjusted R-squared:  0.9893 
## F-statistic: 463.9 on 1 and 4 DF,  p-value: 2.749e-05</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" title="1"><span class="kw">plot</span>(ints <span class="op">~</span><span class="st"> </span>dels)</a></code></pre></div>
<div class="figure"><span id="fig:slpdelaycc"></span>
<img src="bookdown_files/figure-html/slpdelaycc-1.png" alt="基于 Cc 的不同延时下的截距" width="672" />
<p class="caption">
图 10.11: 基于 Cc 的不同延时下的截距
</p>
</div>
</div>
<div id="multi7" class="section level3">
<h3><span class="header-section-number">10.9.6</span> 无光呼吸酶失活模块</h3>
<p>该部分内容是在测量 ACi 曲线时检测 Rubisco 失活的影响 – 从激活状态的变化导致了多少的偏移？</p>
<div id="multi8" class="section level4">
<h4><span class="header-section-number">10.9.6.1</span> 数据构造</h4>
<p>基于文献，假定 <span class="math inline">\(CO_2\)</span> 从 400 ppm 降低至 5 ppm 时，激活率从 100% 降低至 80%。</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="co">#Assume that Rubisco activation state drops from 100% at 400 ppm to 80% at 5 ppm Cr (line 273 is Cr of 400, Cc of 297; 5ppm Cr is 25 ppm Cc) roughly from Salvucci et al 1986, arabidopsis; assume linear response</span></a>
<a class="sourceLine" id="cb230-2" title="2"></a>
<a class="sourceLine" id="cb230-3" title="3"><span class="co">#不同的cr对应了不同的cc浓度，</span></a>
<a class="sourceLine" id="cb230-4" title="4"><span class="co">#此为cc的变化范围（cr从400降低至5）</span></a>
<a class="sourceLine" id="cb230-5" title="5">ccslope &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">297</span>)</a>
<a class="sourceLine" id="cb230-6" title="6"><span class="co">#酶的激活率变化</span></a>
<a class="sourceLine" id="cb230-7" title="7">raslope &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.80</span>, <span class="fl">1.00</span>)</a>
<a class="sourceLine" id="cb230-8" title="8"><span class="co">#得到cc变化对应rubisco激活率变化的关系</span></a>
<a class="sourceLine" id="cb230-9" title="9">ram1 &lt;-<span class="st"> </span><span class="kw">lm</span>(raslope <span class="op">~</span><span class="st"> </span>ccslope)</a>
<a class="sourceLine" id="cb230-10" title="10">raslope &lt;-<span class="st"> </span><span class="kw">coef</span>(ram1)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb230-11" title="11">raint &lt;-<span class="st"> </span><span class="kw">coef</span>(ram1)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb230-12" title="12"></a>
<a class="sourceLine" id="cb230-13" title="13"><span class="co">#根据公式计算酶部分失活后各个参数</span></a>
<a class="sourceLine" id="cb230-14" title="14">vora1 &lt;-<span class="st"> </span>(raslope <span class="op">*</span><span class="st"> </span>Cc <span class="op">+</span><span class="st"> </span>raint) <span class="op">*</span><span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc <span class="op">/</span><span class="st"> </span>Kc))</a>
<a class="sourceLine" id="cb230-15" title="15">vcra1 &lt;-<span class="st"> </span>(raslope <span class="op">*</span><span class="st"> </span>Cc <span class="op">+</span><span class="st"> </span>raint) <span class="op">*</span><span class="st"> </span>Vcmax <span class="op">*</span><span class="st"> </span>(Cc) <span class="op">/</span><span class="st"> </span>(Cc <span class="op">+</span><span class="st"> </span>Kco)</a>
<a class="sourceLine" id="cb230-16" title="16">Ara1 &lt;-<span class="st"> </span>vcra1 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vora1 <span class="op">-</span><span class="st"> </span>R</a>
<a class="sourceLine" id="cb230-17" title="17">Aapparentra1 &lt;-<span class="st"> </span>vcra1 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vora1</a>
<a class="sourceLine" id="cb230-18" title="18">Cira1 &lt;-<span class="st"> </span>Ara1 <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc</a>
<a class="sourceLine" id="cb230-19" title="19">Cbra1 &lt;-<span class="st"> </span>Ara1 <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Cira1</a>
<a class="sourceLine" id="cb230-20" title="20">Crra1 &lt;-<span class="st"> </span>Ara1 <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cbra1</a>
<a class="sourceLine" id="cb230-21" title="21"></a>
<a class="sourceLine" id="cb230-22" title="22"><span class="co">#失活后换算为分钟的变化斜率</span></a>
<a class="sourceLine" id="cb230-23" title="23">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb230-24" title="24">RateCr1model &lt;-<span class="st"> </span><span class="kw">lm</span>(Crra1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-25" title="25">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCr1model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb230-26" title="26">RateCb1model &lt;-<span class="st"> </span><span class="kw">lm</span>(Cbra1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-27" title="27">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCb1model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb230-28" title="28">RateCi1model &lt;-<span class="st"> </span><span class="kw">lm</span>(Cira1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-29" title="29">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCi1model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb230-30" title="30">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-31" title="31">RateCc &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span></a>
<a class="sourceLine" id="cb230-32" title="32"></a>
<a class="sourceLine" id="cb230-33" title="33"><span class="co">#假定在5ppm时下降为40%</span></a>
<a class="sourceLine" id="cb230-34" title="34">ccslope2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">297</span>)</a>
<a class="sourceLine" id="cb230-35" title="35">raslope2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.40</span>, <span class="fl">1.00</span>)</a>
<a class="sourceLine" id="cb230-36" title="36">ram2 &lt;-<span class="st"> </span><span class="kw">lm</span>(raslope2 <span class="op">~</span><span class="st"> </span>ccslope2)</a>
<a class="sourceLine" id="cb230-37" title="37">raslope2 &lt;-<span class="st"> </span><span class="kw">coef</span>(ram2)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb230-38" title="38">raint2 &lt;-<span class="st"> </span><span class="kw">coef</span>(ram2)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb230-39" title="39"></a>
<a class="sourceLine" id="cb230-40" title="40">vora2 &lt;-</a>
<a class="sourceLine" id="cb230-41" title="41"><span class="st">  </span>(raslope2 <span class="op">*</span><span class="st"> </span>Cc <span class="op">+</span><span class="st"> </span>raint2) <span class="op">*</span><span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb230-42" title="42">vcra2 &lt;-<span class="st"> </span>(raslope2 <span class="op">*</span><span class="st"> </span>Cc <span class="op">+</span><span class="st"> </span>raint2) <span class="op">*</span><span class="st"> </span>Vcmax <span class="op">*</span><span class="st"> </span>(Cc) <span class="op">/</span><span class="st"> </span>(Cc <span class="op">+</span><span class="st"> </span>Kco) </a>
<a class="sourceLine" id="cb230-43" title="43">Ara2 &lt;-<span class="st"> </span>vcra2 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vora2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb230-44" title="44">Aapparentra2 &lt;-<span class="st"> </span>vcra2 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vora2 </a>
<a class="sourceLine" id="cb230-45" title="45">Cira2 &lt;-<span class="st"> </span>Ara2 <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb230-46" title="46">Cbra2 &lt;-<span class="st"> </span>Ara2 <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Cira2 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb230-47" title="47">Crra2 &lt;-<span class="st"> </span>Ara2 <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cbra2 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb230-48" title="48">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb230-49" title="49">RateCr2model &lt;-<span class="st"> </span><span class="kw">lm</span>(Crra2 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-50" title="50">RateCr2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCr2model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb230-51" title="51">RateCb2model &lt;-<span class="st"> </span><span class="kw">lm</span>(Cbra2 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-52" title="52">RateCb2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCb2model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb230-53" title="53">RateCi2model &lt;-<span class="st"> </span><span class="kw">lm</span>(Cira2 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-54" title="54">RateCi2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCi2model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb230-55" title="55">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-56" title="56">RateCc &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb230-57" title="57"></a>
<a class="sourceLine" id="cb230-58" title="58"><span class="co">#假定在5ppm时下降为20%</span></a>
<a class="sourceLine" id="cb230-59" title="59">ccslope3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">297</span>)</a>
<a class="sourceLine" id="cb230-60" title="60">raslope3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.20</span>, <span class="fl">1.00</span>)</a>
<a class="sourceLine" id="cb230-61" title="61">ram3 &lt;-<span class="st"> </span><span class="kw">lm</span>(raslope3 <span class="op">~</span><span class="st"> </span>ccslope3)</a>
<a class="sourceLine" id="cb230-62" title="62">raslope3 &lt;-<span class="st"> </span><span class="kw">coef</span>(ram3)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb230-63" title="63">raint3 &lt;-<span class="st"> </span><span class="kw">coef</span>(ram3)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb230-64" title="64"></a>
<a class="sourceLine" id="cb230-65" title="65">vora3 &lt;-</a>
<a class="sourceLine" id="cb230-66" title="66"><span class="st">  </span>(raslope3 <span class="op">*</span><span class="st"> </span>Cc <span class="op">+</span><span class="st"> </span>raint3) <span class="op">*</span><span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb230-67" title="67">vcra3 &lt;-<span class="st"> </span>(raslope3 <span class="op">*</span><span class="st"> </span>Cc <span class="op">+</span><span class="st"> </span>raint3) <span class="op">*</span><span class="st"> </span>Vcmax <span class="op">*</span><span class="st"> </span>(Cc) <span class="op">/</span><span class="st"> </span>(Cc <span class="op">+</span><span class="st"> </span>Kco) </a>
<a class="sourceLine" id="cb230-68" title="68">Ara3 &lt;-<span class="st"> </span>vcra3 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vora3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb230-69" title="69">Aapparentra3 &lt;-<span class="st"> </span>vcra3 <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vora3 </a>
<a class="sourceLine" id="cb230-70" title="70">Cira3 &lt;-<span class="st"> </span>Ara3 <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc </a>
<a class="sourceLine" id="cb230-71" title="71">Cbra3 &lt;-<span class="st"> </span>Ara3 <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Cira3 </a>
<a class="sourceLine" id="cb230-72" title="72">Crra3 &lt;-<span class="st"> </span>Ara3 <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cbra3 </a>
<a class="sourceLine" id="cb230-73" title="73">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb230-74" title="74">RateCr3model &lt;-<span class="st"> </span><span class="kw">lm</span>(Crra3 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-75" title="75">RateCr3 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCr3model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> </a>
<a class="sourceLine" id="cb230-76" title="76">RateCb3model &lt;-<span class="st"> </span><span class="kw">lm</span>(Cbra3 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-77" title="77">RateCb3 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCb3model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> </a>
<a class="sourceLine" id="cb230-78" title="78">RateCi3model &lt;-<span class="st"> </span><span class="kw">lm</span>(Cira3 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-79" title="79">RateCi3 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCi3model)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> </a>
<a class="sourceLine" id="cb230-80" title="80">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb230-81" title="81">RateCc &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> </a>
<a class="sourceLine" id="cb230-82" title="82"></a>
<a class="sourceLine" id="cb230-83" title="83">Anet &lt;-<span class="st"> </span><span class="kw">c</span>(A, Ara1, Ara2, Ara3)</a>
<a class="sourceLine" id="cb230-84" title="84">Aapp &lt;-<span class="st"> </span><span class="kw">c</span>(Aapparent, Aapparentra1, Aapparentra2, Aapparentra3)</a>
<a class="sourceLine" id="cb230-85" title="85">Ccfull &lt;-<span class="st"> </span><span class="kw">rep</span>(Cc, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb230-86" title="86">Cifull &lt;-<span class="st"> </span><span class="kw">c</span>(Ci, Cira1, Cira2, Cira3)</a>
<a class="sourceLine" id="cb230-87" title="87">Deactivation &lt;-</a>
<a class="sourceLine" id="cb230-88" title="88"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb230-89" title="89">    <span class="kw">rep</span>(<span class="st">&quot;None&quot;</span>, <span class="kw">length</span>(A)),</a>
<a class="sourceLine" id="cb230-90" title="90">    <span class="kw">rep</span>(<span class="st">&quot;Low&quot;</span>, <span class="kw">length</span>(Ara1)),</a>
<a class="sourceLine" id="cb230-91" title="91">    <span class="kw">rep</span>(<span class="st">&quot;Medium&quot;</span>, <span class="kw">length</span>(Ara2)),</a>
<a class="sourceLine" id="cb230-92" title="92">    <span class="kw">rep</span>(<span class="st">&quot;High&quot;</span>, <span class="kw">length</span>(Ara3))</a>
<a class="sourceLine" id="cb230-93" title="93">  )</a>
<a class="sourceLine" id="cb230-94" title="94">RASdata &lt;-</a>
<a class="sourceLine" id="cb230-95" title="95"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Anet, Aapp, Ccfull, Cifull, Deactivation))</a>
<a class="sourceLine" id="cb230-96" title="96"><span class="kw">write.csv</span>(RASdata, <span class="st">&quot;./data/RASdata.csv&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="multi9" class="section level3">
<h3><span class="header-section-number">10.9.7</span> 酶失活作图</h3>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/RASdata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb231-2" title="2">data<span class="op">$</span>Ccfull &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb231-3" title="3">data<span class="op">$</span>Deactivation &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>Deactivation)</a>
<a class="sourceLine" id="cb231-4" title="4"></a>
<a class="sourceLine" id="cb231-5" title="5">AnetCc &lt;-</a>
<a class="sourceLine" id="cb231-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Ccfull, <span class="dt">y =</span> Anet, <span class="dt">colour =</span> Deactivation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-7" title="7"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb231-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[c] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb231-9" title="9">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb231-10" title="10">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb231-11" title="11">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb231-12" title="12">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb231-13" title="13">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb231-14" title="14">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb231-15" title="15">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Deactivation&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-17" title="17"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb231-18" title="18">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-19" title="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-20" title="20"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-21" title="21"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb231-22" title="22"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb231-23" title="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb231-24" title="24">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb231-25" title="25">AnetCc</a></code></pre></div>
<div class="figure"><span id="fig:anetdeccc"></span>
<img src="bookdown_files/figure-html/anetdeccc-1.png" alt="Rubisco 不同失活程度时 Anet VS Cc" width="672" />
<p class="caption">
图 10.12: Rubisco 不同失活程度时 Anet VS Cc
</p>
</div>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">AnetCi &lt;-</a>
<a class="sourceLine" id="cb232-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Cifull, <span class="dt">y =</span> Anet, <span class="dt">colour =</span> Deactivation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb232-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb232-5" title="5">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb232-6" title="6">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb232-7" title="7">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb232-8" title="8">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb232-9" title="9">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb232-10" title="10">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb232-11" title="11">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Deactivation&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb232-14" title="14">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-15" title="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-16" title="16"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-17" title="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb232-18" title="18"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb232-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb232-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb232-21" title="21">AnetCi</a></code></pre></div>
<div class="figure"><span id="fig:anetdecci"></span>
<img src="bookdown_files/figure-html/anetdecci-1.png" alt="Rubisco 不同失活程度时 Anet VS Ci" width="672" />
<p class="caption">
图 10.13: Rubisco 不同失活程度时 Anet VS Ci
</p>
</div>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1">AappCc &lt;-</a>
<a class="sourceLine" id="cb233-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Ccfull, <span class="dt">y =</span> Aapp, <span class="dt">colour =</span> Deactivation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb233-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[c] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb233-5" title="5">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb233-6" title="6">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb233-7" title="7">  <span class="dt">y =</span> <span class="kw">expression</span>(A[apparent] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb233-8" title="8">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb233-9" title="9">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb233-10" title="10">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb233-11" title="11">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Deactivation&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">75</span>),</a>
<a class="sourceLine" id="cb233-14" title="14">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-15" title="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-16" title="16"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-17" title="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb233-18" title="18"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb233-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb233-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb233-21" title="21">AappCc</a></code></pre></div>
<div class="figure"><span id="fig:aappdeccc"></span>
<img src="bookdown_files/figure-html/aappdeccc-1.png" alt="Rubisco 不同失活程度时 Aapp VS Cc" width="672" />
<p class="caption">
图 10.14: Rubisco 不同失活程度时 Aapp VS Cc
</p>
</div>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1">AappCi &lt;-</a>
<a class="sourceLine" id="cb234-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Cifull, <span class="dt">y =</span> Aapp, <span class="dt">colour =</span> Deactivation)) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb234-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb234-5" title="5">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb234-6" title="6">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb234-7" title="7">  <span class="dt">y =</span> <span class="kw">expression</span>(A[apparent] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb234-8" title="8">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb234-9" title="9">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb234-10" title="10">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb234-11" title="11">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Deactivation&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-13" title="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">75</span>),</a>
<a class="sourceLine" id="cb234-14" title="14">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-15" title="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-16" title="16"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-17" title="17"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb234-18" title="18"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb234-19" title="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb234-20" title="20">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb234-21" title="21">AappCi</a></code></pre></div>
<div class="figure"><span id="fig:aappdecci"></span>
<img src="bookdown_files/figure-html/aappdecci-1.png" alt="Rubisco 不同失活程度时 Aapp VS Ci" width="672" />
<p class="caption">
图 10.15: Rubisco 不同失活程度时 Aapp VS Ci
</p>
</div>
</div>
<div id="multi10" class="section level3">
<h3><span class="header-section-number">10.9.8</span> 不同失活程度下补偿点计算</h3>
<p>此部分内容同未失活状态相似，不在额外介绍，可参考 <a href="#gammastar"><strong>??</strong></a> 内容。</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" title="1"><span class="co">#Gamma</span></a>
<a class="sourceLine" id="cb235-2" title="2"><span class="co"># For Ci-based estimates, only use Ci &lt; 100</span></a>
<a class="sourceLine" id="cb235-3" title="3">dataCi &lt;-<span class="st"> </span>data[data<span class="op">$</span>Cifull <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, ]</a>
<a class="sourceLine" id="cb235-4" title="4">dataCinone &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;None&quot;</span>, ]</a>
<a class="sourceLine" id="cb235-5" title="5">dataCilow &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Low&quot;</span>, ]</a>
<a class="sourceLine" id="cb235-6" title="6">dataCimedium &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Medium&quot;</span>, ]</a>
<a class="sourceLine" id="cb235-7" title="7">dataCihigh &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;High&quot;</span>, ]</a>
<a class="sourceLine" id="cb235-8" title="8">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCinone<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCinone<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb235-9" title="9"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCinone$Anet ~ dataCinone$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13165 -0.04518  0.01711  0.05408  0.06699 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -7.2248105  0.0199353  -362.4   &lt;2e-16 ***
## dataCinone$Cifull  0.1228632  0.0003089   397.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06081 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.582e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" title="1">Gammanone &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb237-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCilow<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCilow<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb237-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCilow$Anet ~ dataCilow$Cifull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.034896 -0.011957  0.004499  0.014311  0.017726 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -6.444e+00  5.343e-03   -1206   &lt;2e-16 ***
## dataCilow$Cifull  1.049e-01  8.341e-05    1258   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01609 on 69 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.582e+06 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" title="1">Gammalow &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb239-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCimedium<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCimedium<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb239-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCimedium$Anet ~ dataCimedium$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.09168 -0.07338 -0.02281  0.05893  0.18150 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -4.8015337  0.0277371  -173.1   &lt;2e-16 ***
## dataCimedium$Cifull  0.0671064  0.0004311   155.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0832 on 71 degrees of freedom
## Multiple R-squared:  0.9971, Adjusted R-squared:  0.997 
## F-statistic: 2.423e+04 on 1 and 71 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1">Gammamedium &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb241-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCihigh<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCihigh<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb241-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCihigh$Anet ~ dataCihigh$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.15430 -0.12508 -0.03863  0.10156  0.30621 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -3.9450658  0.0467537  -84.38   &lt;2e-16 ***
## dataCihigh$Cifull  0.0473551  0.0007255   65.27   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1399 on 72 degrees of freedom
## Multiple R-squared:  0.9834, Adjusted R-squared:  0.9831 
## F-statistic:  4260 on 1 and 72 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" title="1">Gammahigh &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb243-2" title="2"></a>
<a class="sourceLine" id="cb243-3" title="3">GammaCi &lt;-<span class="st"> </span><span class="kw">c</span>(Gammanone, Gammalow, Gammamedium, Gammahigh)</a>
<a class="sourceLine" id="cb243-4" title="4"></a>
<a class="sourceLine" id="cb243-5" title="5"><span class="co"># For Cc-based estimates, only use Cc &lt; 75</span></a>
<a class="sourceLine" id="cb243-6" title="6">dataCc &lt;-<span class="st"> </span>data[data<span class="op">$</span>Ccfull <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span>, ]</a>
<a class="sourceLine" id="cb243-7" title="7">dataCcnone &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;None&quot;</span>, ]</a>
<a class="sourceLine" id="cb243-8" title="8">dataCclow &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Low&quot;</span>, ]</a>
<a class="sourceLine" id="cb243-9" title="9">dataCcmedium &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Medium&quot;</span>, ]</a>
<a class="sourceLine" id="cb243-10" title="10">dataCchigh &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;High&quot;</span>, ]</a>
<a class="sourceLine" id="cb243-11" title="11">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCcnone<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCcnone<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb243-12" title="12"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCcnone$Anet ~ dataCcnone$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075648 -0.025444  0.009857  0.031706  0.039431 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -8.4062011  0.0181852  -462.3   &lt;2e-16 ***
## dataCcnone$Ccfull  0.1438710  0.0003527   407.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03599 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.664e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" title="1">Gammanone &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb245-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCclow<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCclow<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb245-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCclow$Anet ~ dataCclow$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.019617 -0.006598  0.002556  0.008222  0.010225 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -7.243e+00  4.716e-03   -1536   &lt;2e-16 ***
## dataCclow$Ccfull  1.182e-01  9.146e-05    1292   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.009333 on 48 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.67e+06 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" title="1">Gammalow &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb247-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCcmedium<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCcmedium<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb247-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCcmedium$Anet ~ dataCcmedium$Ccfull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.04819 -0.03875 -0.01205  0.03109  0.09244 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -4.917283   0.022223  -221.3   &lt;2e-16 ***
## dataCcmedium$Ccfull  0.066832   0.000431   155.1   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04398 on 48 degrees of freedom
## Multiple R-squared:  0.998,  Adjusted R-squared:  0.998 
## F-statistic: 2.404e+04 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1">Gammamedium &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb249-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCchigh<span class="op">$</span>Anet <span class="op">~</span><span class="st"> </span>dataCchigh<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb249-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCchigh$Anet ~ dataCchigh$Ccfull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.07739 -0.06223 -0.01935  0.04994  0.14847 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -3.7543099  0.0356922 -105.19   &lt;2e-16 ***
## dataCchigh$Ccfull  0.0411528  0.0006922   59.45   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07064 on 48 degrees of freedom
## Multiple R-squared:  0.9866, Adjusted R-squared:  0.9863 
## F-statistic:  3534 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" title="1">Gammahigh &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb251-2" title="2"></a>
<a class="sourceLine" id="cb251-3" title="3">GammaCc &lt;-<span class="st"> </span><span class="kw">c</span>(Gammanone, Gammalow, Gammamedium, Gammahigh)</a>
<a class="sourceLine" id="cb251-4" title="4"></a>
<a class="sourceLine" id="cb251-5" title="5"><span class="co">#GammaStar</span></a>
<a class="sourceLine" id="cb251-6" title="6"><span class="co"># For Ci-based estimates, only use Ci &lt; 100</span></a>
<a class="sourceLine" id="cb251-7" title="7">dataCi &lt;-<span class="st"> </span>data[data<span class="op">$</span>Cifull <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, ]</a>
<a class="sourceLine" id="cb251-8" title="8">dataCinone &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;None&quot;</span>, ]</a>
<a class="sourceLine" id="cb251-9" title="9">dataCilow &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Low&quot;</span>, ]</a>
<a class="sourceLine" id="cb251-10" title="10">dataCimedium &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Medium&quot;</span>, ]</a>
<a class="sourceLine" id="cb251-11" title="11">dataCihigh &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;High&quot;</span>, ]</a>
<a class="sourceLine" id="cb251-12" title="12">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCinone<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCinone<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb251-13" title="13"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCinone$Aapp ~ dataCinone$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13165 -0.04518  0.01711  0.05408  0.06699 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -5.2248105  0.0199353  -262.1   &lt;2e-16 ***
## dataCinone$Cifull  0.1228632  0.0003089   397.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06081 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.582e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1">Gammastarnone &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb253-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCilow<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCilow<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb253-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCilow$Aapp ~ dataCilow$Cifull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.034896 -0.011957  0.004499  0.014311  0.017726 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -4.444e+00  5.343e-03  -831.7   &lt;2e-16 ***
## dataCilow$Cifull  1.049e-01  8.341e-05  1257.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01609 on 69 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.582e+06 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1">Gammastarlow &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb255-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCimedium<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCimedium<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb255-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCimedium$Aapp ~ dataCimedium$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.09168 -0.07338 -0.02281  0.05893  0.18150 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -2.8015337  0.0277371  -101.0   &lt;2e-16 ***
## dataCimedium$Cifull  0.0671064  0.0004311   155.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0832 on 71 degrees of freedom
## Multiple R-squared:  0.9971, Adjusted R-squared:  0.997 
## F-statistic: 2.423e+04 on 1 and 71 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1">Gammastarmedium &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb257-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCihigh<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCihigh<span class="op">$</span>Cifull)</a>
<a class="sourceLine" id="cb257-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCihigh$Aapp ~ dataCihigh$Cifull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.15430 -0.12508 -0.03863  0.10156  0.30621 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -1.9450658  0.0467537  -41.60   &lt;2e-16 ***
## dataCihigh$Cifull  0.0473551  0.0007255   65.27   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1399 on 72 degrees of freedom
## Multiple R-squared:  0.9834, Adjusted R-squared:  0.9831 
## F-statistic:  4260 on 1 and 72 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1">Gammastarhigh &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb259-2" title="2"></a>
<a class="sourceLine" id="cb259-3" title="3">GammastarCi &lt;-</a>
<a class="sourceLine" id="cb259-4" title="4"><span class="st">  </span><span class="kw">c</span>(Gammastarnone, Gammastarlow, Gammastarmedium, Gammastarhigh)</a>
<a class="sourceLine" id="cb259-5" title="5"></a>
<a class="sourceLine" id="cb259-6" title="6"><span class="co"># For Cc-based estimates, only use Cc &lt; 75</span></a>
<a class="sourceLine" id="cb259-7" title="7">dataCc &lt;-<span class="st"> </span>data[data<span class="op">$</span>Ccfull <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span>, ]</a>
<a class="sourceLine" id="cb259-8" title="8">dataCcnone &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;None&quot;</span>, ]</a>
<a class="sourceLine" id="cb259-9" title="9">dataCclow &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Low&quot;</span>, ]</a>
<a class="sourceLine" id="cb259-10" title="10">dataCcmedium &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;Medium&quot;</span>, ]</a>
<a class="sourceLine" id="cb259-11" title="11">dataCchigh &lt;-<span class="st"> </span>dataCc[dataCc<span class="op">$</span>Deactivation <span class="op">==</span><span class="st"> &quot;High&quot;</span>, ]</a>
<a class="sourceLine" id="cb259-12" title="12">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCcnone<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCcnone<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb259-13" title="13"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCcnone$Aapp ~ dataCcnone$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.075648 -0.025444  0.009857  0.031706  0.039431 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -6.4062011  0.0181852  -352.3   &lt;2e-16 ***
## dataCcnone$Ccfull  0.1438710  0.0003527   407.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03599 on 48 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.664e+05 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1">Gammastarnone &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb261-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCclow<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCclow<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb261-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCclow$Aapp ~ dataCclow$Ccfull)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.019617 -0.006598  0.002556  0.008222  0.010225 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      -5.243e+00  4.716e-03   -1112   &lt;2e-16 ***
## dataCclow$Ccfull  1.182e-01  9.146e-05    1292   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.009333 on 48 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.67e+06 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1">Gammastarlow &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb263-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCcmedium<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCcmedium<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb263-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCcmedium$Aapp ~ dataCcmedium$Ccfull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.04819 -0.03875 -0.01205  0.03109  0.09244 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -2.917283   0.022223  -131.3   &lt;2e-16 ***
## dataCcmedium$Ccfull  0.066832   0.000431   155.1   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04398 on 48 degrees of freedom
## Multiple R-squared:  0.998,  Adjusted R-squared:  0.998 
## F-statistic: 2.404e+04 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1">Gammastarmedium &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb265-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCchigh<span class="op">$</span>Aapp <span class="op">~</span><span class="st"> </span>dataCchigh<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb265-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCchigh$Aapp ~ dataCchigh$Ccfull)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.07739 -0.06223 -0.01935  0.04994  0.14847 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -1.7543099  0.0356922  -49.15   &lt;2e-16 ***
## dataCchigh$Ccfull  0.0411528  0.0006922   59.45   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07064 on 48 degrees of freedom
## Multiple R-squared:  0.9866, Adjusted R-squared:  0.9863 
## F-statistic:  3534 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1">Gammastarhigh &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb267-2" title="2"></a>
<a class="sourceLine" id="cb267-3" title="3">GammastarCc &lt;-</a>
<a class="sourceLine" id="cb267-4" title="4"><span class="st">  </span><span class="kw">c</span>(Gammastarnone, Gammastarlow, Gammastarmedium, Gammastarhigh)</a>
<a class="sourceLine" id="cb267-5" title="5"></a>
<a class="sourceLine" id="cb267-6" title="6">Deactivation2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb267-7" title="7">RAScomps &lt;-</a>
<a class="sourceLine" id="cb267-8" title="8"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Deactivation2, GammaCc, GammaCi, GammastarCc, GammastarCi))</a>
<a class="sourceLine" id="cb267-9" title="9"><span class="kw">write.csv</span>(RAScomps, <span class="st">&quot;./data/RAScomps.csv&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="multi11" class="section level2">
<h2><span class="header-section-number">10.10</span> 时间延迟的扩散限制</h2>
<p>对于扩散限制，下面的内容比较了多速率 RACiR 和标准 ACi 曲线的差别，比较实在有光呼吸和没有光呼吸的两种情况。对于没有扩散限制的表观光合速，采用了已知质量的碱石灰药品，放置于 1.7 ml 的微量离心管内，然后将其置于荧光叶室内部模拟叶片，此时叶室环境控制与其他实验不同，此时不再控制 H2OR。RACiR 测试从 500 到 0 的变化，不同样品的测量是随机的。</p>
<p>下面内容采用了一定的假设，来计算扩散的时间。</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1"><span class="co">#Equations from Campbell &amp; Norman, 1998</span></a>
<a class="sourceLine" id="cb268-2" title="2"><span class="co">#We are taking a simple approach to calculating diffusion times.</span></a>
<a class="sourceLine" id="cb268-3" title="3"><span class="co">#Here we make the simplifying assumption that diffusion is pure, planar</span></a>
<a class="sourceLine" id="cb268-4" title="4"><span class="co">#Diffusion, such that:</span></a>
<a class="sourceLine" id="cb268-5" title="5"><span class="co">#gtot = phat * D / deltaZ</span></a>
<a class="sourceLine" id="cb268-6" title="6"><span class="co">#where gtot is total conductance, phat is molar density of air in mol /m^3,</span></a>
<a class="sourceLine" id="cb268-7" title="7"><span class="co">#D is diffusion coefficient in m2/s, deltaZ is pathlength in m</span></a>
<a class="sourceLine" id="cb268-8" title="8"><span class="co">#Since PV = NRT, N/V = P/RT</span></a>
<a class="sourceLine" id="cb268-9" title="9"><span class="co">#T in K, R in J K-1 mol-1, P in Pa</span></a>
<a class="sourceLine" id="cb268-10" title="10"></a>
<a class="sourceLine" id="cb268-11" title="11"><span class="co">#phat = Patm/(RT)</span></a>
<a class="sourceLine" id="cb268-12" title="12">phat =<span class="st"> </span><span class="dv">100000</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">8.314</span> <span class="op">*</span><span class="st"> </span><span class="fl">298.15</span>)</a>
<a class="sourceLine" id="cb268-13" title="13"></a>
<a class="sourceLine" id="cb268-14" title="14"><span class="co">#We also assume a linear pathlength</span></a>
<a class="sourceLine" id="cb268-15" title="15"><span class="co">#Note, if diffusion is nonlinear or nonplanar, it will affect the value determined</span></a>
<a class="sourceLine" id="cb268-16" title="16"><span class="co">#for D from this equation.</span></a>
<a class="sourceLine" id="cb268-17" title="17"></a>
<a class="sourceLine" id="cb268-18" title="18"><span class="co">#D = gtot * deltaZ / phat</span></a>
<a class="sourceLine" id="cb268-19" title="19"></a>
<a class="sourceLine" id="cb268-20" title="20"><span class="co">#Diffusion time, t, varies with D and deltaZ such that:</span></a>
<a class="sourceLine" id="cb268-21" title="21"></a>
<a class="sourceLine" id="cb268-22" title="22"><span class="co">#t = (deltaZ)^2 / D</span></a>
<a class="sourceLine" id="cb268-23" title="23"></a>
<a class="sourceLine" id="cb268-24" title="24"><span class="co">#So</span></a>
<a class="sourceLine" id="cb268-25" title="25"></a>
<a class="sourceLine" id="cb268-26" title="26"><span class="co">#t = (deltaZ)^2 / (gtot * deltaZ / phat)</span></a>
<a class="sourceLine" id="cb268-27" title="27"></a>
<a class="sourceLine" id="cb268-28" title="28"><span class="co">#If we assume mean diffusion pathlength of 1/2 lamina thickness,</span></a>
<a class="sourceLine" id="cb268-29" title="29"><span class="co">#then Onoda et al. 2011 lamina thicknesses of: median 0.22 mm (0.11 to 0.74 for 95% CI)</span></a>
<a class="sourceLine" id="cb268-30" title="30"><span class="co">#becomes 0.11 mm (0.055 to 0.37) for estimated deltaZ</span></a>
<a class="sourceLine" id="cb268-31" title="31"></a>
<a class="sourceLine" id="cb268-32" title="32"><span class="co">#Convert pathlength to m</span></a>
<a class="sourceLine" id="cb268-33" title="33">dZlow &lt;-<span class="st"> </span><span class="fl">0.055</span> <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb268-34" title="34">dZmedian &lt;-<span class="st"> </span><span class="fl">0.11</span> <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb268-35" title="35">dZhigh &lt;-<span class="st"> </span><span class="fl">0.37</span> <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></a></code></pre></div>
<p>下面的内容是对边界层导度和气孔导度等赋值，由此而计算出其他所需要的参数：</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1"><span class="co">#Mesophyll Conductance</span></a>
<a class="sourceLine" id="cb269-2" title="2">BLC &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-3" title="3">gsw &lt;-<span class="st"> </span><span class="fl">0.4</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-4" title="4"></a>
<a class="sourceLine" id="cb269-5" title="5"><span class="co"># 无限制的叶肉导度，并以此计算ci等</span></a>
<a class="sourceLine" id="cb269-6" title="6">gm1 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-7" title="7">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm1 <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-8" title="8">Cim1 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-9" title="9">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-10" title="10">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-11" title="11"><span class="co">#根据斜率计算达到 100 ppm min-1 时记录数据的个数</span></a>
<a class="sourceLine" id="cb269-12" title="12">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-13" title="13">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-14" title="14">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] </a>
<a class="sourceLine" id="cb269-15" title="15">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-16" title="16"><span class="co">#计算ci，Cc等达到100ppm min-1 时数据的个数</span></a>
<a class="sourceLine" id="cb269-17" title="17">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-18" title="18">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-19" title="19">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-20" title="20">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-21" title="21">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-22" title="22">RateCc1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-23" title="23"><span class="co">#总的阻力</span></a>
<a class="sourceLine" id="cb269-24" title="24">res1 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-25" title="25"></a>
<a class="sourceLine" id="cb269-26" title="26"><span class="co">#不同的叶肉导度计算其他参数</span></a>
<a class="sourceLine" id="cb269-27" title="27">gm2 &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-28" title="28">Ci2 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm2 <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-29" title="29">Cim2 &lt;-<span class="st"> </span>Ci2</a>
<a class="sourceLine" id="cb269-30" title="30">Cb2 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci2 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-31" title="31">Cr2 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb2 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-32" title="32">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-33" title="33">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr2 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-34" title="34">x2 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] </a>
<a class="sourceLine" id="cb269-35" title="35">RateCr2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x2 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-36" title="36">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb2 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-37" title="37">RateCb2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x2 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-38" title="38">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci2 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-39" title="39">RateCi2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x2 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-40" title="40">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-41" title="41">RateCc2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x2 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-42" title="42">res2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm2 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-43" title="43"></a>
<a class="sourceLine" id="cb269-44" title="44"><span class="co">#再次计算不同导度下的数值</span></a>
<a class="sourceLine" id="cb269-45" title="45">gm4 &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-46" title="46">Ci4 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm4 <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-47" title="47">Cim4 &lt;-<span class="st"> </span>Ci4</a>
<a class="sourceLine" id="cb269-48" title="48">Cb4 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci4 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-49" title="49">Cr4 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb4 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-50" title="50">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-51" title="51">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr4 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-52" title="52">x4 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-53" title="53">RateCr4 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x4 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-54" title="54">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb4 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-55" title="55">RateCb4 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x4 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-56" title="56">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci4 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-57" title="57">RateCi4 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x4 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-58" title="58">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-59" title="59">RateCc4 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x4 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-60" title="60">res4 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm4 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-61" title="61"></a>
<a class="sourceLine" id="cb269-62" title="62"><span class="co">#再次计算不同导度下的数值</span></a>
<a class="sourceLine" id="cb269-63" title="63">gm05 &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-64" title="64">Ci05 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm05 <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-65" title="65">Cim05 &lt;-<span class="st"> </span>Ci05</a>
<a class="sourceLine" id="cb269-66" title="66">Cb05 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci05 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-67" title="67">Cr05 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb05 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-68" title="68">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-69" title="69">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr05 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-70" title="70">x05 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-71" title="71">RateCr05 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x05 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-72" title="72">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb05 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-73" title="73">RateCb05 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x05 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-74" title="74">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci05 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-75" title="75">RateCi05 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x05 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-76" title="76">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-77" title="77">RateCc05 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x05 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-78" title="78">res05 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm05 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-79" title="79"></a>
<a class="sourceLine" id="cb269-80" title="80"><span class="co">#正常的叶肉导度数据计算其他参数</span></a>
<a class="sourceLine" id="cb269-81" title="81">gm025 &lt;-<span class="st"> </span><span class="fl">0.25</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-82" title="82">Ci025 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm025 <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-83" title="83">Cim025 &lt;-<span class="st"> </span>Ci025</a>
<a class="sourceLine" id="cb269-84" title="84">Cb025 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci025 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-85" title="85">Cr025 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb025 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-86" title="86">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-87" title="87">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr025 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-88" title="88">x025 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-89" title="89">RateCr025 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x025 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-90" title="90">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb025 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-91" title="91">RateCb025 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x025 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-92" title="92">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci025 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-93" title="93">RateCi025 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x025 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-94" title="94">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-95" title="95">RateCc025 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x025 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-96" title="96">res025 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm025 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-97" title="97"></a>
<a class="sourceLine" id="cb269-98" title="98"><span class="co">#另一个正常的叶肉导度</span></a>
<a class="sourceLine" id="cb269-99" title="99">gm0125 &lt;-<span class="st"> </span><span class="fl">0.125</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-100" title="100">Ci0125 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm0125 <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-101" title="101">Cim0125 &lt;-<span class="st"> </span>Ci0125</a>
<a class="sourceLine" id="cb269-102" title="102">Cb0125 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci0125 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-103" title="103">Cr0125 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb0125 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-104" title="104">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-105" title="105">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr0125 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-106" title="106">x0125 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-107" title="107">RateCr0125 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x0125 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-108" title="108">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb0125 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-109" title="109">RateCb0125 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x0125 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-110" title="110">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci0125 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-111" title="111">RateCi0125 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x0125 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-112" title="112">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-113" title="113">RateCc0125 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x0125 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-114" title="114">res0125 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm0125 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-115" title="115"></a>
<a class="sourceLine" id="cb269-116" title="116"><span class="co">#利用不同叶肉导度的数据计算结果构造数据</span></a>
<a class="sourceLine" id="cb269-117" title="117">Ratesgm &lt;-</a>
<a class="sourceLine" id="cb269-118" title="118"><span class="st">  </span><span class="kw">c</span>(RateCc0125, RateCc025, RateCc05, RateCc1, RateCc2, RateCc4)</a>
<a class="sourceLine" id="cb269-119" title="119">gmval &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb269-120" title="120">totalresgm &lt;-<span class="st"> </span><span class="kw">c</span>(res0125, res025, res05, res1, res2, res4)</a>
<a class="sourceLine" id="cb269-121" title="121">resistance &lt;-</a>
<a class="sourceLine" id="cb269-122" title="122"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb269-123" title="123">    <span class="kw">rep</span>(res0125, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-124" title="124">    <span class="kw">rep</span>(res025, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-125" title="125">    <span class="kw">rep</span>(res05, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-126" title="126">    <span class="kw">rep</span>(res1, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-127" title="127">    <span class="kw">rep</span>(res2, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-128" title="128">    <span class="kw">rep</span>(res4, <span class="dv">376</span>)</a>
<a class="sourceLine" id="cb269-129" title="129">  )</a>
<a class="sourceLine" id="cb269-130" title="130"></a>
<a class="sourceLine" id="cb269-131" title="131"><span class="co">#其余部分与上面类似</span></a>
<a class="sourceLine" id="cb269-132" title="132"><span class="co">#此时采用不同的气孔导度构建数据</span></a>
<a class="sourceLine" id="cb269-133" title="133">BLC &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-134" title="134">gm &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-135" title="135"></a>
<a class="sourceLine" id="cb269-136" title="136">gsw &lt;-<span class="st"> </span><span class="fl">0.4</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-137" title="137">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-138" title="138">Cis04 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-139" title="139">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-140" title="140">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-141" title="141">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-142" title="142">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-143" title="143">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] </a>
<a class="sourceLine" id="cb269-144" title="144">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-145" title="145">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-146" title="146">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-147" title="147">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-148" title="148">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-149" title="149">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-150" title="150">RateCc04 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-151" title="151">res04 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-152" title="152"></a>
<a class="sourceLine" id="cb269-153" title="153">gsw &lt;-<span class="st"> </span><span class="fl">0.2</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-154" title="154">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-155" title="155">Cis02 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-156" title="156">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-157" title="157">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-158" title="158">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-159" title="159">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-160" title="160">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-161" title="161">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-162" title="162">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-163" title="163">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-164" title="164">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-165" title="165">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-166" title="166">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-167" title="167">RateCc02 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-168" title="168">res02 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-169" title="169"></a>
<a class="sourceLine" id="cb269-170" title="170">gsw &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-171" title="171">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-172" title="172">Cis01 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-173" title="173">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-174" title="174">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-175" title="175">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-176" title="176">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-177" title="177">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-178" title="178">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-179" title="179">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-180" title="180">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-181" title="181">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-182" title="182">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-183" title="183">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-184" title="184">RateCc01 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-185" title="185">res01 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-186" title="186"></a>
<a class="sourceLine" id="cb269-187" title="187">gsw &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-188" title="188">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-189" title="189">Cis05 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-190" title="190">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-191" title="191">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-192" title="192">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-193" title="193">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-194" title="194">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-195" title="195">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-196" title="196">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-197" title="197">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-198" title="198">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-199" title="199">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-200" title="200">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-201" title="201">RateCc005 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-202" title="202">res005 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-203" title="203"></a>
<a class="sourceLine" id="cb269-204" title="204">gsw &lt;-<span class="st"> </span><span class="fl">0.025</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-205" title="205">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-206" title="206">Cis0025 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-207" title="207">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-208" title="208">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-209" title="209">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-210" title="210">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-211" title="211">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-212" title="212">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-213" title="213">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-214" title="214">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-215" title="215">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-216" title="216">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-217" title="217">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-218" title="218">RateCc0025 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-219" title="219">res0025 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-220" title="220"></a>
<a class="sourceLine" id="cb269-221" title="221">Ratesgsw &lt;-<span class="st"> </span><span class="kw">c</span>(RateCc0025, RateCc005, RateCc01, RateCc02, RateCc04)</a>
<a class="sourceLine" id="cb269-222" title="222">gswvals &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb269-223" title="223">totalresgsw &lt;-<span class="st"> </span><span class="kw">c</span>(res0025, res005, res01, res02, res04)</a>
<a class="sourceLine" id="cb269-224" title="224"></a>
<a class="sourceLine" id="cb269-225" title="225"><span class="co"># 下面的代码是采用不同的边界层导度</span></a>
<a class="sourceLine" id="cb269-226" title="226"><span class="co"># 含义与上面代码相似</span></a>
<a class="sourceLine" id="cb269-227" title="227">gm &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-228" title="228">gsw &lt;-<span class="st"> </span><span class="fl">0.4</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-229" title="229"></a>
<a class="sourceLine" id="cb269-230" title="230">BLC &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-231" title="231"></a>
<a class="sourceLine" id="cb269-232" title="232">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-233" title="233">Cib2 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-234" title="234">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-235" title="235">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-236" title="236">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-237" title="237">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-238" title="238">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-239" title="239">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-240" title="240">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-241" title="241">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-242" title="242">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-243" title="243">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-244" title="244">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-245" title="245">RateCc2 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-246" title="246">res2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-247" title="247"></a>
<a class="sourceLine" id="cb269-248" title="248">BLC &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-249" title="249"></a>
<a class="sourceLine" id="cb269-250" title="250">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-251" title="251">Cib4 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-252" title="252">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-253" title="253">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-254" title="254">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-255" title="255">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-256" title="256">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-257" title="257">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-258" title="258">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-259" title="259">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-260" title="260">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-261" title="261">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-262" title="262">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-263" title="263">RateCc4 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-264" title="264">res4 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-265" title="265"></a>
<a class="sourceLine" id="cb269-266" title="266">BLC &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-267" title="267"></a>
<a class="sourceLine" id="cb269-268" title="268">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-269" title="269">Cib1 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-270" title="270">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-271" title="271">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-272" title="272">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-273" title="273">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-274" title="274">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-275" title="275">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-276" title="276">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-277" title="277">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-278" title="278">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-279" title="279">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-280" title="280">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-281" title="281">RateCc1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-282" title="282">res1 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-283" title="283"></a>
<a class="sourceLine" id="cb269-284" title="284">BLC &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-285" title="285"></a>
<a class="sourceLine" id="cb269-286" title="286">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-287" title="287">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-288" title="288">Cib05 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-289" title="289">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-290" title="290">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-291" title="291">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-292" title="292">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-293" title="293">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-294" title="294">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-295" title="295">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-296" title="296">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-297" title="297">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-298" title="298">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-299" title="299">RateCc05 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-300" title="300">res05 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-301" title="301"></a>
<a class="sourceLine" id="cb269-302" title="302">BLC &lt;-<span class="st"> </span><span class="fl">0.25</span> <span class="co">#mol m-2 s-1</span></a>
<a class="sourceLine" id="cb269-303" title="303"></a>
<a class="sourceLine" id="cb269-304" title="304">Ci1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span>Cc <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-305" title="305">Cb1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>gsw <span class="op">+</span><span class="st"> </span>Ci1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-306" title="306">Cib025 &lt;-<span class="st"> </span>Ci1</a>
<a class="sourceLine" id="cb269-307" title="307">Cr1 &lt;-<span class="st"> </span>A <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span>Cb1 <span class="co">#umol mol-1</span></a>
<a class="sourceLine" id="cb269-308" title="308">Counter &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Cc)))</a>
<a class="sourceLine" id="cb269-309" title="309">RateCrmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cr1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-310" title="310">x1 &lt;-<span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb269-311" title="311">RateCr1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCrmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-312" title="312">RateCbmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cb1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-313" title="313">RateCb1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCbmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-314" title="314">RateCimodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Ci1 <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-315" title="315">RateCi1 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCimodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-316" title="316">RateCcmodel &lt;-<span class="st"> </span><span class="kw">lm</span>(Cc <span class="op">~</span><span class="st"> </span>Counter)</a>
<a class="sourceLine" id="cb269-317" title="317">RateCc025 &lt;-<span class="st"> </span><span class="kw">coef</span>(RateCcmodel)[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x1 <span class="co">#umol mol-1 min-1</span></a>
<a class="sourceLine" id="cb269-318" title="318">res025 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gm <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>BLC <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>gsw</a>
<a class="sourceLine" id="cb269-319" title="319"></a>
<a class="sourceLine" id="cb269-320" title="320">BLCRates &lt;-<span class="st"> </span><span class="kw">c</span>(RateCc025, RateCc05, RateCc1, RateCc2, RateCc4)</a>
<a class="sourceLine" id="cb269-321" title="321">BLCvals &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb269-322" title="322">totalresBLC &lt;-<span class="st"> </span><span class="kw">c</span>(res025, res05, res1, res2, res4)</a>
<a class="sourceLine" id="cb269-323" title="323"></a>
<a class="sourceLine" id="cb269-324" title="324">Scenario &lt;-</a>
<a class="sourceLine" id="cb269-325" title="325"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb269-326" title="326">    <span class="kw">rep</span>(<span class="st">&quot;Boundary Layer Conductance&quot;</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb269-327" title="327">    <span class="kw">rep</span>(<span class="st">&quot;Stomatal Conductance&quot;</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb269-328" title="328">    <span class="kw">rep</span>(<span class="st">&quot;Mesophyll Conductance&quot;</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb269-329" title="329">  )</a>
<a class="sourceLine" id="cb269-330" title="330">Rates &lt;-<span class="st"> </span><span class="kw">c</span>(BLCRates, Ratesgsw, Ratesgm)</a>
<a class="sourceLine" id="cb269-331" title="331">Conductances &lt;-<span class="st"> </span><span class="kw">c</span>(BLCvals, gswvals, gmval)</a>
<a class="sourceLine" id="cb269-332" title="332">TotalRes &lt;-<span class="st"> </span><span class="kw">c</span>(totalresBLC, totalresgsw, totalresgm)</a>
<a class="sourceLine" id="cb269-333" title="333"></a>
<a class="sourceLine" id="cb269-334" title="334">Cidiffusion &lt;-<span class="st"> </span><span class="kw">c</span>(Cim0125, Cim025, Cim05, Cim1, Cim2, Cim4)</a>
<a class="sourceLine" id="cb269-335" title="335">Adiffusion &lt;-<span class="st"> </span><span class="kw">rep</span>(A, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb269-336" title="336">Aappdiffusion &lt;-<span class="st"> </span><span class="kw">rep</span>(Aapparent, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb269-337" title="337">variable &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Mesophyll Conductance&quot;</span>, <span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(Cim1)))</a>
<a class="sourceLine" id="cb269-338" title="338">conductance &lt;-</a>
<a class="sourceLine" id="cb269-339" title="339"><span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="fl">0.125</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-340" title="340">    <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-341" title="341">    <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-342" title="342">    <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-343" title="343">    <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb269-344" title="344">    <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">376</span>))</a>
<a class="sourceLine" id="cb269-345" title="345"></a>
<a class="sourceLine" id="cb269-346" title="346"></a>
<a class="sourceLine" id="cb269-347" title="347">Diffusionplot &lt;-</a>
<a class="sourceLine" id="cb269-348" title="348"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb269-349" title="349">    Cidiffusion,</a>
<a class="sourceLine" id="cb269-350" title="350">    Adiffusion,</a>
<a class="sourceLine" id="cb269-351" title="351">    Aappdiffusion,</a>
<a class="sourceLine" id="cb269-352" title="352">    variable,</a>
<a class="sourceLine" id="cb269-353" title="353">    conductance,</a>
<a class="sourceLine" id="cb269-354" title="354">    resistance</a>
<a class="sourceLine" id="cb269-355" title="355">  ))</a>
<a class="sourceLine" id="cb269-356" title="356"><span class="kw">write.csv</span>(Diffusionplot, <span class="st">&quot;./data/DiffusionLimitsACI.csv&quot;</span>)</a>
<a class="sourceLine" id="cb269-357" title="357"></a>
<a class="sourceLine" id="cb269-358" title="358">Diffusion &lt;-</a>
<a class="sourceLine" id="cb269-359" title="359"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(Scenario, Rates, Conductances, TotalRes))</a>
<a class="sourceLine" id="cb269-360" title="360"><span class="kw">write.csv</span>(Diffusion, <span class="st">&quot;./data/DiffusionLimits.csv&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(Diffusion))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Scenario</th>
<th align="left">Rates</th>
<th align="left">Conductances</th>
<th align="left">TotalRes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Counter</td>
<td align="left">Boundary Layer Conductance</td>
<td align="left">57.1493939574751</td>
<td align="left">0.25</td>
<td align="left">7.5</td>
</tr>
<tr class="even">
<td>Counter.1</td>
<td align="left">Boundary Layer Conductance</td>
<td align="left">64.522239461912</td>
<td align="left">0.5</td>
<td align="left">5.5</td>
</tr>
<tr class="odd">
<td>Counter.2</td>
<td align="left">Boundary Layer Conductance</td>
<td align="left">68.9712299728077</td>
<td align="left">1</td>
<td align="left">4.5</td>
</tr>
<tr class="even">
<td>Counter.3</td>
<td align="left">Boundary Layer Conductance</td>
<td align="left">71.4340185663793</td>
<td align="left">2</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td>Counter.4</td>
<td align="left">Boundary Layer Conductance</td>
<td align="left">72.7325667866589</td>
<td align="left">4</td>
<td align="left">3.75</td>
</tr>
<tr class="even">
<td>Counter.5</td>
<td align="left">Stomatal Conductance</td>
<td align="left">19.4216526694884</td>
<td align="left">0.025</td>
<td align="left">41.5</td>
</tr>
</tbody>
</table>
<div id="multi12" class="section level3">
<h3><span class="header-section-number">10.10.1</span> 扩散限制滞后性</h3>
<p>下面的代码，是根据上面代码的计算结果，结合最初的扩散时间的公式，来计算出各个参数的最大最小值，中间值，构造数据：</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">gtot1 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>res1</a>
<a class="sourceLine" id="cb271-2" title="2">t1low =<span class="st"> </span>(dZlow) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot1 <span class="op">*</span><span class="st"> </span>dZlow <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-3" title="3">t1median =<span class="st"> </span>(dZmedian) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot1 <span class="op">*</span><span class="st"> </span>dZmedian <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-4" title="4">t1high =<span class="st"> </span>(dZhigh) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot1 <span class="op">*</span><span class="st"> </span>dZhigh <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-5" title="5">Cc1low &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t1low <span class="op">*</span><span class="st"> </span>RateCc1))</a>
<a class="sourceLine" id="cb271-6" title="6">Cc1median &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t1median <span class="op">*</span><span class="st"> </span>RateCc1))</a>
<a class="sourceLine" id="cb271-7" title="7">Cc1high &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t1high <span class="op">*</span><span class="st"> </span>RateCc1))</a>
<a class="sourceLine" id="cb271-8" title="8">vo1low &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc1low <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-9" title="9">A1low &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo1low <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-10" title="10">vo1median &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc1median <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-11" title="11">A1median &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo1median <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-12" title="12">vo1high &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc1high <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-13" title="13">A1high &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo1high <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-14" title="14"></a>
<a class="sourceLine" id="cb271-15" title="15">gtot0125 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>res0125</a>
<a class="sourceLine" id="cb271-16" title="16">t0125low =<span class="st"> </span>(dZlow) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot0125 <span class="op">*</span><span class="st"> </span>dZlow <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-17" title="17">t0125median =<span class="st"> </span>(dZmedian) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot0125 <span class="op">*</span><span class="st"> </span>dZmedian <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-18" title="18">t0125high =<span class="st"> </span>(dZhigh) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot0125 <span class="op">*</span><span class="st"> </span>dZhigh <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-19" title="19">Cc0125low &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t0125low <span class="op">*</span><span class="st"> </span>RateCc0125))</a>
<a class="sourceLine" id="cb271-20" title="20">Cc0125median &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t0125median <span class="op">*</span><span class="st"> </span>RateCc0125))</a>
<a class="sourceLine" id="cb271-21" title="21">Cc0125high &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t0125high <span class="op">*</span><span class="st"> </span>RateCc0125))</a>
<a class="sourceLine" id="cb271-22" title="22">vo0125low &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc0125low <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-23" title="23">A0125low &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo0125low <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-24" title="24">vo0125median &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc0125median <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-25" title="25">A0125median &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo0125median <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-26" title="26">vo0125high &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc0125high <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-27" title="27">A0125high &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo0125high <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-28" title="28"></a>
<a class="sourceLine" id="cb271-29" title="29">gtot025 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>res025</a>
<a class="sourceLine" id="cb271-30" title="30">t025low =<span class="st"> </span>(dZlow) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot025 <span class="op">*</span><span class="st"> </span>dZlow <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-31" title="31">t025median =<span class="st"> </span>(dZmedian) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot025 <span class="op">*</span><span class="st"> </span>dZmedian <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-32" title="32">t025high =<span class="st"> </span>(dZhigh) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot025 <span class="op">*</span><span class="st"> </span>dZhigh <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-33" title="33">Cc025low &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t025low <span class="op">*</span><span class="st"> </span>RateCc025))</a>
<a class="sourceLine" id="cb271-34" title="34">Cc025median &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t025median <span class="op">*</span><span class="st"> </span>RateCc025))</a>
<a class="sourceLine" id="cb271-35" title="35">Cc025high &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t025high <span class="op">*</span><span class="st"> </span>RateCc025))</a>
<a class="sourceLine" id="cb271-36" title="36">vo025low &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc025low <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-37" title="37">A025low &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo025low <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-38" title="38">vo025median &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc025median <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-39" title="39">A025median &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo025median <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-40" title="40">vo025high &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc025high <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-41" title="41">A025high &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo025high <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-42" title="42"></a>
<a class="sourceLine" id="cb271-43" title="43">gtot05 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>res05</a>
<a class="sourceLine" id="cb271-44" title="44">t05low =<span class="st"> </span>(dZlow) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot05 <span class="op">*</span><span class="st"> </span>dZlow <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-45" title="45">t05median =<span class="st"> </span>(dZmedian) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot05 <span class="op">*</span><span class="st"> </span>dZmedian <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-46" title="46">t05high =<span class="st"> </span>(dZhigh) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot05 <span class="op">*</span><span class="st"> </span>dZhigh <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-47" title="47">Cc05low &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t05low <span class="op">*</span><span class="st"> </span>RateCc05))</a>
<a class="sourceLine" id="cb271-48" title="48">Cc05median &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t05median <span class="op">*</span><span class="st"> </span>RateCc05))</a>
<a class="sourceLine" id="cb271-49" title="49">Cc05high &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t05high <span class="op">*</span><span class="st"> </span>RateCc05))</a>
<a class="sourceLine" id="cb271-50" title="50">vo05low &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc05low <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-51" title="51">A05low &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo05low <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-52" title="52">vo05median &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc05median <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-53" title="53">A05median &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo05median <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-54" title="54">vo05high &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc05high <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-55" title="55">A05high &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo05high <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-56" title="56"></a>
<a class="sourceLine" id="cb271-57" title="57">gtot2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>res2</a>
<a class="sourceLine" id="cb271-58" title="58">t2low =<span class="st"> </span>(dZlow) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot2 <span class="op">*</span><span class="st"> </span>dZlow <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-59" title="59">t2median =<span class="st"> </span>(dZmedian) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot2 <span class="op">*</span><span class="st"> </span>dZmedian <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-60" title="60">t2high =<span class="st"> </span>(dZhigh) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot2 <span class="op">*</span><span class="st"> </span>dZhigh <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-61" title="61">Cc2low &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t2low <span class="op">*</span><span class="st"> </span>RateCc2))</a>
<a class="sourceLine" id="cb271-62" title="62">Cc2median &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t2median <span class="op">*</span><span class="st"> </span>RateCc2))</a>
<a class="sourceLine" id="cb271-63" title="63">Cc2high &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t2high <span class="op">*</span><span class="st"> </span>RateCc2))</a>
<a class="sourceLine" id="cb271-64" title="64">vo2low &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc2low <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-65" title="65">A2low &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo2low <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-66" title="66">vo2median &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc2median <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-67" title="67">A2median &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo2median <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-68" title="68">vo2high &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc2high <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-69" title="69">A2high &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo2high <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-70" title="70"></a>
<a class="sourceLine" id="cb271-71" title="71">gtot4 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>res4</a>
<a class="sourceLine" id="cb271-72" title="72">t4low =<span class="st"> </span>(dZlow) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot4 <span class="op">*</span><span class="st"> </span>dZlow <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-73" title="73">t4median =<span class="st"> </span>(dZmedian) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot4 <span class="op">*</span><span class="st"> </span>dZmedian <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-74" title="74">t4high =<span class="st"> </span>(dZhigh) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(gtot4 <span class="op">*</span><span class="st"> </span>dZhigh <span class="op">/</span><span class="st"> </span>phat)</a>
<a class="sourceLine" id="cb271-75" title="75">Cc4low &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t4low <span class="op">*</span><span class="st"> </span>RateCc4))</a>
<a class="sourceLine" id="cb271-76" title="76">Cc4median &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t4median <span class="op">*</span><span class="st"> </span>RateCc4))</a>
<a class="sourceLine" id="cb271-77" title="77">Cc4high &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t4high <span class="op">*</span><span class="st"> </span>RateCc4))</a>
<a class="sourceLine" id="cb271-78" title="78">vo4low &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc4low <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-79" title="79">A4low &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo4low <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-80" title="80">vo4median &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc4median <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-81" title="81">A4median &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo4median <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-82" title="82">vo4high &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc4high <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-83" title="83">A4high &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo4high <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-84" title="84"></a>
<a class="sourceLine" id="cb271-85" title="85">Cc0125high2 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t0125high <span class="op">*</span><span class="st"> </span>RateCc0125 <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb271-86" title="86">Cc025high2 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t025high <span class="op">*</span><span class="st"> </span>RateCc025 <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb271-87" title="87">Cc05high2 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t05high <span class="op">*</span><span class="st"> </span>RateCc05 <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb271-88" title="88">Cc1high2 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t1high <span class="op">*</span><span class="st"> </span>RateCc1 <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb271-89" title="89">Cc2high2 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t2high <span class="op">*</span><span class="st"> </span>RateCc2 <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb271-90" title="90">Cc4high2 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t4high <span class="op">*</span><span class="st"> </span>RateCc4 <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb271-91" title="91"></a>
<a class="sourceLine" id="cb271-92" title="92">vo0125high2 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc0125high2 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-93" title="93">A0125high2 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo0125high2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-94" title="94">vo025high2 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc025high2 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-95" title="95">A025high2 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo025high2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-96" title="96">vo05high2 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc05high2 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-97" title="97">A05high2 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo05high2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-98" title="98">vo1high2 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc1high2 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-99" title="99">A1high2 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo1high2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-100" title="100">vo2high2 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc2high2 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-101" title="101">A2high2 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo2high2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-102" title="102">vo4high2 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc4high2 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-103" title="103">A4high2 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo4high2 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-104" title="104"></a>
<a class="sourceLine" id="cb271-105" title="105">Ahigh2 &lt;-</a>
<a class="sourceLine" id="cb271-106" title="106"><span class="st">  </span><span class="kw">c</span>(A0125high2, A025high2, A05high2, A1high2, A2high2, A4high2)</a>
<a class="sourceLine" id="cb271-107" title="107"></a>
<a class="sourceLine" id="cb271-108" title="108">Cc0125high3 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t0125high <span class="op">*</span><span class="st"> </span>RateCc0125 <span class="op">*</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb271-109" title="109">Cc025high3 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t025high <span class="op">*</span><span class="st"> </span>RateCc025 <span class="op">*</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb271-110" title="110">Cc05high3 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t05high <span class="op">*</span><span class="st"> </span>RateCc05 <span class="op">*</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb271-111" title="111">Cc1high3 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t1high <span class="op">*</span><span class="st"> </span>RateCc1 <span class="op">*</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb271-112" title="112">Cc2high3 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t2high <span class="op">*</span><span class="st"> </span>RateCc2 <span class="op">*</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb271-113" title="113">Cc4high3 &lt;-<span class="st"> </span><span class="kw">c</span>(Cc <span class="op">+</span><span class="st"> </span>(t4high <span class="op">*</span><span class="st"> </span>RateCc4 <span class="op">*</span><span class="st"> </span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb271-114" title="114"></a>
<a class="sourceLine" id="cb271-115" title="115">vo0125high3 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc0125high3 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-116" title="116">A0125high3 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo0125high3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-117" title="117">vo025high3 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc025high3 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-118" title="118">A025high3 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo025high3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-119" title="119">vo05high3 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc05high3 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-120" title="120">A05high3 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo05high3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-121" title="121">vo1high3 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc1high3 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-122" title="122">A1high3 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo1high3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-123" title="123">vo2high3 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc2high3 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-124" title="124">A2high3 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo2high3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-125" title="125">vo4high3 &lt;-<span class="st"> </span>Vomax <span class="op">*</span><span class="st"> </span>O2 <span class="op">/</span><span class="st"> </span>(O2 <span class="op">+</span><span class="st"> </span>Ko <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Cc4high3 <span class="op">/</span><span class="st"> </span>Kc)) </a>
<a class="sourceLine" id="cb271-126" title="126">A4high3 &lt;-<span class="st"> </span>vc <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>vo4high3 <span class="op">-</span><span class="st"> </span>R </a>
<a class="sourceLine" id="cb271-127" title="127"></a>
<a class="sourceLine" id="cb271-128" title="128">Ahigh3 &lt;-</a>
<a class="sourceLine" id="cb271-129" title="129"><span class="st">  </span><span class="kw">c</span>(A0125high3, A025high3, A05high3, A1high3, A2high3, A4high3)</a>
<a class="sourceLine" id="cb271-130" title="130"></a>
<a class="sourceLine" id="cb271-131" title="131">Cidiffusion &lt;-<span class="st"> </span><span class="kw">c</span>(Cim0125, Cim025, Cim05, Cim1, Cim2, Cim4)</a>
<a class="sourceLine" id="cb271-132" title="132">Alow &lt;-<span class="st"> </span><span class="kw">c</span>(A0125low, A025low, A05low, A1low, A2low, A4low)</a>
<a class="sourceLine" id="cb271-133" title="133">Amedian &lt;-</a>
<a class="sourceLine" id="cb271-134" title="134"><span class="st">  </span><span class="kw">c</span>(A0125median,</a>
<a class="sourceLine" id="cb271-135" title="135">    A025median,</a>
<a class="sourceLine" id="cb271-136" title="136">    A05median,</a>
<a class="sourceLine" id="cb271-137" title="137">    A1median,</a>
<a class="sourceLine" id="cb271-138" title="138">    A2median,</a>
<a class="sourceLine" id="cb271-139" title="139">    A4median)</a>
<a class="sourceLine" id="cb271-140" title="140">Ahigh &lt;-<span class="st"> </span><span class="kw">c</span>(A0125high, A025high, A05high, A1high, A2high, A4high)</a>
<a class="sourceLine" id="cb271-141" title="141"></a>
<a class="sourceLine" id="cb271-142" title="142">variable &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Mesophyll Conductance&quot;</span>, <span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">length</span>(Cim1)))</a>
<a class="sourceLine" id="cb271-143" title="143">conductance &lt;-</a>
<a class="sourceLine" id="cb271-144" title="144"><span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="fl">0.125</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb271-145" title="145">    <span class="kw">rep</span>(<span class="fl">0.25</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb271-146" title="146">    <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb271-147" title="147">    <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb271-148" title="148">    <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">376</span>),</a>
<a class="sourceLine" id="cb271-149" title="149">    <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">376</span>))</a>
<a class="sourceLine" id="cb271-150" title="150"></a>
<a class="sourceLine" id="cb271-151" title="151">Diffusionplot2 &lt;-</a>
<a class="sourceLine" id="cb271-152" title="152"><span class="st">  </span><span class="kw">as.data.frame</span>(</a>
<a class="sourceLine" id="cb271-153" title="153">    <span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb271-154" title="154">      Cidiffusion,</a>
<a class="sourceLine" id="cb271-155" title="155">      Alow,</a>
<a class="sourceLine" id="cb271-156" title="156">      Amedian,</a>
<a class="sourceLine" id="cb271-157" title="157">      Ahigh,</a>
<a class="sourceLine" id="cb271-158" title="158">      Ahigh2,</a>
<a class="sourceLine" id="cb271-159" title="159">      Ahigh3,</a>
<a class="sourceLine" id="cb271-160" title="160">      variable,</a>
<a class="sourceLine" id="cb271-161" title="161">      conductance,</a>
<a class="sourceLine" id="cb271-162" title="162">      resistance</a>
<a class="sourceLine" id="cb271-163" title="163">    )</a>
<a class="sourceLine" id="cb271-164" title="164">  )</a>
<a class="sourceLine" id="cb271-165" title="165"><span class="kw">write.csv</span>(Diffusionplot2, <span class="st">&quot;./data/DiffusionLimitsACI2.csv&quot;</span>)</a></code></pre></div>
<p>最终够到的不同导度下的扩散数据如下：</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(Diffusionplot2))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Cidiffusion</th>
<th align="left">Alow</th>
<th align="left">Amedian</th>
<th align="left">Ahigh</th>
<th align="left">Ahigh2</th>
<th align="left">Ahigh3</th>
<th align="left">variable</th>
<th align="left">conductance</th>
<th align="left">resistance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">-14.0805894452511</td>
<td align="left">-4.87461753940542</td>
<td align="left">-4.86419435199041</td>
<td align="left">-4.81536251060599</td>
<td align="left">-4.74710314038274</td>
<td align="left">-4.68025068475633</td>
<td align="left">Mesophyll Conductance</td>
<td align="left">0.125</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">-11.8541114570766</td>
<td align="left">-4.72133615031493</td>
<td align="left">-4.71094118846005</td>
<td align="left">-4.66224099010836</td>
<td align="left">-4.59416400241068</td>
<td align="left">-4.52748832337504</td>
<td align="left">Mesophyll Conductance</td>
<td align="left">0.125</td>
<td align="left">11</td>
</tr>
<tr class="odd">
<td align="left">-9.63096032171488</td>
<td align="left">-4.56847050260645</td>
<td align="left">-4.55810365181624</td>
<td align="left">-4.50953456487788</td>
<td align="left">-4.44163922971142</td>
<td align="left">-4.37513962701612</td>
<td align="left">Mesophyll Conductance</td>
<td align="left">0.125</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">-7.41112252124025</td>
<td align="left">-4.41601890716257</td>
<td align="left">-4.40568005356001</td>
<td align="left">-4.35724154927421</td>
<td align="left">-4.28952714053524</td>
<td align="left">-4.22320291762348</td>
<td align="left">Mesophyll Conductance</td>
<td align="left">0.125</td>
<td align="left">11</td>
</tr>
<tr class="odd">
<td align="left">-5.19458461086401</td>
<td align="left">-4.26397968400382</td>
<td align="left">-4.25366871432613</td>
<td align="left">-4.20536026677158</td>
<td align="left">-4.13782606222113</td>
<td align="left">-4.07167652620537</td>
<td align="left">Mesophyll Conductance</td>
<td align="left">0.125</td>
<td align="left">11</td>
</tr>
<tr class="even">
<td align="left">-2.98133321844053</td>
<td align="left">-4.11235116222692</td>
<td align="left">-4.10206796382144</td>
<td align="left">-4.05388904989726</td>
<td align="left">-3.98653433113539</td>
<td align="left">-3.9205587927733</td>
<td align="left">Mesophyll Conductance</td>
<td align="left">0.125</td>
<td align="left">11</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="multi13" class="section level2">
<h2><span class="header-section-number">10.11</span> 扩散限制作图</h2>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/DiffusionLimitsACI2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb273-2" title="2">data<span class="op">$</span>resistance &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>resistance)</a>
<a class="sourceLine" id="cb273-3" title="3">graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Cidiffusion, <span class="dt">y =</span> Ahigh3, <span class="dt">colour =</span> resistance)) <span class="op">+</span></a>
<a class="sourceLine" id="cb273-4" title="4"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">0</span>,<span class="dt">intercept=</span><span class="dv">0</span>,<span class="dt">size=</span><span class="fl">1.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb273-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb273-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Total Resistance&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb273-7" title="7"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb273-8" title="8"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb273-9" title="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb273-10" title="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb273-11" title="11"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb273-12" title="12">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb273-13" title="13">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb273-14" title="14">    <span class="dt">legend.position =</span> <span class="st">&#39;right&#39;</span>,</a>
<a class="sourceLine" id="cb273-15" title="15">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb273-16" title="16">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb273-17" title="17">  )</a>
<a class="sourceLine" id="cb273-18" title="18">graph</a></code></pre></div>
<div class="figure"><span id="fig:difuci"></span>
<img src="bookdown_files/figure-html/difuci-1.png" alt="不同 Ci 扩散限制下的差异" width="672" />
<p class="caption">
图 10.16: 不同 Ci 扩散限制下的差异
</p>
</div>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1">datahigh &lt;-<span class="st"> </span>data[data<span class="op">$</span>resistance <span class="op">==</span><span class="st"> &quot;11&quot;</span>,]</a>
<a class="sourceLine" id="cb274-2" title="2">graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(datahigh, <span class="kw">aes</span>(<span class="dt">x =</span> Cidiffusion, <span class="dt">y =</span> Ahigh3)) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-3" title="3"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope=</span><span class="dv">0</span>,<span class="dt">intercept=</span><span class="dv">0</span>,<span class="dt">size=</span><span class="fl">1.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb274-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb274-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Cidiffusion, <span class="dt">y =</span> Ahigh2), <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb274-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Cidiffusion, <span class="dt">y =</span> Ahigh), <span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb274-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Total Resistance&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb274-8" title="8"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-9" title="9"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb274-10" title="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb274-11" title="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb274-12" title="12"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb274-13" title="13">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb274-14" title="14">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb274-15" title="15">    <span class="dt">legend.position =</span> <span class="st">&#39;right&#39;</span>,</a>
<a class="sourceLine" id="cb274-16" title="16">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb274-17" title="17">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb274-18" title="18">  )</a>
<a class="sourceLine" id="cb274-19" title="19">graph</a></code></pre></div>
<div class="figure"><span id="fig:difuci11"></span>
<img src="bookdown_files/figure-html/difuci11-1.png" alt="不同 Ci 扩散限制下的差异（resistance = 11）" width="672" />
<p class="caption">
图 10.17: 不同 Ci 扩散限制下的差异（resistance = 11）
</p>
</div>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1">data2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/DiffusionLimits.csv&quot;</span>)</a>
<a class="sourceLine" id="cb275-2" title="2">graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> TotalRes, <span class="dt">y =</span> Rates, <span class="dt">colour =</span> Scenario)) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb275-4" title="4"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Spectral&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-5" title="5"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb275-6" title="6"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb275-7" title="7">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb275-8" title="8">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb275-9" title="9">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb275-10" title="10">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb275-11" title="11">  )</a>
<a class="sourceLine" id="cb275-12" title="12">graph</a></code></pre></div>
<div class="figure"><span id="fig:tolresis"></span>
<img src="bookdown_files/figure-html/tolresis-1.png" alt="不同总导度下的各个导度的速率变化" width="672" />
<p class="caption">
图 10.18: 不同总导度下的各个导度的速率变化
</p>
</div>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Rates <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>TotalRes)<span class="op">+</span><span class="kw">I</span>((<span class="dv">1</span><span class="op">/</span>TotalRes)<span class="op">^</span><span class="dv">2</span>),<span class="dt">data=</span>data2)</a>
<a class="sourceLine" id="cb276-2" title="2"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Rates ~ I(1/TotalRes) + I((1/TotalRes)^2), data = data2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.3590 -0.9844 -0.1236  0.7706  2.4510 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         13.042      1.684   7.745 3.18e-06 ***
## I(1/TotalRes)      421.928     22.487  18.763 8.49e-11 ***
## I((1/TotalRes)^2) -737.690     65.500 -11.262 4.46e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.705 on 13 degrees of freedom
## Multiple R-squared:  0.9904, Adjusted R-squared:  0.9889 
## F-statistic: 668.8 on 2 and 13 DF,  p-value: 7.799e-14</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1">ab &lt;-<span class="st"> </span><span class="kw">predict</span>(m1)</a>
<a class="sourceLine" id="cb278-2" title="2">red &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>data2<span class="op">$</span>TotalRes</a>
<a class="sourceLine" id="cb278-3" title="3"><span class="kw">plot</span>(ab<span class="op">~</span>red)</a></code></pre></div>
<div class="figure"><span id="fig:tolre"></span>
<img src="bookdown_files/figure-html/tolre-1.png" alt="不同阻力下的各个导度的速率变化预测值" width="672" />
<p class="caption">
图 10.19: 不同阻力下的各个导度的速率变化预测值
</p>
</div>
<div id="multi14" class="section level3">
<h3><span class="header-section-number">10.11.1</span> 补偿点的计算</h3>
<p>计算补偿点，代码同前文类似，只是采用了不同导度下的数值：</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/DiffusionLimitsACI2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb279-2" title="2"><span class="co">#Gamma</span></a>
<a class="sourceLine" id="cb279-3" title="3"><span class="co"># For Ci-based estimates, only use Ci &lt; 100</span></a>
<a class="sourceLine" id="cb279-4" title="4">dataCi &lt;-<span class="st"> </span>data[data<span class="op">$</span>Cidiffusion <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, ]</a>
<a class="sourceLine" id="cb279-5" title="5">dataCi0125 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>conductance <span class="op">==</span><span class="st"> &quot;0.125&quot;</span>, ]</a>
<a class="sourceLine" id="cb279-6" title="6">dataCi025 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>conductance <span class="op">==</span><span class="st"> &quot;0.25&quot;</span>, ]</a>
<a class="sourceLine" id="cb279-7" title="7">dataCi05 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>conductance <span class="op">==</span><span class="st"> &quot;0.5&quot;</span>, ]</a>
<a class="sourceLine" id="cb279-8" title="8">dataCi1 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>conductance <span class="op">==</span><span class="st"> &quot;1&quot;</span>, ]</a>
<a class="sourceLine" id="cb279-9" title="9">dataCi2 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>conductance <span class="op">==</span><span class="st"> &quot;2&quot;</span>, ]</a>
<a class="sourceLine" id="cb279-10" title="10">dataCi4 &lt;-<span class="st"> </span>dataCi[dataCi<span class="op">$</span>conductance <span class="op">==</span><span class="st"> &quot;4&quot;</span>, ]</a>
<a class="sourceLine" id="cb279-11" title="11">m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi0125<span class="op">$</span>Ahigh <span class="op">~</span><span class="st"> </span>dataCi0125<span class="op">$</span>Cidiffusion)</a>
<a class="sourceLine" id="cb279-12" title="12"><span class="kw">summary</span>(m1)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi0125$Ahigh ~ dataCi0125$Cidiffusion)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.040649 -0.014495  0.005307  0.017054  0.021232 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)            -3.836e+00  4.318e-03  -888.5   &lt;2e-16 ***
## dataCi0125$Cidiffusion  6.665e-02  7.873e-05   846.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01934 on 52 degrees of freedom
## Multiple R-squared:  0.9999, Adjusted R-squared:  0.9999 
## F-statistic: 7.167e+05 on 1 and 52 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1">Gamma0125 &lt;-<span class="st"> </span><span class="op">-</span>m1<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m1<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb281-2" title="2">m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi025<span class="op">$</span>Ahigh <span class="op">~</span><span class="st"> </span>dataCi025<span class="op">$</span>Cidiffusion)</a>
<a class="sourceLine" id="cb281-3" title="3"><span class="kw">summary</span>(m2)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi025$Ahigh ~ dataCi025$Cidiffusion)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.070876 -0.025427  0.009071  0.029765  0.036593 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -5.2507346  0.0092187  -569.6   &lt;2e-16 ***
## dataCi025$Cidiffusion  0.0904227  0.0001544   585.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.03329 on 59 degrees of freedom
## Multiple R-squared:  0.9998, Adjusted R-squared:  0.9998 
## F-statistic: 3.428e+05 on 1 and 59 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1">Gamma025 &lt;-<span class="st"> </span><span class="op">-</span>m2<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m2<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb283-2" title="2">m3 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi05<span class="op">$</span>Ahigh <span class="op">~</span><span class="st"> </span>dataCi05<span class="op">$</span>Cidiffusion)</a>
<a class="sourceLine" id="cb283-3" title="3"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi05$Ahigh ~ dataCi05$Cidiffusion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.10435 -0.03583  0.01358  0.04311  0.05340 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          -6.4051036  0.0150363    -426   &lt;2e-16 ***
## dataCi05$Cidiffusion  0.1097686  0.0002391     459   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.04851 on 65 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 2.107e+05 on 1 and 65 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1">Gamma05 &lt;-<span class="st"> </span><span class="op">-</span>m3<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m3<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb285-2" title="2">m4 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi1<span class="op">$</span>Ahigh <span class="op">~</span><span class="st"> </span>dataCi1<span class="op">$</span>Cidiffusion)</a>
<a class="sourceLine" id="cb285-3" title="3"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi1$Ahigh ~ dataCi1$Cidiffusion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.13150 -0.04513  0.01709  0.05402  0.06692 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -7.1817472  0.0199135  -360.6   &lt;2e-16 ***
## dataCi1$Cidiffusion  0.1227771  0.0003085   398.0   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06074 on 69 degrees of freedom
## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9996 
## F-statistic: 1.584e+05 on 1 and 69 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1">Gamma1 &lt;-<span class="st"> </span><span class="op">-</span>m4<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m4<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb287-2" title="2">m5 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi2<span class="op">$</span>Ahigh <span class="op">~</span><span class="st"> </span>dataCi2<span class="op">$</span>Cidiffusion)</a>
<a class="sourceLine" id="cb287-3" title="3"><span class="kw">summary</span>(m5)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi2$Ahigh ~ dataCi2$Cidiffusion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.14803 -0.04874  0.01837  0.05995  0.07511 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -7.6427727  0.0230595  -331.4   &lt;2e-16 ***
## dataCi2$Cidiffusion  0.1305083  0.0003538   368.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06815 on 71 degrees of freedom
## Multiple R-squared:  0.9995, Adjusted R-squared:  0.9995 
## F-statistic: 1.361e+05 on 1 and 71 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">Gamma2 &lt;-<span class="st"> </span><span class="op">-</span>m5<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m5<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb289-2" title="2">m6 &lt;-<span class="st"> </span><span class="kw">lm</span>(dataCi4<span class="op">$</span>Ahigh <span class="op">~</span><span class="st"> </span>dataCi4<span class="op">$</span>Cidiffusion)</a>
<a class="sourceLine" id="cb289-3" title="3"><span class="kw">summary</span>(m6)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dataCi4$Ahigh ~ dataCi4$Cidiffusion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.15721 -0.05258  0.01994  0.06470  0.07968 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         -7.8955772  0.0248634  -317.6   &lt;2e-16 ***
## dataCi4$Cidiffusion  0.1347503  0.0003799   354.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07225 on 72 degrees of freedom
## Multiple R-squared:  0.9994, Adjusted R-squared:  0.9994 
## F-statistic: 1.258e+05 on 1 and 72 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">Gamma4 &lt;-<span class="st"> </span><span class="op">-</span>m6<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span>m6<span class="op">$</span>coefficients[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb291-2" title="2"></a>
<a class="sourceLine" id="cb291-3" title="3">GammaCi &lt;-<span class="st"> </span><span class="kw">c</span>(Gamma0125, Gamma025, Gamma05, Gamma1, Gamma2, Gamma4)</a></code></pre></div>
</div>
<div id="multi15" class="section level3">
<h3><span class="header-section-number">10.11.2</span> 所有图形代码</h3>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/PRdata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb292-2" title="2">data<span class="op">$</span>Ccfull &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb292-3" title="3">data<span class="op">$</span>Delay &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>Delay)</a>
<a class="sourceLine" id="cb292-4" title="4">cols &lt;-<span class="st"> </span><span class="kw">gg_color_hue</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb292-5" title="5">Panel_1A &lt;-</a>
<a class="sourceLine" id="cb292-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb292-7" title="7">    <span class="dt">x =</span> Cifull,</a>
<a class="sourceLine" id="cb292-8" title="8">    <span class="dt">y =</span> Anet,</a>
<a class="sourceLine" id="cb292-9" title="9">    <span class="dt">colour =</span> Delay,</a>
<a class="sourceLine" id="cb292-10" title="10">    <span class="dt">linetype =</span> Delay</a>
<a class="sourceLine" id="cb292-11" title="11">  )) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-12" title="12"><span class="st">  </span><span class="co"># 零水平参考线</span></a>
<a class="sourceLine" id="cb292-13" title="13"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb292-14" title="14">              <span class="dt">intercept =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb292-15" title="15">              <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-16" title="16"><span class="st">  </span><span class="co">#ci与A loess 方法的拟合曲线</span></a>
<a class="sourceLine" id="cb292-17" title="17"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-18" title="18"><span class="st">  </span><span class="kw">scale_linetype_manual</span>(</a>
<a class="sourceLine" id="cb292-19" title="19">    <span class="dt">name =</span> <span class="st">&quot;Delay (s)&quot;</span>,</a>
<a class="sourceLine" id="cb292-20" title="20">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;120&quot;</span>, <span class="st">&quot;300&quot;</span>),</a>
<a class="sourceLine" id="cb292-21" title="21">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;twodash&quot;</span>, <span class="st">&quot;dotdash&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb292-22" title="22">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-23" title="23"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb292-24" title="24">    <span class="kw">bold</span>(<span class="st">&quot;(a)&quot;</span>), <span class="st">&quot; Modelled Photorespiratory Effect&quot;</span></a>
<a class="sourceLine" id="cb292-25" title="25">  ))) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-26" title="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb292-27" title="27">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb292-28" title="28">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb292-29" title="29">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb292-30" title="30">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb292-31" title="31">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb292-32" title="32">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb292-33" title="33">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-34" title="34"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Delay (s)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-35" title="35"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">250</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-36" title="36"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-37" title="37"><span class="st">  </span><span class="kw">scale_colour_manual</span>(</a>
<a class="sourceLine" id="cb292-38" title="38">    <span class="dt">values =</span> cols,</a>
<a class="sourceLine" id="cb292-39" title="39">    <span class="dt">name =</span> <span class="st">&quot;Delay (s)&quot;</span>,</a>
<a class="sourceLine" id="cb292-40" title="40">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;120&quot;</span>, <span class="st">&quot;300&quot;</span>)</a>
<a class="sourceLine" id="cb292-41" title="41">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-42" title="42"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb292-43" title="43"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb292-44" title="44">    <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb292-45" title="45">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb292-46" title="46">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb292-47" title="47">    <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb292-48" title="48">    <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb292-49" title="49">    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb292-50" title="50">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb292-51" title="51">    <span class="dt">axis.text.y =</span></a>
<a class="sourceLine" id="cb292-52" title="52">      <span class="kw">element_text</span>(</a>
<a class="sourceLine" id="cb292-53" title="53">        <span class="dt">size =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb292-54" title="54">        <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb292-55" title="55">        <span class="dt">hjust =</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb292-56" title="56">      ),</a>
<a class="sourceLine" id="cb292-57" title="57">    <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.15</span>, <span class="fl">0.75</span>),</a>
<a class="sourceLine" id="cb292-58" title="58">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb292-59" title="59">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb292-60" title="60">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb292-61" title="61">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb292-62" title="62">    <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb292-63" title="63">    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb292-64" title="64">  )</a>
<a class="sourceLine" id="cb292-65" title="65">Panel_1A</a></code></pre></div>
<div class="figure"><span id="fig:prdataplot"></span>
<img src="bookdown_files/figure-html/prdataplot-1.png" alt="不同时间滞后性的 Anet VS Ci" width="672" />
<p class="caption">
图 10.20: 不同时间滞后性的 Anet VS Ci
</p>
</div>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">Panel_1A_inset &lt;-</a>
<a class="sourceLine" id="cb293-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb293-3" title="3">    <span class="dt">x =</span> Cifull,</a>
<a class="sourceLine" id="cb293-4" title="4">    <span class="dt">y =</span> Anet,</a>
<a class="sourceLine" id="cb293-5" title="5">    <span class="dt">colour =</span> Delay,</a>
<a class="sourceLine" id="cb293-6" title="6">    <span class="dt">linetype =</span> Delay</a>
<a class="sourceLine" id="cb293-7" title="7">  )) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-8" title="8"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb293-9" title="9">              <span class="dt">intercept =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb293-10" title="10">              <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-11" title="11"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-12" title="12"><span class="st">  </span><span class="kw">scale_linetype_manual</span>(</a>
<a class="sourceLine" id="cb293-13" title="13">    <span class="dt">name =</span> <span class="st">&quot;Delay (s)&quot;</span>,</a>
<a class="sourceLine" id="cb293-14" title="14">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;60&quot;</span>, <span class="st">&quot;120&quot;</span>, <span class="st">&quot;300&quot;</span>),</a>
<a class="sourceLine" id="cb293-15" title="15">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;twodash&quot;</span>, <span class="st">&quot;dotdash&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb293-16" title="16">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb293-18" title="18">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb293-19" title="19">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb293-20" title="20">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb293-21" title="21">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb293-22" title="22">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb293-23" title="23">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb293-24" title="24">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-25" title="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Delay (s)&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-26" title="26"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">45</span>, <span class="dv">65</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-27" title="27"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-28" title="28"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> cols) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-29" title="29"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb293-30" title="30"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb293-31" title="31">    <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-32" title="32">    <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-33" title="33">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb293-34" title="34">    <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb293-35" title="35">    <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb293-36" title="36">    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb293-37" title="37">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb293-38" title="38">    <span class="dt">axis.text.y =</span></a>
<a class="sourceLine" id="cb293-39" title="39">      <span class="kw">element_text</span>(</a>
<a class="sourceLine" id="cb293-40" title="40">        <span class="dt">size =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb293-41" title="41">        <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb293-42" title="42">        <span class="dt">hjust =</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb293-43" title="43">      ),</a>
<a class="sourceLine" id="cb293-44" title="44">    <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-45" title="45">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb293-46" title="46">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-47" title="47">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-48" title="48">    <span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>,</a>
<a class="sourceLine" id="cb293-49" title="49">    <span class="dt">plot.background =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb293-50" title="50">  )</a>
<a class="sourceLine" id="cb293-51" title="51"></a>
<a class="sourceLine" id="cb293-52" title="52"></a>
<a class="sourceLine" id="cb293-53" title="53"></a>
<a class="sourceLine" id="cb293-54" title="54">cols &lt;-<span class="st"> </span><span class="kw">gg_color_hue</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb293-55" title="55"></a>
<a class="sourceLine" id="cb293-56" title="56">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/DiffusionLimitsACI2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb293-57" title="57">data<span class="op">$</span>resistance &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>resistance)</a>
<a class="sourceLine" id="cb293-58" title="58">Panel_1Db &lt;-</a>
<a class="sourceLine" id="cb293-59" title="59"><span class="st">  </span><span class="kw">ggplot</span>(data,</a>
<a class="sourceLine" id="cb293-60" title="60">         <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb293-61" title="61">           <span class="dt">x =</span> Cidiffusion,</a>
<a class="sourceLine" id="cb293-62" title="62">           <span class="dt">y =</span> Ahigh,</a>
<a class="sourceLine" id="cb293-63" title="63">           <span class="dt">colour =</span> resistance,</a>
<a class="sourceLine" id="cb293-64" title="64">           <span class="dt">linetype =</span> resistance</a>
<a class="sourceLine" id="cb293-65" title="65">         )) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-66" title="66"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb293-67" title="67">              <span class="dt">intercept =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb293-68" title="68">              <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-69" title="69"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-70" title="70"><span class="st">  </span><span class="kw">scale_linetype_manual</span>(</a>
<a class="sourceLine" id="cb293-71" title="71">    <span class="dt">name =</span> <span class="st">&quot;Total Resistance&quot;</span>,</a>
<a class="sourceLine" id="cb293-72" title="72">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;3.25&quot;</span>, <span class="st">&quot;3.5&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;11&quot;</span>),</a>
<a class="sourceLine" id="cb293-73" title="73">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;twodash&quot;</span>, <span class="st">&quot;dotdash&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb293-74" title="74">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-75" title="75"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">bold</span>(<span class="st">&quot;(d)&quot;</span>), <span class="st">&quot; Modelled Resistance Effect&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-76" title="76"><span class="st">  </span><span class="kw">scale_color_manual</span>(</a>
<a class="sourceLine" id="cb293-77" title="77">    <span class="dt">values =</span> cols,</a>
<a class="sourceLine" id="cb293-78" title="78">    <span class="dt">name =</span> <span class="st">&quot;Total Resistance&quot;</span>,</a>
<a class="sourceLine" id="cb293-79" title="79">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;3.25&quot;</span>, <span class="st">&quot;3.5&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;7&quot;</span>, <span class="st">&quot;11&quot;</span>)</a>
<a class="sourceLine" id="cb293-80" title="80">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-81" title="81"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb293-82" title="82"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb293-83" title="83">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb293-84" title="84">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)), <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb293-85" title="85">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb293-86" title="86">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb293-87" title="87">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb293-88" title="88">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-89" title="89"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">250</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-90" title="90"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb293-91" title="91"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb293-92" title="92">    <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb293-93" title="93">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb293-94" title="94">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb293-95" title="95">    <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb293-96" title="96">    <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb293-97" title="97">    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb293-98" title="98">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb293-99" title="99">    <span class="dt">axis.text.y =</span></a>
<a class="sourceLine" id="cb293-100" title="100">      <span class="kw">element_text</span>(</a>
<a class="sourceLine" id="cb293-101" title="101">        <span class="dt">size =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb293-102" title="102">        <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb293-103" title="103">        <span class="dt">hjust =</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb293-104" title="104">      ),</a>
<a class="sourceLine" id="cb293-105" title="105">    <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.22</span>, <span class="fl">0.75</span>),</a>
<a class="sourceLine" id="cb293-106" title="106">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb293-107" title="107">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb293-108" title="108">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-109" title="109">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb293-110" title="110">    <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb293-111" title="111">    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb293-112" title="112">  )</a>
<a class="sourceLine" id="cb293-113" title="113">Panel_1Db</a></code></pre></div>
<div class="figure"><span id="fig:resistplot"></span>
<img src="bookdown_files/figure-html/resistplot-1.png" alt="不同总阻力下的 Anet VS Ci" width="672" />
<p class="caption">
图 10.21: 不同总阻力下的 Anet VS Ci
</p>
</div>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/DiffusionLimitsACI2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb294-2" title="2">data<span class="op">$</span>resistance &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>resistance)</a>
<a class="sourceLine" id="cb294-3" title="3">data &lt;-<span class="st"> </span>data[data<span class="op">$</span>resistance <span class="op">==</span><span class="st"> &quot;11&quot;</span>,]</a>
<a class="sourceLine" id="cb294-4" title="4">resistance &lt;-<span class="st"> </span><span class="kw">rep</span>(data<span class="op">$</span>resistance, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb294-5" title="5">Cidiffusion &lt;-<span class="st"> </span><span class="kw">rep</span>(data<span class="op">$</span>Cidffusion, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb294-6" title="6">A &lt;-<span class="st"> </span><span class="kw">c</span>(data<span class="op">$</span>Ahigh, data<span class="op">$</span>Ahigh2, data<span class="op">$</span>Ahigh3)</a>
<a class="sourceLine" id="cb294-7" title="7">Rate &lt;-</a>
<a class="sourceLine" id="cb294-8" title="8"><span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">100</span>, <span class="kw">length</span>(data<span class="op">$</span>Ahigh)), <span class="kw">rep</span>(<span class="dv">200</span>, <span class="kw">length</span>(data<span class="op">$</span>Ahigh2)), <span class="kw">rep</span>(<span class="dv">300</span>, <span class="kw">length</span>(data<span class="op">$</span>Ahigh3)))</a>
<a class="sourceLine" id="cb294-9" title="9">data3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(data, data, data)</a>
<a class="sourceLine" id="cb294-10" title="10">data3<span class="op">$</span>A &lt;-<span class="st"> </span><span class="kw">c</span>(data<span class="op">$</span>Ahigh, data<span class="op">$</span>Ahigh2, data<span class="op">$</span>Ahigh3)</a>
<a class="sourceLine" id="cb294-11" title="11">data3<span class="op">$</span>Rate &lt;-</a>
<a class="sourceLine" id="cb294-12" title="12"><span class="st">  </span><span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">100</span>, <span class="kw">length</span>(data<span class="op">$</span>Ahigh)), <span class="kw">rep</span>(<span class="dv">200</span>, <span class="kw">length</span>(data<span class="op">$</span>Ahigh2)), <span class="kw">rep</span>(<span class="dv">300</span>, <span class="kw">length</span>(data<span class="op">$</span>Ahigh3))))</a>
<a class="sourceLine" id="cb294-13" title="13">Panel_1Dbinset &lt;-</a>
<a class="sourceLine" id="cb294-14" title="14"><span class="st">  </span><span class="kw">ggplot</span>(data3, <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb294-15" title="15">    <span class="dt">x =</span> Cidiffusion,</a>
<a class="sourceLine" id="cb294-16" title="16">    <span class="dt">y =</span> A,</a>
<a class="sourceLine" id="cb294-17" title="17">    <span class="dt">colour =</span> Rate,</a>
<a class="sourceLine" id="cb294-18" title="18">    <span class="dt">linetype =</span> Rate</a>
<a class="sourceLine" id="cb294-19" title="19">  )) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-20" title="20"><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb294-21" title="21">              <span class="dt">intercept =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb294-22" title="22">              <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-23" title="23"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-24" title="24"><span class="st">  </span><span class="kw">scale_linetype_manual</span>(</a>
<a class="sourceLine" id="cb294-25" title="25">    <span class="dt">name =</span> <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb294-26" title="26">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;100&quot;</span>, <span class="st">&quot;200&quot;</span>, <span class="st">&quot;300&quot;</span>),</a>
<a class="sourceLine" id="cb294-27" title="27">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;twodash&quot;</span>)</a>
<a class="sourceLine" id="cb294-28" title="28">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-29" title="29"><span class="st">  </span><span class="kw">scale_color_manual</span>(</a>
<a class="sourceLine" id="cb294-30" title="30">    <span class="dt">values =</span> cols,</a>
<a class="sourceLine" id="cb294-31" title="31">    <span class="dt">name =</span> <span class="st">&quot;Rate&quot;</span>,</a>
<a class="sourceLine" id="cb294-32" title="32">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;100&quot;</span>, <span class="st">&quot;200&quot;</span>, <span class="st">&quot;300&quot;</span>)</a>
<a class="sourceLine" id="cb294-33" title="33">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-34" title="34"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb294-35" title="35"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb294-36" title="36">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb294-37" title="37">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)), <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb294-38" title="38">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb294-39" title="39">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb294-40" title="40">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb294-41" title="41">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-42" title="42"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">45</span>, <span class="dv">65</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-43" title="43"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb294-44" title="44"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb294-45" title="45">    <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-46" title="46">    <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-47" title="47">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb294-48" title="48">    <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb294-49" title="49">    <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb294-50" title="50">    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb294-51" title="51">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb294-52" title="52">    <span class="dt">axis.text.y =</span></a>
<a class="sourceLine" id="cb294-53" title="53">      <span class="kw">element_text</span>(</a>
<a class="sourceLine" id="cb294-54" title="54">        <span class="dt">size =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb294-55" title="55">        <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb294-56" title="56">        <span class="dt">hjust =</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb294-57" title="57">      ),</a>
<a class="sourceLine" id="cb294-58" title="58">    <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.22</span>, <span class="fl">0.75</span>),</a>
<a class="sourceLine" id="cb294-59" title="59">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb294-60" title="60">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb294-61" title="61">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-62" title="62">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-63" title="63">    <span class="dt">plot.background =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-64" title="64">    <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb294-65" title="65">    <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-66" title="66">    <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb294-67" title="67">    <span class="dt">legend.background =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb294-68" title="68">  )</a>
<a class="sourceLine" id="cb294-69" title="69">Panel_1Dbinset</a></code></pre></div>
<div class="figure"><span id="fig:high3tplot"></span>
<img src="bookdown_files/figure-html/high3tplot-1.png" alt="不同导度下的 A VS Ci" width="672" />
<p class="caption">
图 10.22: 不同导度下的 A VS Ci
</p>
</div>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1">data2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/DiffusionLimits.csv&quot;</span>)</a>
<a class="sourceLine" id="cb295-2" title="2">data2<span class="op">$</span>Conductance &lt;-</a>
<a class="sourceLine" id="cb295-3" title="3"><span class="st">  </span><span class="kw">revalue</span>(</a>
<a class="sourceLine" id="cb295-4" title="4">    data2<span class="op">$</span>Scenario,</a>
<a class="sourceLine" id="cb295-5" title="5">    <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb295-6" title="6">      <span class="st">&quot;Boundary Layer Conductance&quot;</span> =<span class="st"> &quot;Boundary Layer&quot;</span>,</a>
<a class="sourceLine" id="cb295-7" title="7">      <span class="st">&quot;Mesophyll Conductance&quot;</span> =<span class="st"> &quot;Mesophyll&quot;</span>,</a>
<a class="sourceLine" id="cb295-8" title="8">      <span class="st">&quot;Stomatal Conductance&quot;</span> =<span class="st"> &quot;Stomatal&quot;</span></a>
<a class="sourceLine" id="cb295-9" title="9">    )</a>
<a class="sourceLine" id="cb295-10" title="10">  )</a>
<a class="sourceLine" id="cb295-11" title="11">cols &lt;-<span class="st"> </span><span class="kw">gg_color_hue</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb295-12" title="12"></a>
<a class="sourceLine" id="cb295-13" title="13">Panel_1E &lt;-</a>
<a class="sourceLine" id="cb295-14" title="14"><span class="st">  </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> TotalRes, <span class="dt">y =</span> Rates, <span class="dt">colour =</span> Conductance)) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-15" title="15"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-16" title="16"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">bold</span>(<span class="st">&quot;(e)&quot;</span>), <span class="st">&quot; Modelled Resistance Effect&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(r[total] <span class="op">*</span><span class="st"> &quot; (s&quot;</span> <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb295-18" title="18">    <span class="dv">2</span></a>
<a class="sourceLine" id="cb295-19" title="19">  } <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb295-20" title="20">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb295-21" title="21">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)), </a>
<a class="sourceLine" id="cb295-22" title="22">  <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(C[c] <span class="op">*</span><span class="st"> &quot; Ramp Rate (&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span></a>
<a class="sourceLine" id="cb295-23" title="23"><span class="st">                                    </span>{</a>
<a class="sourceLine" id="cb295-24" title="24">                                      <span class="dv">-1</span></a>
<a class="sourceLine" id="cb295-25" title="25">                                    } <span class="op">~</span><span class="st"> </span>min <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb295-26" title="26">                                      <span class="dv">-1</span></a>
<a class="sourceLine" id="cb295-27" title="27">                                    } <span class="op">*</span><span class="st"> &quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-28" title="28"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-29" title="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">80</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-30" title="30"><span class="st">  </span><span class="kw">scale_color_manual</span>(</a>
<a class="sourceLine" id="cb295-31" title="31">    <span class="dt">values =</span> cols,</a>
<a class="sourceLine" id="cb295-32" title="32">    <span class="dt">name =</span> <span class="st">&quot;Manipulated Resistance&quot;</span>,</a>
<a class="sourceLine" id="cb295-33" title="33">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Boundary Layer&quot;</span>, <span class="st">&quot;Mesophyll&quot;</span>, <span class="st">&quot;Stomatal&quot;</span>)</a>
<a class="sourceLine" id="cb295-34" title="34">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb295-35" title="35"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb295-36" title="36"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb295-37" title="37">    <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb295-38" title="38">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb295-39" title="39">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb295-40" title="40">    <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb295-41" title="41">    <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb295-42" title="42">    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb295-43" title="43">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb295-44" title="44">    <span class="dt">axis.text.y =</span></a>
<a class="sourceLine" id="cb295-45" title="45">      <span class="kw">element_text</span>(</a>
<a class="sourceLine" id="cb295-46" title="46">        <span class="dt">size =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb295-47" title="47">        <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb295-48" title="48">        <span class="dt">hjust =</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb295-49" title="49">      ),</a>
<a class="sourceLine" id="cb295-50" title="50">    <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.70</span>, <span class="fl">0.84</span>),</a>
<a class="sourceLine" id="cb295-51" title="51">    <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb295-52" title="52">    <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb295-53" title="53">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb295-54" title="54">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb295-55" title="55">    <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),</a>
<a class="sourceLine" id="cb295-56" title="56">    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb295-57" title="57">  )</a>
<a class="sourceLine" id="cb295-58" title="58">Panel_1E</a></code></pre></div>
<div class="figure"><span id="fig:toresratetplot"></span>
<img src="bookdown_files/figure-html/toresratetplot-1.png" alt="不同总导度下的各个导度的变化" width="672" />
<p class="caption">
图 10.23: 不同总导度下的各个导度的变化
</p>
</div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/RASdata.csv&quot;</span>)</a>
<a class="sourceLine" id="cb296-2" title="2">data<span class="op">$</span>Ccfull &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data<span class="op">$</span>Ccfull)</a>
<a class="sourceLine" id="cb296-3" title="3">data<span class="op">$</span>Deactivation &lt;-<span class="st"> </span><span class="kw">as.factor</span>(data<span class="op">$</span>Deactivation)</a>
<a class="sourceLine" id="cb296-4" title="4"><span class="kw">print</span>(<span class="kw">levels</span>(data<span class="op">$</span>Deactivation))</a></code></pre></div>
<pre><code>## [1] &quot;High&quot;   &quot;Low&quot;    &quot;Medium&quot; &quot;None&quot;</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">data<span class="op">$</span>Deactivation &lt;-</a>
<a class="sourceLine" id="cb298-2" title="2"><span class="st">  </span><span class="kw">factor</span>(data<span class="op">$</span>Deactivation, <span class="kw">levels</span>(data<span class="op">$</span>Deactivation)[<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)])</a>
<a class="sourceLine" id="cb298-3" title="3">FigS1 &lt;-</a>
<a class="sourceLine" id="cb298-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(data,</a>
<a class="sourceLine" id="cb298-5" title="5">         <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb298-6" title="6">           <span class="dt">x =</span> Cifull,</a>
<a class="sourceLine" id="cb298-7" title="7">           <span class="dt">y =</span> Anet,</a>
<a class="sourceLine" id="cb298-8" title="8">           <span class="dt">colour =</span> Deactivation,</a>
<a class="sourceLine" id="cb298-9" title="9">           <span class="dt">linetype =</span> Deactivation</a>
<a class="sourceLine" id="cb298-10" title="10">         )) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-11" title="11"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-12" title="12"><span class="st">  </span><span class="kw">scale_linetype_manual</span>(</a>
<a class="sourceLine" id="cb298-13" title="13">    <span class="dt">name =</span> <span class="st">&quot;Deactivation&quot;</span>,</a>
<a class="sourceLine" id="cb298-14" title="14">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>),</a>
<a class="sourceLine" id="cb298-15" title="15">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;solid&quot;</span>, <span class="st">&quot;longdash&quot;</span>, <span class="st">&quot;dashed&quot;</span>, <span class="st">&quot;dotted&quot;</span>)</a>
<a class="sourceLine" id="cb298-16" title="16">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(C[i] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>mol <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb298-18" title="18">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb298-19" title="19">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb298-20" title="20">  <span class="dt">y =</span> <span class="kw">expression</span>(A[net] <span class="op">~</span><span class="st"> &quot;(&quot;</span> <span class="op">*</span><span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>mol <span class="op">~</span><span class="st"> </span>m <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb298-21" title="21">    <span class="dv">-2</span></a>
<a class="sourceLine" id="cb298-22" title="22">  } <span class="op">~</span><span class="st"> </span>s <span class="op">^</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb298-23" title="23">    <span class="dv">-1</span></a>
<a class="sourceLine" id="cb298-24" title="24">  } <span class="op">*</span><span class="st"> &quot;)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-25" title="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&#39;Deactivation&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-26" title="26"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb298-27" title="27">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">40</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-28" title="28"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-29" title="29"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-30" title="30"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb298-31" title="31"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb298-32" title="32">    <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb298-33" title="33">    <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb298-34" title="34">    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb298-35" title="35">    <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb298-36" title="36">    <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb298-37" title="37">    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb298-38" title="38">    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb298-39" title="39">    <span class="dt">axis.text.y =</span></a>
<a class="sourceLine" id="cb298-40" title="40">      <span class="kw">element_text</span>(</a>
<a class="sourceLine" id="cb298-41" title="41">        <span class="dt">size =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb298-42" title="42">        <span class="dt">color =</span> <span class="st">&#39;black&#39;</span>,</a>
<a class="sourceLine" id="cb298-43" title="43">        <span class="dt">hjust =</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb298-44" title="44">      ),</a>
<a class="sourceLine" id="cb298-45" title="45">    <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb298-46" title="46">    <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</a>
<a class="sourceLine" id="cb298-47" title="47">    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),</a>
<a class="sourceLine" id="cb298-48" title="48">    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb298-49" title="49">    <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb298-50" title="50">  )</a>
<a class="sourceLine" id="cb298-51" title="51">FigS1</a></code></pre></div>
<div class="figure"><span id="fig:deasratetplot"></span>
<img src="bookdown_files/figure-html/deasratetplot-1.png" alt="Rubisco不同失活程度下的下 A VS Ci" width="672" />
<p class="caption">
图 10.24: Rubisco不同失活程度下的下 A VS Ci
</p>
</div>


</div>
</div>
<div id="fluro68" class="section level2">
<h2><span class="header-section-number">10.12</span> LI-6800 荧光数据分析</h2>
<p>LI-6800 能够直接提供基本的叶绿素荧光参数，其他参数均可通过这些基本的参数进行计算，计算也较简单，在此不赘述，需要注意的是快相荧光部分的数据，因为分析 ojip 数据的模型有很多，很多都需要复杂的计算，在此我们先将其中较为简单的 jip test 数据分析进行介绍。</p>
<div id="jiptest" class="section level3">
<h3><span class="header-section-number">10.12.1</span> jip test 的实现</h3>
<p>LI-6800 增加了 ojip 曲线测量功能，本功能主要是针对测量数据的 jip test 的实现。</p>
</div>
<div id="jiptest_pack" class="section level3">
<h3><span class="header-section-number">10.12.2</span> <code>jiptest</code> 软件包安装</h3>
<p>目前 <code>jiptest</code> 暂时放在 github 我的软件仓库内，并没提交 CRAN，因此需要 <code>devtools</code> 的支持，然后才能从 github 安装 <code>jiptest</code>。</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</a>
<a class="sourceLine" id="cb299-2" title="2"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb299-3" title="3"><span class="kw">install_github</span>(<span class="st">&quot;zhujiedong/jiptest&quot;</span>)</a></code></pre></div>
</div>
<div id="readfluor" class="section level3">
<h3><span class="header-section-number">10.12.3</span> <code>read_files</code> 及 <code>read_dcfiles</code> 函数</h3>
<p><code>read_files</code> 用于批量读取所有调制光测量数据，方便用于其他的数据分析。<strong>函数要求所有数据必须是 <code>xlsx</code> 格式，并且所有测量数据都保存在同一文件夹内。</strong>，如有其他文件或测量数据则会报错。
<code>read_dcfiles</code> 用于批量读取所有连续光测量数据，其他与 <code>read_dcfiles</code> 相同。</p>
<p>函数仅有一个参数，即保存数据文件夹的路径，使用如下：</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1"><span class="kw">library</span>(jiptest)</a>
<a class="sourceLine" id="cb300-2" title="2">jipdata &lt;-<span class="st"> </span><span class="kw">read_files</span>(<span class="st">&quot;./data/ojip&quot;</span>)</a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-61">表 10.2: </span>jiptest 批量导入数据后的样式</caption>
<thead>
<tr class="header">
<th align="right">SECS</th>
<th align="right">FLUOR</th>
<th align="left">SOURCE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.41e-05</td>
<td align="right">887</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="even">
<td align="right">2.81e-05</td>
<td align="right">998</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="odd">
<td align="right">3.19e-05</td>
<td align="right">1013</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="even">
<td align="right">3.60e-05</td>
<td align="right">1055</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="odd">
<td align="right">4.01e-05</td>
<td align="right">1044</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="even">
<td align="right">4.41e-05</td>
<td align="right">1205</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" title="1">dcjipdata &lt;-<span class="st"> </span><span class="kw">read_dcfiles</span>(<span class="st">&quot;./data/ojip&quot;</span>)</a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-62">表 10.3: </span>jiptest DC 数据批量导入数据后的样式</caption>
<thead>
<tr class="header">
<th align="right">SECS</th>
<th align="right">FLUOR</th>
<th align="left">SOURCE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.41e-05</td>
<td align="right">154000</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="even">
<td align="right">2.81e-05</td>
<td align="right">157566</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="odd">
<td align="right">3.19e-05</td>
<td align="right">161261</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="even">
<td align="right">3.60e-05</td>
<td align="right">165114</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="odd">
<td align="right">4.01e-05</td>
<td align="right">169069</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
<tr class="even">
<td align="right">4.41e-05</td>
<td align="right">173231</td>
<td align="left">INDUCTION-484-20171225-13_15_58</td>
</tr>
</tbody>
</table>
</div>
<div id="testfluor" class="section level3">
<h3><span class="header-section-number">10.12.4</span> <code>jip_test</code> 及 <code>jip_dctest</code> 函数</h3>
<p><code>jiptest</code> 是 jiptest 的核心函数，用于所有数据的 jip test 分析，函数仅包一个参数，测量数据的保存文件夹路径。
<code>jip_dctest</code> 与 <code>jip_test</code> 相似，用于连续光测量数据的分析。</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1">jip_results &lt;-<span class="st"> </span><span class="kw">jip_test</span>(<span class="st">&quot;./data/ojip&quot;</span>)</a></code></pre></div>
<pre><code>## for the current version, we suggest you use the default settings of
## 
##   the duration (1000 ms or more) in the induction settings of LI-6800</code></pre>
<pre><code>## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2
## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2
## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2
## New names:
## * `` -&gt; ...1
## * `` -&gt; ...2</code></pre>
<table>
<caption><span id="tab:jipres">表 10.4: </span>jiptest 输出的计算参数</caption>
<thead>
<tr class="header">
<th align="left">parameters</th>
<th align="right">data_file1</th>
<th align="right">data_file2</th>
<th align="right">data_file3</th>
<th align="right">data_file4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Fo</td>
<td align="right">887.000</td>
<td align="right">849.000</td>
<td align="right">981.000</td>
<td align="right">914.000</td>
</tr>
<tr class="even">
<td align="left">Fm</td>
<td align="right">4649.520</td>
<td align="right">3714.270</td>
<td align="right">4225.240</td>
<td align="right">3754.270</td>
</tr>
<tr class="odd">
<td align="left">F300</td>
<td align="right">2181.400</td>
<td align="right">1798.600</td>
<td align="right">2067.800</td>
<td align="right">2537.200</td>
</tr>
<tr class="even">
<td align="left">FJ</td>
<td align="right">2594.300</td>
<td align="right">2104.600</td>
<td align="right">2456.800</td>
<td align="right">2569.000</td>
</tr>
<tr class="odd">
<td align="left">FI</td>
<td align="right">4443.110</td>
<td align="right">3547.110</td>
<td align="right">4009.220</td>
<td align="right">3556.530</td>
</tr>
<tr class="even">
<td align="left">Tfmax</td>
<td align="right">256.016</td>
<td align="right">316.016</td>
<td align="right">272.016</td>
<td align="right">200.016</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1">dcjip_results &lt;-<span class="st"> </span><span class="kw">jip_dctest</span>(<span class="st">&quot;./data/ojip&quot;</span>)</a></code></pre></div>
<table>
<caption><span id="tab:dcjipres">表 10.5: </span>jiptest DC 数据输出的计算参数</caption>
<thead>
<tr class="header">
<th align="left">parameters</th>
<th align="right">data_file1</th>
<th align="right">data_file2</th>
<th align="right">data_file3</th>
<th align="right">data_file4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Fo</td>
<td align="right">154000.000</td>
<td align="right">133191.000</td>
<td align="right">156664.000</td>
<td align="right">153589.000</td>
</tr>
<tr class="even">
<td align="left">Fm</td>
<td align="right">713839.000</td>
<td align="right">560610.000</td>
<td align="right">647660.000</td>
<td align="right">584839.000</td>
</tr>
<tr class="odd">
<td align="left">F300</td>
<td align="right">338091.000</td>
<td align="right">275476.800</td>
<td align="right">322859.200</td>
<td align="right">388110.400</td>
</tr>
<tr class="even">
<td align="left">FJ</td>
<td align="right">400744.000</td>
<td align="right">320245.000</td>
<td align="right">376885.000</td>
<td align="right">406671.000</td>
</tr>
<tr class="odd">
<td align="left">FI</td>
<td align="right">681505.000</td>
<td align="right">534314.000</td>
<td align="right">614590.000</td>
<td align="right">552253.000</td>
</tr>
<tr class="even">
<td align="left">Tfmax</td>
<td align="right">276.016</td>
<td align="right">300.016</td>
<td align="right">288.016</td>
<td align="right">212.016</td>
</tr>
</tbody>
</table>
<p>计算参数见表 <a href="anay-6800.html#tab:jipres">10.4</a> 及 <a href="anay-6800.html#tab:dcjipres">10.5</a>，考虑到排版，仅显示部分内容。若需要将数据导出，可以使用相关命令，如：</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1"><span class="co"># export the results of jiptest to a csv file</span></a>
<a class="sourceLine" id="cb306-2" title="2"><span class="kw">write.csv</span>(jip_results, <span class="st">&quot;d:/data/jip_resluts.csv&quot;</span>)</a>
<a class="sourceLine" id="cb306-3" title="3"><span class="kw">write.csv</span>(dcjip_results, <span class="st">&quot;d:/data/dcjip_resluts.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="plotfluor" class="section level3">
<h3><span class="header-section-number">10.12.5</span> <code>jip_plot</code> 及 <code>jip_dcplot</code> 函数</h3>
<p><code>jip_plot</code> 和 <code>jip_dcplot</code> 基于 <code>ggplot2</code>，用于快速预览所有测量结果的 ojip 曲线。函数仅有一个参数，即保存数据文件夹的路径，使用如下：</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" title="1"><span class="kw">jip_plot</span>(<span class="st">&quot;./data/ojip&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:acplot"></span>
<img src="bookdown_files/figure-html/acplot-1.png" alt="调制式测量的 ojip 曲线的快速预览" width="672" />
<p class="caption">
图 10.25: 调制式测量的 ojip 曲线的快速预览
</p>
</div>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="kw">jip_dcplot</span>(<span class="st">&quot;./data/ojip&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:dcplot"></span>
<img src="bookdown_files/figure-html/dcplot-1.png" alt="连续式测量的 ojip 曲线的快速预览" width="672" />
<p class="caption">
图 10.26: 连续式测量的 ojip 曲线的快速预览
</p>
</div>
<p>ojip 调制式测量光 ojip 曲线的快速预览如图 <a href="anay-6800.html#fig:acplot">10.25</a></p>
<p>ojip 连续式测量光 ojip 曲线的快速预览如图 <a href="anay-6800.html#fig:dcplot">10.26</a></p>
<p><strong>建议在开始分析数据前，使用如上方式作图查看数据质量，若使用调制光数据测量的荧光信号太弱，数据点太散，则可以使用连续光测量信号进行分析，对于归一化的荧光参数，二者几乎无差别，当然避免陷入被动的最好方式还是最开始测量时注意检查数据质量</strong></p>


</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-Coursolle12019">
<p>Coursolle, Carole, Guillaume O. Prud’homme, Manuel Lamothe1, and Nathalie Isabel1. 2019. “Measuring Rapid a–Ci Curves in Boreal Conifers: Black Spruce and Balsam Fir.” <em>Frontiers in Plant Science</em>. <a href="https://doi.org/10.3389/fpls.2019.01276">https://doi.org/10.3389/fpls.2019.01276</a>.</p>
</div>
<div id="ref-stinziano2019">
<p>Joseph R., Stinziano, Adamson Rachael K., and Hanson David T. 2019. “Using Multirate Rapid Aci Curves as a Tool to Explore New Questions in the Photosynthetic Physiology of Plants.” <em>New Phytologist</em>. <a href="https://doi.org/10.1111/nph.15657">https://doi.org/10.1111/nph.15657</a>.</p>
</div>
<div id="ref-stinziano2018">
<p>Stinziano, Joseph R, Dayle K Mcdermitt, Douglas J Lynch, Aaron J Saathoff, Patrick B Morgan, and David T Hanson. 2018. “The Rapid a/Ci Response: A Guide to Best Practices.” <em>New Phytologist</em>.</p>
</div>
<div id="ref-stinziano2017">
<p>Stinziano, J. R., P. B. Morgan, D. J. Lynch, A. J. Saathoff, D. K. Mcdermitt, and D. T. Hanson. 2017. “The Rapid a-Ci Response: Photosynthesis in the Phenomic Era.” <em>Plant Cell &amp; Environment</em> 40.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="start-con.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pca-anylysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/zhujiedong/photoanalysis/blob/master/12-1-plantecophys-6800.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
